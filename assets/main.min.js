"use strict";!function(t,D){var a=a||{},K=["x","y"],O="data-visualizer-",S=function(t,a){return a?"x"==t?"height":"width":"x"==t?"width":"height"},L=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t=0,a,e;if(0===this.length)return t;for(a=0;a<this.length;a++)t=(t<<5)-t+(e=this.charCodeAt(a)),t|=0;return t},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0};var e=function(a,t){var e=document.querySelector(a),c={},r,l={width:600,height:400,margin:20,marginOffset:2,duration:1e3,delay:500,type:"bar",dataKey:[0,1],xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xTicksFormat:null,xMin:null,xMax:null,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yTickFormat:null,yMin:null,yMax:null,colors:[],colorsData:"",areaKey:"",srcType:"",srcPath:"",srcKey:null};for(var n in t)t.hasOwnProperty(n)&&(l[n]=t[n]);var u=function(t){var a=0;return"pie"!==l.type&&(a=l.margin*(.5*l.marginOffset),l[t+"Label"]&&(a=l.margin*l.marginOffset),"x"==t&&0==l[L(t)+"Data"]&&(a=l.margin*(1.5*l.marginOffset),l[L(t)+"Label"]&&(a+=.5*l.marginOffset))),a},f=function(t,a,e){var r=a.split("."),n;function i(t,a){var e=null;return e=a.length?i(t[a[0]],a.slice(1)):t}return r.forEach(function(t,a){""==t&&r.splice(a,1)}),e?parseFloat(i(t,r)):i(t,r)},h=function(t){var a=[];return a="top"==l[L(t)+"Align"]||"left"==l[L(t)+"Align"]?[0,l[S(t)]]:[l[S(t)],0]},i=function(t,a){var e=l[t+"Data"],r=[];if(t=t.toLowerCase(),"string"==typeof e)console.log("fuck");else{if(0==e)return a.map(function(t){return f(t,l.dataKey[e],e)});var r=[],n,i;r=[n=null!==l[t+"Min"]?l[t+"Min"]:D.min(a,function(t){return f(t,l.dataKey[e],e)}),i=null!==l[t+"Max"]?l[t+"Max"]:D.max(a,function(t){return f(t,l.dataKey[e],e)})]}return r},o=function(t,a){var e=0;return"x"==t?"x"==a?e=l[S(a)]/2:"y"==a&&(e=-l[S(a)]/2):"x"==a?e="bottom"==l[a+"Align"]?l[S(a,!0)]+(c.off_y-.75*l.margin):-(c.off_y-1.5*l.margin):"y"==a&&(e="right"==l[a+"Align"]?l[S(a,!0)]+.75*c.off_x:-.75*c.off_x),e},s=function(t,a,e,r){var n=l[t+"Data"],i=l.dataKey[n],o=l[L(t)+"Align"],s=20,r=r||!1;switch(l.type){case"pie":case"scatter":break;default:s=0==n?c["the_"+t].bandwidth():r?0:"right"==o||"bottom"==o?l[S(t)]-c["the_"+t](f(a,i,i)):c["the_"+t](f(a,i,i))}return s},y=function(t,a){var e="middle";return 0==l.xData&&(e="bottom"==l.xAlign?"hanging":"auto"),e},d=function(t,a){var e="middle";return"pie"==l.type||0==l.yData&&(e="start"),e},g=function(t,a,e,r){var n=0;return"pie"==l.type||(!l.xTicks&&l.yTicks||l.xTicks&&!l.yTicks?0!==l[t+"Data"]&&(n="top"==l[L(t)+"Data"]?"-1em":"1em"):"x"==t?1==l[t+"Data"]&&(n="10"):n=0==l[L(t)+"Data"]?"bottom"==l[L(t)+"Align"]?"1.5em":e[l.dataKey[l[t+"Data"]]]!==e[l.dataKey[l[a+"Data"]]]?"-2em":"-1.75em":e[l.dataKey[l[t+"Data"]]]!==e[l.dataKey[l[a+"Data"]]]?"-.25em":"1.375em"),n},p=function(t,a,e){var r=l[t+"Data"],n=0;return"pie"==l.type||"line"==l.type||(0==r?n=x(t,a,e)+s(t,a,e)/2:"bottom"==l[L(t)+"Align"]||"right"==l[L(t)+"Align"]?n=l[S(t)]-s(t,a,e):"top"==l[L(t)+"Align"]&&(n=s(t,a,e))),n},x=function(t,a,e,r){var n=l[t+"Data"],i=l.dataKey[n],o=l[L(t)+"Align"],r=r||!1,s=0;switch(l.type){case"pie":case"scatter":break;default:0==n?s=c["the_"+t](f(a,i,n)):"right"!=o&&"bottom"!=o||(s=r?l[S(t)]:l[S(t)]-(l[S(t)]-c["the_"+t](f(a,i,n))))}return s},m=function(t,a){var e=a.append("g").attr("class",O+"axis-"+t+" "+O+"axis-align-"+l[t+"Align"]),r="";switch(t+" "+l[t+"Align"]){case"x bottom":r="0,"+l.height;break;case"y right":r=l.width+",0";break;default:r="0,0"}return e.attr("transform","translate("+r+")"),e},b=function(t){var a;switch(l[t+"Align"]){case"top":a=D.axisTop(c["the_"+t]);break;case"bottom":a=D.axisBottom(c["the_"+t]);break;case"left":a=D.axisLeft(c["the_"+t]);break;case"right":a=D.axisRight(c["the_"+t])}return l.hasOwnProperty(t+"Ticks")&&(l.hasOwnProperty(t+"TicksFormat")&&a.tickFormat(l[t+"TicksFormat"]),l.hasOwnProperty(t+"TicksAmount")&&a.ticks(l[t+"TicksAmount"])),a},k=function(t){var a,e;return a=0==l[t+"Data"]?D.scaleBand().range(c["range_"+t]).paddingInner(.1).paddingOuter(.1):D.scaleLinear().range(c["range_"+t]),l.type,a},v=function(t,a){l[t+"Ticks"]&&(l[t+"Label"]&&(c["lab_"+t]=c.labels.append("text").attr("class",O+"label-"+t).attr("y",function(){return o("y",t)}).attr("x",function(){return o("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(l[t+"Label"]),"y"==t&&c["lab_"+t].attr("transform","rotate(-90)")),c["rule_"+t]=m(t,a),c["axis_"+t]=b(t))},_=function(t,a,e){var r=a;switch(e.duration=D.transition().duration(l.duration),l.type){case"bar":e.graphItem="rect";break;case"scatter":e.graphItem="circle"}l.srcKey&&(r=f(a,l.srcKey)),e.off_x=u("x"),e.off_y=u("y"),e.outerWidth=l.width+2*e.off_x,e.outerHeight=l.height+2*e.off_y,e.canvas=D.select(t).append("div").attr("class",O+"wrapper"),e.dimensionString="0 0 "+e.outerWidth+" "+e.outerHeight,e.svg=e.canvas.append("svg").attr("id",t+"-svg").attr("class",O+"svg").attr("viewBox",e.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+e.dimensionString).attr("width",e.outerWidth).attr("height",e.outerHeight),e.container=e.svg.append("g"),e.containerTransform=null;var n=1.25,i=.75,o=e.off_x,s=e.off_y;switch(l.yAlign+" "+(""==l.xLabel?"empty":"has")){case"left has":e.transformX=e.off_x*n;break;case"right has":e.transformX=e.off_x*i;break;default:e.transformX=e.off_x}switch(l.xAlign+" "+(""==l.yLabel?"empty":"has")){case"top has":e.transformX=e.off_y*n;break;case"bottom has":e.transformX=e.off_y*i;break;default:e.transformX=e.off_y}e.container.attr("transform","translate("+o+","+s+")"),"pie"==l.type||(e.labels=e.container.append("g").attr("class",O+"labels"),e.rule=e.container.append("g").attr("class",O+"axis"),K.forEach(function(t){e["range_"+t]=h(t),e["the_"+t]=k(t),v(t,e.rule)})),setTimeout(function(){T(r,e)},l.delay)},T=function(t,a){if(console.log("calculated",a),console.log("data",t),console.log("args",l),a.dom_x=i("x",t),a.the_x.domain(a.dom_x),l.xTicks&&a.rule_x.transition(a.duration).call(a.axis_x).attr("font-family","inherit").attr("font-size",null),a.dom_y=i("y",t),a.the_y.domain(a.dom_y),l.yTicks&&a.rule_y.transition(a.duration).call(a.axis_y).attr("font-family","inherit").attr("font-size",null),a.graph=a.container.insert("g",":first-child").attr("class",O+"graph"),a.blob=a.graph.selectAll(a.graphItem).data(t,function(t){return t[l.dataKey[l.xData]]}),l.colors){var e=l.colorsData||l.dataKey[0];a.dom_color=i("colors",t)}"pie"==l.type||(a.blob.exit().transition(a.duration).attr("height",0).remove(),a.blobWrap=a.blob.enter().append("g").attr("class",O+"item"),a.blobWrap.append(a.graphItem).attr("width",function(t,a){return s("x",t,a,!0)}).attr("height",function(t,a){return s("y",t,a,!0)}).attr("x",function(t,a){return x("x",t,a,!0)}).attr("y",function(t,a){return x("y",t,a,!0)}).transition(a.duration).attr("width",function(t,a){return s("x",t,a)}).attr("height",function(t,a){return s("y",t,a)}).attr("x",function(t,a){return x("x",t,a)}).attr("y",function(t,a){return x("y",t,a)}),l.xTicks&&l.yTicks||(a.blobText=a.blobWrap.append("g").attr("class",O+"item-text"+(l.xTicks||l.yTicks?"":" "+O+"item-data-no-ticks")).attr("transform",function(t,a){return"translate("+p("x",t,a)+","+p("y",t,a)+")"}),"pie"==l.type||K.forEach(function(e){l[e+"Ticks"]||(a["blobText"+e]=a.blobText.append("text").attr("class",O+"item-data-"+l[e+"Data"]).attr("dominant-baseline",function(t,a){return y(t,a)}).attr("text-anchor",function(t,a){return d(t,a)}).attr("font-size",null).text(function(t,a){return f(t,l.dataKey[l[e+"Data"]],l[e+"Data"])}).attr("x",function(t,a){return g("x",e,t,a)}).attr("y",function(t,a){return g("y",e,t,a)}))})))};switch(l.srcPath.getFileExtension()){case"csv":D.csv(l.srcPath).then(function(t){_(a,t,c)});break;case"tsv":D.tsv(l.srcPath).then(function(t){_(a,t,c)});break;case"json":D.json(l.srcPath).then(function(t){_(a,t,c)});break;default:if(l.srcPath.getHash()){var w=e.querySelector('script[type="application/json"').innerHTML;if(w.isValidJSONString()){var A=JSON.parse(w);_(a,A,c)}else"text"==l.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}};a.dataVisualizer=e,t._1p21=a}(window,d3);