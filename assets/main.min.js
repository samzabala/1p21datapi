"use strict";!function(t,e){var n=n||{},r=["x","y"],a=["x","y","color","area","r"],i="data-visualizer-",l=15,o=function(t,e){return e?"x"==t?"height":"width":"x"==t?"width":"height"},s=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t=0,e,n;if(0===this.length)return t;for(e=0;e<this.length;e++)t=(t<<5)-t+(n=this.charCodeAt(e)),t|=0;return t},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.toCamelCase=function(){var t;return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")};var c=function(t){var e,n,r,a;return t.match(/^rgb/)?(e=(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=t[2],r=t[3]):(e=(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")))>>16,n=t>>8&255,r=255&t),!((a=Math.sqrt(e*e*.299+n*n*.587+r*r*.114))>170)},u=function(n,l){var u=document.querySelector(n),f={},h={width:600,height:400,margin:20,marginOffset:2,transition:2e3,delay:300,type:"bar",dataKey:[0,1],nameIsNum:!1,srcType:"",srcPath:"",srcKey:null,colorPalette:[],colorData:null,xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xTicksParameter:null,xMin:null,xMax:null,xGrid:!1,xGridIncrement:1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yTicksParameter:null,yMin:null,yMax:null,yGrid:!1,yGridIncrement:1,yPrepend:"",yAppend:"",yDivider:1,lineStyle:"",lineWeight:1,lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillOpacity:.5,lineFillInvert:"x",lineDash:[100,0],areaKey:""},p=h;for(var d in l)l.hasOwnProperty(d)&&(p[d]=l[d]);f.mLength=p.xTicks||p.yTicks?70:120;var g=function(t){var e=0;return"pie"!==p.type&&(e=p.margin*(.75*p.marginOffset),p[t+"Label"]&&(e=p.margin*p.marginOffset),"x"==t&&0==p[s(t)+"Data"]&&(e=p.margin*(1.75*p.marginOffset),p[s(t)+"Label"]&&(e+=.5*p.marginOffset))),e},y=function(t,e,n){var r=e.toString().split("."),a;function i(t,e){var r=null;return r=e.length?i(t[e[0]],e.slice(1)):n?parseFloat(t):t}return r.forEach(function(t,e){""==t&&r.splice(e,1)}),i(t,r)},m=function(t){var e=[];switch(t){case"color":e=p[t+"Palette"];break;case"x":case"y":e="top"==p[s(t)+"Align"]||"left"==p[s(t)+"Align"]?[0,p[o(t)]]:[p[o(t)],0]}return e},x=function(t,n){var r=p[t+"Data"],a=[];if(null!==r){switch(t){case"color":var i=p.colorData||p.dataKey[0],l;a=n.reduce(function(t,e){return t.includes(y(e,i))||t.push(y(e,i)),t},[]);break;case"x":case"y":var o,s;if(p.nameIsNum||1==r)a=[o=null!==p[t+"Min"]?p[t+"Min"]:e.min(n,function(t){return y(t,p.dataKey[r],!0)}),s=null!==p[t+"Max"]?p[t+"Max"]:e.max(n,function(t){return y(t,p.dataKey[r],!0)})];else a=n.map(function(t){return y(t,p.dataKey[r],!1)})}return a}},b=function(t,e){var n=0;return"x"==t?"x"==e?n=p[o(e)]/2:"y"==e&&(n=-p[o(e)]/2):"x"==e?n="bottom"==p[e+"Align"]?p[o(e,!0)]+(f.off_y-.125*p.margin):-(f.off_y-1.5*p.margin):"y"==e&&(n="right"==p[e+"Align"]?p[o(e,!0)]+f.off_x:-.125*f.off_x),n},v=function(t,e,n,r){var a=p[t+"Data"],i=p.dataKey[a],l=p[s(t)+"Align"],c=20;switch(r=r||!1,p.type){case"pie":break;default:c=p.nameIsNum||1==a?r?0:"right"==l||"bottom"==l?p[o(t)]-f["the_"+t](y(e,i,i,!0)):f["the_"+t](y(e,i,i,!0)):f["the_"+t].bandwidth()}return c},k=function(t,e,n){var r=2;return n?r=0:"line"==p.type&&p.linePointsSize&&(r=p.linePointsSize),r},_=function(t,e){var n="middle";return"pie"==p.type||(0==p.yData&&(n="start"),r.forEach(function(t){0==p[s(t)+"Data"]&&"right"==p[s(t)+"Align"]&&(n="end")})),n},A=function(t,e){var n="0em";return"pie"==p.type||("x"==t?n=!p.xTicks&&!p.yTicks||1==p.yData?0:15:p.xTicks||p.yTicks||(n=1==p[e+"Data"]?".5em":"-1.5em")),n},T=function(t,e,n,r){var a=p[t+"Data"],i=0,l=p.xTicks||p.yTicks||"y"!=t?18.75:37.5,c=function(){var e=0,n=1;return 0==a&&("bottom"!=p[t+"Align"]&&"right"!=p[t+"Align"]||(n*=-1)),"x"==t?0!==p[t+"Data"]&&(e=15*n):(0==p[s(t)+"Data"]&&(e=p.xTicks||p.yTicks?18.75:37.5),e*=n),e},u=function(){var r=1,a=0;return"top"!=p[s(t)+"Align"]&&"left"!=p[s(t)+"Align"]||(r*=-1),parseFloat(v("y",e,n,!1))<f.mLength&&(a="bottom"==p[s(t)+"Align"]||"top"==p[s(t)+"Align"]?2*c():v(t,e,n)),a*=r};switch(r=r||!1,p.type){case"pie":break;default:if(0==a)i=w(t,e,n),"bar"==p.type&&(i+=v(t,e,n)/2);else switch(p[s(t)+"Align"]){case"top":r?w(t,e,n):i=v(t,e,n);break;case"right":case"bottom":i=r||"right"==p[s(t)+"Align"]&&"bar"==p.type?p[o(t)]:p[o(t)]-v(t,e,n);break;case"left":"bar"!==p.type&&(i=v(t,e,n))}console.log(e.name,t,c(),u()),i+=c()}return i},w=function(t,e,n,r){var a=p[t+"Data"],i=p.dataKey[a],l=p[s(t)+"Align"],c=0;switch(r=r||!1,p.type){case"pie":break;default:p.nameIsNum||1==a?"right"==l||"bottom"==l?c=r&&0!==a?p[o(t)]:p[o(t)]-(p[o(t)]-f["the_"+t](y(e,i,!0))):"line"!=p.type&&"scatter"!=p.type||r&&0!==a||(c=f["the_"+t](y(e,i,!0))):c=f["the_"+t](y(e,i,!1))}return c},P=function(t,n,r){r=r||!1;var a=n?"area":"line",i=0==p.xData?"x":"y",l=e[a]();if("area"==a){var o={name:i,value:s(i)+1,fill:s(i)+0};(!p.lineFillInvert&&("right"==p[s(i)+"Align"]||"bottom"==p[s(i)+"Align"])||p.lineFillInvert&&"right"!=p[s(i)+"Align"]&&"bottom"!=p[s(i)+"Align"])&&(o.value=s(i)+0,o.fill=s(i)+1),l[o.name](function(t,e){return w(i,t,e,r)})[o.value](function(t,e){return w(s(i),t,e,r)})[o.fill](function(t,e){return w(s(i),t,e,!0)})}else l.x(function(t,e){return w("x",t,e,r)}).y(function(t,e){return w("y",t,e,r)});return l(t)},D=function(t,e,n){var r=e.append("g").attr("class",function(){var e=null;return e=n?i+"grid-"+t+" ":i+"axis-"+t+" "+i+"axis-align-"+p[t+"Align"]}),a="";switch(t+" "+p[t+"Align"]){case"x bottom":a="0,"+p.height;break;case"y right":a=p.width+",0";break;default:a="0,0"}return r.attr("transform","translate("+a+")"),r},I=function(t,n){var r,a="Axis "+p[t+"Align"];if(n=n||!1,r=e[a.toCamelCase()](f["the_"+t]),p.hasOwnProperty(t+"Ticks")){if(p[t+"TicksAmount"]){var i=function(){return n&&p[t+"TicksAmount"]?p[t+"TicksAmount"]/p[t+"GridIncrement"]:p[t+"TicksAmount"]};r.ticks(i(),f["format_"+t])}n&&r.tickSize(-p[o(s(t))]).tickFormat("")}return r},S=function(t){var n,r=p[t+"Data"];switch(t){case"color":n=e.scaleOrdinal().range(f["range_"+t]);break;case"x":case"y":n=p.nameIsNum||1==r?e.scaleLinear().range(f["range_"+t]):e.scaleBand().range(f["range_"+t]).paddingInner(.1).paddingOuter(.1)}return n},C=function(t,e,n){if(p[t+"Ticks"]){var r=n?"grid_":"";p[t+"Label"]&&(f["lab_"+t]=f.labels.append("text").attr("class",i+"label-"+t).attr("y",function(){return b("y",t)}).attr("x",function(){return b("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(p[t+"Label"]),"y"==t&&f["lab_"+t].attr("transform","rotate(-90)")),f["rule_"+r+t]=D(t,e,n),f["axis_"+r+t]=I(t,n)}},F=function(r,l){var o=null;switch(l.duration=e.transition().duration(p.transition),p.type){case"bar":l.graphItem="rect";break;case"line":case"scatter":l.graphItem="circle"}if(o=p.srcKey?y(r,p.srcKey):r,p.nameIsNum){for(var s=[],c=0;c<o.length;c++)o[c]&&s.push(o[c]);s.sort(function(t,e){return y(t,p.dataKey[0],!0)-y(e,p.dataKey[0],!0)}),o=s}l.off_x=g("x"),l.off_y=g("y"),l.outerWidth=p.width+2*l.off_x,l.outerHeight=p.height+2*l.off_y,l.canvas=e.select(n).append("div").attr("class",i+"wrapper"),l.dimensionString="0 0 "+l.outerWidth+" "+l.outerHeight,l.svg=l.canvas.append("svg").attr("id",n+"-svg").attr("class",i+"svg").attr("viewBox",l.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+l.dimensionString).attr("width",l.outerWidth).attr("height",l.outerHeight),l.container=l.svg.append("g"),l.containerTransform=null;var f=1.25,d=.75,b=l.off_x,v=l.off_y;switch(p.yAlign+" "+(""==p.xLabel?"empty":"has")){case"left has":l.transformX=l.off_x*f;break;case"right has":l.transformX=l.off_x*d;break;default:l.transformX=l.off_x}switch(p.xAlign+" "+(""==p.yLabel?"empty":"has")){case"top has":l.transformX=l.off_y*f;break;case"bottom has":l.transformX=l.off_y*d;break;default:l.transformX=l.off_y}l.container.attr("transform","translate("+b+","+v+")"),"pie"==p.type||(l.labels=l.container.append("g").attr("class",i+"labels"),l.rule=l.container.append("g").attr("class",i+"axis"),l.grid=l.container.append("g").attr("class",i+"grid"),a.forEach(function(t){l["range_"+t]=m(t),l["the_"+t]=S(t),"x"!=t&&"y"!=t||(C(t,l.rule),l["format_"+t]=p[t+"Parameter"]||function(t){var e=1==p[axisString+"Data"]?t/p[axisString+"Divider"]:t,n;return p[axisString+"Prepend"]+e+p[axisString+"Append"]},l["dom_"+t]=x(t,o),l["the_"+t].domain(l["dom_"+t]),p[t+"Ticks"]&&(l["rule_"+t].transition(p.delay).call(l["axis_"+t]).attr("font-family","inherit").attr("font-size",null),p[t+"Grid"]&&(C(t,l.grid,!0),l["rule_grid_"+t].call(l["axis_grid_"+t]))))}),l.graph=l.container.insert("g",":first-child").attr("class",i+"graph "+i+(p.colorPalette.length>0||null!==p.linePointsColor||null!==p.lineColor?"has-palette":"no-palette")+(p.xTicks||p.yTicks?"":" "+i+"item-data-no-ticks")),o.length>9&&p.width==h.width&&p.height==h.height&&console.log(n+" Width and height was not adjusted. graph elements may not fit in the canvas"),("line"!=p.type||p.linePoints)&&(l.blob=l.graph.selectAll(l.graphItem).data(o,function(t){return t[p.dataKey[p.xData]]})),p.colorPalette.length>0&&(l.dom_color=x("color",o))),l.dv_init=!1,document.addEventListener("scroll",function(e){var n;u.getBoundingClientRect().y<.5*t.innerHeight&&!l.dv_init&&(l.dv_init=!0,setTimeout(function(){L(l,o)},p.delay))},!0)},L=function(t,e){console.log(n,"-------------------------------------------------------------------"),console.log("calculated",t),"pie"==p.type||(("line"!=p.type||p.linePoints)&&(t.blob.exit().transition(t.duration).attr("height",0).remove(),t.blobWrap=t.blob.enter().append("g").attr("class",function(t){return i+"item "+i+y(t,p.dataKey[0])}),t.blobItem=t.blobWrap.append(t.graphItem).attr("line"==p.type||"scatter"==p.type?"cx":"x",function(t,e){return w("x",t,e,!0)}).attr("line"==p.type||"scatter"==p.type?"cy":"y",function(t,e){return w("y",t,e,!0)}),"line"==p.type||"scatter"==p.type?t.blobItem.attr("r",function(t,e){return k(t,e,!0)}):t.blobItem.attr("width",function(t,e){return v("x",t,e,!0)}).attr("height",function(t,e){return v("y",t,e,!0)}),p.colorPalette.length?t.blobItem.attr("fill",function(e,n){return t.the_color(e[p.colorData])}):"line"==p.type&&(p.linePointsColor||p.lineColor)&&t.blobItem.attr("fill",function(){return p.linePointsColor||p.lineColor}),t.blobItem.transition(t.duration).attr("line"==p.type||"scatter"==p.type?"cx":"x",function(t,e){return w("x",t,e)}).attr("line"==p.type||"scatter"==p.type?"cy":"y",function(t,e){return w("y",t,e)}),"line"==p.type||"scatter"==p.type?t.blobItem.transition(t.duration).attr("r",function(t,e){return k(t,e)}):t.blobItem.transition(t.duration).attr("width",function(t,e){return v("x",t,e)}).attr("height",function(t,e){return v("y",t,e)})),"line"==p.type&&(p.lineFill&&(t.fill=t.graph.append("path").attr("class",i+"fill").attr("fill-opacity",0).attr("d",function(){return P(e,!0,!0)}),(p.lineFillColor||p.lineColor)&&t.fill.attr("fill",p.lineFillColor||p.lineColor),t.fill.transition(t.duration).attr("fill-opacity",p.lineFillOpacity).attr("d",function(){return P(e,!0)})),t.line=t.graph.append("path").attr("class",i+"line").attr("fill","none").attr("stroke-width",p.lineWeight).attr("stroke-linejoin","round").attr("stroke-opacity",0).attr("d",function(){return P(e,!1,!0)}).attr("stroke-dasharray","0,0"),p.lineColor&&t.line.attr("stroke",p.lineColor),t.line.transition(t.duration).attr("d",function(){return P(e,!1)}).attr("stroke-dasharray",p.lineDash).attr("stroke-opacity",1))),p.xTicks&&p.yTicks||(t.blobText=t.blobWrap.append("text").attr("class",function(e,n){var a=i+"item-text";return r.forEach(function(r){(parseFloat(v(r,e,n,!1))<t.mLength&&1==p[r+"Data"]||p.colorPalette.length>0&&parseFloat(v("x",e,n,!1))>t.mLength&&parseFloat(v("y",e,n,!1))>t.mLength&&!c(t.the_color(e[p.colorData]))||"line"==p.type)&&(a+=" dark")}),console.log("shiet",a),a}).attr("transform",function(t,e){return"translate("+T("x",t,e,!0)+","+T("y",t,e,!0)+")"}).style("opacity",1),t.blobText.transition(t.duration).attr("transform",function(t,e){return"translate("+T("x",t,e)+","+T("y",t,e)+")"}).style("opacity",1),r.forEach(function(e){p[e+"Ticks"]||(t["blobText"+e]=t.blobText.append("tspan").attr("class",i+"item-data-"+p[e+"Data"]).attr("dominant-baseline","middle").attr("text-anchor",function(t,e){return _(t,e)}).attr("font-size",null).text(function(t,n){var r;return y(t,p.dataKey[p[e+"Data"]])}).attr("x",A("x",e)).attr("y",A("y",e)))}))};switch(p.srcPath.getFileExtension()){case"csv":e.csv(p.srcPath).then(function(t){F(t,f)});break;case"tsv":e.tsv(p.srcPath).then(function(t){F(t,f)});break;case"json":e.json(p.srcPath).then(function(t){F(t,f)});break;default:if(p.srcPath.getHash()){var K=u.querySelector('script[type="application/json"]').innerHTML;if(K.isValidJSONString()){var O=JSON.parse(K);F(O,f)}else"text"==p.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}};n.dataVisualizer=u,t._1p21=n}(window,d3);