"use strict";!function(t,e){var n=n||{},r=["x","y"],a=["x","y","color","area","r"],i="data-visualizer-",o=15,l=function(t,e){return e?"x"==t?"height":"width":"x"==t?"width":"height"},c=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t=0,e,n;if(0===this.length)return t;for(e=0;e<this.length;e++)t=(t<<5)-t+(n=this.charCodeAt(e)),t|=0;return t},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.toCamelCase=function(){var t;return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")};var s=function(t){var e,n,r,a;return t.match(/^rgb/)?(e=(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=t[2],r=t[3]):(e=(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")))>>16,n=t>>8&255,r=255&t),!((a=Math.sqrt(e*e*.299+n*n*.587+r*r*.114))>170)},u=function(n,o){var u=document.querySelector(n),f={},p={width:600,height:600,margin:20,marginOffset:2,transition:2e3,delay:300,type:"bar",dataKey:[0,1],nameIsNum:!1,srcType:"",srcPath:"",srcKey:null,colorPalette:[],colorData:null,xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xParameter:null,xMin:null,xMax:null,xGrid:!1,xGridIncrement:1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yParameter:null,yMin:null,yMax:null,yGrid:!1,yGridIncrement:1,yPrepend:"",yAppend:"",yDivider:1,lineStyle:"",lineWeight:1,lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillOpacity:.5,lineDash:[100,0],areaKey:""},h=p;for(var d in o)o.hasOwnProperty(d)&&(h[d]=o[d]);var g=function(t){var e=0;return"pie"!==h.type&&(e=h.margin*(.75*h.marginOffset),h[t+"Label"]&&(e=h.margin*(1.5*h.marginOffset)),"x"==t&&0==h[c(t)+"Data"]&&(e=h.margin*(1.75*h.marginOffset),h[c(t)+"Label"]&&(e+=.5*h.marginOffset))),e},y=function(t,e,r){var a=e.toString().split(".");function i(t,a){var o=null;return a.length?o=i(t[a[0]],a.slice(1)):(o=r?parseFloat(t):t,r&&isNaN(o)&&console.error(n+" data with the key source of "+e+"was passed as numeric but is not.")),o}return a.forEach(function(t,e){""==t&&a.splice(e,1)}),i(t,a)},m=function(t){var e=[];switch(t){case"color":e=h[t+"Palette"];break;case"x":case"y":e="top"==h[c(t)+"Align"]||"left"==h[c(t)+"Align"]?[0,h[l(t)]]:[h[l(t)],0]}return e},b=function(t,n){var r=h[t+"Data"],a=[];switch(t){case"color":var i;null==h[t+"Data"]&&(h[t+"Data"]=h.dataKey[0]),a=n.reduce(function(e,n){return e.includes(y(n,h[t+"Data"]))||e.push(y(n,h[t+"Data"])),e},[]);break;case"x":case"y":var o,l;if(h.nameIsNum||1==r)a=[o=null!==h[t+"Min"]?h[t+"Min"]:e.min(n,function(t){return y(t,h.dataKey[r],!0)}),l=null!==h[t+"Max"]?h[t+"Max"]:e.max(n,function(t){return y(t,h.dataKey[r],!0)})];else a=n.map(function(t){return y(t,h.dataKey[r],!1)})}return a},x=function(t,e){var n=0;return"x"==t?"x"==e?n=h[l(e)]/2:"y"==e&&(n=-h[l(e)]/2):"x"==e?n="bottom"==h[e+"Align"]?h[l(e,!0)]+(f.off_y-.125*h.margin):-(f.off_y-1.5*h.margin):"y"==e&&(n="right"==h[e+"Align"]?h[l(e,!0)]+f.off_x:-.125*f.off_x),n},v=function(t,e,n,r){var a=h[t+"Data"],i=h.dataKey[a],o=h[c(t)+"Align"],s=20;switch(r=r||!1,h.type){case"pie":break;default:s=h.nameIsNum||1==a?r?0:"right"==o||"bottom"==o?h[l(t)]-f["the_"+t](y(e,i,i,!0)):f["the_"+t](y(e,i,i,!0)):f["the_"+t].bandwidth()}return s},k=function(t,e,n){var r=2;return n?r=0:"line"==h.type&&h.linePointsSize&&(r=h.linePointsSize),r},_=function(t,e){var n="middle";return"pie"==h.type||(0==h.yData&&(n="start"),r.forEach(function(t){0==h[c(t)+"Data"]&&"right"==h[c(t)+"Align"]&&(n="end")})),n},A=function(t,e){var n="0em";return"pie"==h.type||"y"==t&&(h.xTicks||h.yTicks||(n=1==h[e+"Data"]?".375em":"-1.625em")),n},w=function(t,e,n,r){var a=h[t+"Data"],i=0,o=function(){var e=0,r=1;return("bar"!=h.type||"top"!=h[c(t)+"Align"]&&"right"!=h[c(t)+"Align"])&&("bar"===h.type||"bottom"!=h[c(t)+"Align"]&&"right"!=h[c(t)+"Align"])||(r*=-1),0==h[c(t)+"Data"]&&(e="x"==t?15:f.mLength(t,n)/2,f.mLength(t,n)),e*=r},s=function(){var r=1,i=0;return("bar"!=h.type||"bottom"!=h[c(t)+"Align"]&&"right"!=h[c(t)+"Align"])&&("bar"===h.type||"top"!=h[c(t)+"Align"]&&"left"!=h[c(t)+"Align"])||(r=-1),("line"!==h.type&&parseFloat(v(t,e,n))<f.mLength(t,n)||"line"==h.type&&parseFloat(v(t,n))>=h[l(c(t))]-f.mLength(t,n))&&0!==a&&(i="x"==t&&"line"!==h.type?v(t,e,n):f.mLength(t,n)),i*=r};switch(r=r||!1,h.type){case"pie":break;default:if(0==a)i=P(t,e,n),"bar"==h.type&&(i+=v(t,e,n)/2);else switch(h[c(t)+"Align"]){case"top":i=r?P(t,e,n):v(t,e,n);break;case"right":case"bottom":i=r||"right"==h[c(t)+"Align"]&&"bar"==h.type?h[l(t)]:h[l(t)]-v(t,e,n);break;case"left":"bar"!==h.type&&(i=v(t,e,n))}i+=o()+s()}return i},P=function(t,e,n,r){var a=h[t+"Data"],i=h.dataKey[a],o=h[c(t)+"Align"],s=0;switch(r=r||!1,h.type){case"pie":break;default:h.nameIsNum||1==a?"right"==o||"bottom"==o?s=r&&0!==a?h[l(t)]:h[l(t)]-(h[l(t)]-f["the_"+t](y(e,i,!0))):"line"!=h.type&&"scatter"!=h.type||r&&0!==a||(s=f["the_"+t](y(e,i,!0))):(s=f["the_"+t](y(e,i,!1)),"line"!=h.type&&"scatter"!=h.type||h.nameIsNum||(s+=v(t,e,n)/2))}return s},T=function(t,n,r){r=r||!1;var a=n?"area":"line",i=0==h.xData?"x":"y",o=function(){var t="curveLinear";switch(h.lineStyle){case"step":t="curveStepAfter";break;case"curve":t="curveMonotone"+i.toUpperCase()}return t}(),l=e[a]();if("area"==a){var s={name:i,value:c(i)+1,fill:c(i)+0};"right"!=h[c(i)+"Align"]&&"bottom"!=h[c(i)+"Align"]||(s.value=c(i)+0,s.fill=c(i)+1),l[s.name](function(t,e){return P(i,t,e,r)})[s.value](function(t,e){return P(c(i),t,e,r)})[s.fill](function(t,e){return P(c(i),t,e,!0)})}else l.x(function(t,e){return P("x",t,e,r)}).y(function(t,e){return P("y",t,e,r)});return o&&l.curve(e[o]),l(t)},D=function(t,e,n){var r=e.append("g").attr("class",function(){var e=null;return e=n?i+"grid-"+t+" grid-increment-"+h[t+"GridIncrement"]+" tick-amount-"+h[t+"TickAmount"]:i+"axis-"+t+" "+i+"axis-align-"+h[t+"Align"]+" tick-amount"+h[t+"TickAmount"]}),a="";switch(t+" "+h[t+"Align"]){case"x bottom":a="0,"+h.height;break;case"y right":a=h.width+",0";break;default:a="0,0"}return r.attr("transform","translate("+a+")"),r},C=function(t,n){var r,a="Axis "+h[t+"Align"];if(n=n||!1,r=e[a.toCamelCase()](f["the_"+t]),h[t+"Ticks"]){if(h[t+"TicksAmount"]){var i=function(){return n&&h[t+"TicksAmount"]?h[t+"TicksAmount"]*h[t+"GridIncrement"]:h[t+"TicksAmount"]};r.ticks(i())}n?r.tickSize(-h[l(c(t))]).tickFormat(""):r.tickFormat(function(e,n){return f["format_"+t](e)})}return r},I=function(t){var n,r=h[t+"Data"];switch(t){case"color":n=e.scaleOrdinal().range(f["range_"+t]);break;case"x":case"y":n=h.nameIsNum||1==r?e.scaleLinear().range(f["range_"+t]):e.scaleBand().range(f["range_"+t]).paddingInner(.1).paddingOuter(.1)}return n},S=function(t,e,n){if(h[t+"Ticks"]){var r=n?"grid_":"";h[t+"Label"]&&(f["lab_"+t]=f.cont_labels.append("text").attr("class",i+"label-"+t).attr("y",function(){return x("y",t)}).attr("x",function(){return x("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(h[t+"Label"]),"y"==t&&f["lab_"+t].attr("transform","rotate(-90)")),f["rule_"+r+t]=D(t,e,n),f["axis_"+r+t]=C(t,n)}},L=function(r){var o=null;switch(f.duration=e.transition().duration(h.transition),h.type){case"bar":f.graphItem="rect";break;case"line":case"scatter":f.graphItem="circle"}if(o=h.srcKey?y(r,h.srcKey):r,h.nameIsNum){for(var l=[],c=0;c<o.length;c++)o[c]&&l.push(o[c]);l.sort(function(t,e){return y(t,h.dataKey[0],!0)-y(e,h.dataKey[0],!0)}),o=l}f.off_x=g("x"),f.off_y=g("y"),f.outerWidth=h.width+2*f.off_x,f.outerHeight=h.height+2*f.off_y,f.canvas=e.select(n).append("div").attr("class",i+"wrapper"),f.dimensionString="0 0 "+f.outerWidth+" "+f.outerHeight,f.svg=f.canvas.append("svg").attr("id",n+"-svg").attr("class",i+"svg").attr("viewBox",f.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+f.dimensionString).attr("width",f.outerWidth).attr("height",f.outerHeight),f.container=f.svg.append("g"),f.containerTransform=null;var s=1.25,d=.75,x=f.off_x,v=f.off_y;switch(h.yAlign+" "+(h.xLabel?"has":"empty")){case"left has":f.transformX=f.off_x*s;break;case"right has":f.transformX=f.off_x*d;break;default:f.transformX=f.off_x}switch(h.xAlign+" "+(h.yLabel?"has":"empty")){case"top has":f.transformX=f.off_y*s;break;case"bottom has":f.transformX=f.off_y*d;break;default:f.transformX=f.off_y}f.container.attr("transform","translate("+x+","+v+")"),"pie"==h.type||(f.cont_labels=f.container.append("g").attr("class",i+"labels"),f.cont_rule=f.container.append("g").attr("class",i+"axis"),(h.xGrid||h.yGrid)&&(f.cont_grid=f.container.append("g").attr("class",i+"grid")),a.forEach(function(t){switch(f["range_"+t]=m(t),f["dom_"+t]=b(t,o),f["the_"+t]=I(t),f["the_"+t]&&f["dom_"+t]&&f["the_"+t].domain(f["dom_"+t]),t){case"x":case"y":S(t,f.cont_rule),f["format_"+t]="function"==typeof h[t+"Parameter"]?h[t+"Parameter"]:"string"==typeof h[t+"Parameter"]?function(n){return e.format(h[t+"Parameter"])(n)}:function(e){var n=1==h[t+"Data"]||h.nameIsNum?e/h[t+"Divider"]:e,r;return h[t+"Prepend"]+n+h[t+"Append"]},h[t+"Ticks"]&&(f["rule_"+t].transition(h.delay).call(f["axis_"+t]).attr("font-family","inherit").attr("font-size",null),h[t+"Grid"]&&(S(t,f.cont_grid,!0),f["rule_grid_"+t].call(f["axis_grid_"+t]),f["rule_grid_"+t].selectAll(".tick").attr("class",function(e,n){var r="grid";return f["rule_"+t].selectAll(".tick").each(function(t){t==e&&(r+=" tick-aligned")}),r})));case"color":if(!(h.colorPalette.length>0))break}}),f.graph=f.container.insert("g").attr("class",i+"graph "+i+(h.colorPalette.length>0||null!==h.linePointsColor||null!==h.lineColor?"has-palette":"no-palette")+(h.xTicks||h.yTicks?"":" "+i+"item-data-no-ticks")),h.width==p.width&&h.height==p.height&&o.length>10||h.width<p.width&&(h.height,p.height),("line"!=h.type||h.linePoints)&&(f.blob=f.graph.selectAll(f.graphItem).data(o,function(t){return t[h.dataKey[h.xData]]}))),f.dv_init=!1,document.addEventListener("scroll",function(e){var n;u.getBoundingClientRect().y<.5*t.innerHeight&&!f.dv_init&&(f.dv_init=!0,setTimeout(function(){F(f,o)},h.delay))},!0)},F=function(t,e){console.log(n,"-------------------------------------------------------------------"),console.log("calculated",t),console.log("args",h),"pie"==h.type||("line"==h.type&&(h.lineFill&&(t.fill=t.graph.append("path").attr("class",i+"fill"+(null!==h.lineFillColor?" has-color":" no-color")).attr("fill-opacity",0).attr("d",function(){return T(e,!0,!0)}),(h.lineFillColor||h.lineColor)&&t.fill.attr("fill",h.lineFillColor||h.lineColor),t.fill.transition(t.duration).attr("fill-opacity",h.lineFillOpacity).attr("d",function(){return T(e,!0)})),t.line=t.graph.append("path").attr("class",i+"line"+(null!==h.lineColor?" has-color":" no-color")).attr("fill","none").attr("stroke-width",h.lineWeight).attr("stroke-linejoin","round").attr("stroke-opacity",0).attr("d",function(){return T(e,!1,!0)}).attr("stroke-dasharray","0,0"),h.lineColor&&t.line.attr("stroke",h.lineColor),t.line.transition(t.duration).attr("d",function(){return T(e,!1)}).attr("stroke-dasharray",h.lineDash).attr("stroke-opacity",1)),("line"!=h.type||h.linePoints)&&(t.blob.exit().transition(t.duration).attr("height",0).remove(),t.blobWrap=t.blob.enter().append("g").attr("class",function(t){return i+"item "+i+y(t,h.dataKey[0])}),t.blobItem=t.blobWrap.append(t.graphItem).attr("line"==h.type||"scatter"==h.type?"cx":"x",function(t,e){return P("x",t,e,!0)}).attr("line"==h.type||"scatter"==h.type?"cy":"y",function(t,e){return P("y",t,e,!0)}),"line"==h.type||"scatter"==h.type?t.blobItem.attr("r",function(t,e){return k(t,e,!0)}):t.blobItem.attr("width",function(t,e){return v("x",t,e,!0)}).attr("height",function(t,e){return v("y",t,e,!0)}),h.colorPalette.length?t.blobItem.attr("fill",function(e,n){return t.the_color(e[h.colorData])}):"line"==h.type&&(h.linePointsColor||h.lineColor)&&t.blobItem.attr("fill",function(){return h.linePointsColor||h.lineColor}),t.blobItem.transition(t.duration).attr("line"==h.type||"scatter"==h.type?"cx":"x",function(t,e){return P("x",t,e)}).attr("line"==h.type||"scatter"==h.type?"cy":"y",function(t,e){return P("y",t,e)}),"line"==h.type||"scatter"==h.type?t.blobItem.transition(t.duration).attr("r",function(t,e){return k(t,e)}):t.blobItem.transition(t.duration).attr("width",function(t,e){return v("x",t,e)}).attr("height",function(t,e){return v("y",t,e)}))),h.xTicks&&h.yTicks||(t.blobText=t.blobWrap.append("text"),r.forEach(function(e){h[e+"Ticks"]||(t["blobText_"+e]=t.blobText.append("tspan").attr("class",i+"item-data-"+h[e+"Data"]).attr("dominant-baseline","middle").attr("text-anchor",function(t,e){return _(t,e)}).attr("font-size",null).text(function(n,r){return t["format_"+e](y(n,h.dataKey[h[e+"Data"]]))}).attr("x",A("x",e)).attr("y",A("y",e)),t.mLength=function(e,n){var r=0;return length=t.blobText?t.blobText.nodes()[n].getBoundingClientRect()[l(e)]:0,r=length+15})}),t.blobText.attr("class",function(e,n){var a=i+"item-text";return r.forEach(function(r){console.log(r,parseFloat(v(r,e,n,!1)),t.mLength(r,n)),(1==h[r+"Data"]&&(parseFloat(v(r,e,n,!1))<t.mLength(r,n)||h.colorPalette.length>0&&parseFloat(v(r,e,n,!1))>=t.mLength(r,n)&&!s(t.the_color(e[h.colorData])))||"line"==h.type)&&(a+=" dark")}),a}).attr("transform",function(t,e){return"translate("+w("x",t,e,!0)+","+w("y",t,e,!0)+")"}).style("opacity",0),t.blobText.transition(t.duration).attr("transform",function(t,e){return"translate("+w("x",t,e)+","+w("y",t,e)+")"}).style("opacity",1))};switch(h.srcPath.getFileExtension()){case"csv":e.csv(h.srcPath).then(function(t){L(t)});break;case"tsv":e.tsv(h.srcPath).then(function(t){L(t)});break;case"json":e.json(h.srcPath).then(function(t){L(t)});break;default:if(h.srcPath.getHash()){var K=u.querySelector('script[type="application/json"]').innerHTML;if(K.isValidJSONString()){var N=JSON.parse(K);L(N)}else"text"==h.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}};n.dataVisualizer=u,t._1p21=n}(window,d3);