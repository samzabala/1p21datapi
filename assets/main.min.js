"use strict";!function(K,S){var t=t||{},e=["x","y"],L=["x","y","colors","area","r"],C="data-visualizer-",I=function(t,e){return e?"x"==t?"height":"width":"x"==t?"width":"height"},O=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t=0,e,n;if(0===this.length)return t;for(e=0;e<this.length;e++)t=(t<<5)-t+(n=this.charCodeAt(e)),t|=0;return t},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.toCamelCase=function(){var t;return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")};var F=function(t){var e,n,a,r;return a=t.match(/^rgb/)?(e=(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=t[2],t[3]):(e=(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")))>>16,n=t>>8&255,255&t),!(170<(r=Math.sqrt(e*e*.299+n*n*.587+a*a*.114)))},n=function(l,t){var s=document.querySelector(l),c={},u={width:600,height:400,margin:20,marginOffset:2,transition:1500,delay:300,type:"bar",dataKey:[0,1],xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xTicksParameter:null,xMin:null,xMax:null,xGrid:!1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yTicksParameter:null,yMin:null,yMax:null,yGrid:!1,yPrepend:"",yAppend:"",yDivider:1,dataKey0IsNum:!1,lineStyle:"",lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillAxis:"x",lineDash:[],colors:[],colorsData:null,areaKey:"",srcType:"",srcPath:"",srcKey:null},y=u;for(var e in t)t.hasOwnProperty(e)&&(y[e]=t[e]);c.mLength=y.xTicks||y.yTicks?70:120;var f=function(t){var e=0;return"pie"!==y.type&&(e=y.margin*(.75*y.marginOffset),y[t+"Label"]&&(e=y.margin*y.marginOffset),"x"==t&&0==y[O(t)+"Data"]&&(e=y.margin*(1.75*y.marginOffset),y[O(t)+"Label"]&&(e+=.5*y.marginOffset))),e},p=function(t,e,n){var a=e.split("."),r;function i(t,e){var n=null;return n=e.length?i(t[e[0]],e.slice(1)):t}return a.forEach(function(t,e){""==t&&a.splice(e,1)}),n?parseFloat(i(t,a)):i(t,a)},d=function(t){var e=[];switch(t){case"colors":e=y[t];break;case"x":case"y":e="top"==y[O(t)+"Align"]||"left"==y[O(t)+"Align"]?[0,y[I(t)]]:[y[I(t)],0]}return e},h=function(t,e){var n=y[t+"Data"],a=[];if(null!==n){switch(t){case"colors":var r=y.colorsData||y.dataKey[0],i;a=e.reduce(function(t,e){return t.includes(p(e,r))||t.push(p(e,r)),t},[]);break;case"x":case"y":var o,l;if(y.dataKey0IsNum||1==n)a=[o=null!==y[t+"Min"]?y[t+"Min"]:S.min(e,function(t){return p(t,y.dataKey[n],n)}),l=null!==y[t+"Max"]?y[t+"Max"]:S.max(e,function(t){return p(t,y.dataKey[n],n)})];else a=e.map(function(t){return p(t,y.dataKey[n],n)})}return a}},n=function(t,e){var n=0;return"x"==t?"x"==e?n=y[I(e)]/2:"y"==e&&(n=-y[I(e)]/2):"x"==e?n="bottom"==y[e+"Align"]?y[I(e,!0)]+(c.off_y-.125*y.margin):-(c.off_y-1.5*y.margin):"y"==e&&(n="right"==y[e+"Align"]?y[I(e,!0)]+c.off_x:-.125*c.off_x),n},g=function(t,e,n,a){var r=y[t+"Data"],i=y.dataKey[r],o=y[O(t)+"Align"],l=20;switch(a=a||!1,y.type){case"pie":break;default:l=y.dataKey0IsNum||1==r?a?0:"right"==o||"bottom"==o?y[I(t)]-c["the_"+t](p(e,i,i)):c["the_"+t](p(e,i,i)):c["the_"+t].bandwidth()}return l},a=function(t,e,n){var a=2;return n?a=0:"line"==y.type&&y.linePointsSize&&(a=y.linePointsSize),a},i=function(t,e){var n="middle";return 0==y.xData&&(n="bottom"==y.xAlign?"hanging":"auto"),n},o=function(t,e){var n="middle";return"pie"==y.type||0==y.yData&&(n="start"),n},m=function(t,e,n,a,r){var i=0;return r=r||!1,"pie"==y.type||(!y.xTicks&&y.yTicks||y.xTicks&&!y.yTicks?1==y[t+"Data"]&&(i="top"==y.xAlign?parseFloat(g("y",n,a,!1))>c.mLength||r&&parseFloat(g("y",n,a,!1))<c.mLength?"-1em":"2em":"1em"):"x"==t?1==y[t+"Data"]&&(i="10"):i=0==y[O(t)+"Data"]?"bottom"==y[O(t)+"Align"]?parseFloat(g("y",n,a,!1))>c.mLength||r&&parseFloat(g("y",n,a,!1))<c.mLength?"1.5em":"-2.5em":n[y.dataKey[y[t+"Data"]]]!==n[y.dataKey[y[e+"Data"]]]?"-2em":"-1.75em":n[y.dataKey[y[t+"Data"]]]!==n[y.dataKey[y[e+"Data"]]]?"-.25em":"1.375em"),i},x=function(t,e,n,a){var r=y[t+"Data"],i=0;return a=a||!1,"pie"==y.type||(0==r?(i=b(t,e,n)+g(t,e,n)/2,"line"!=y.type&&"scatter"!=y.type||(i-=g(t,e,n)/2)):"bottom"==y[O(t)+"Align"]||"right"==y[O(t)+"Align"]?i=a?y[I(t)]-(y.xTicks||y.yTicks?30:65):y[I(t)]-g(t,e,n):"top"==y[O(t)+"Align"]&&(a?0!==y[O(t)+"Data"]?i=y[I(t)]-g(t,e,n):i+=y.xTicks||y.yTicks?30:c.mLength:i=g(t,e,n))),i},b=function(t,e,n,a){var r=y[t+"Data"],i=y.dataKey[r],o=y[O(t)+"Align"],l=0;switch(a=a||!1,y.type){case"pie":break;case"scatter":case"line":default:y.dataKey0IsNum||1==r?"right"==o||"bottom"==o?l=a?y[I(t)]:y[I(t)]-(y[I(t)]-c["the_"+t](p(e,i,r))):"line"!=y.type&&"scatter"!=y.type||(l=c["the_"+t](p(e,i,r))):(l=c["the_"+t](p(e,i,r)),"line"!=y.type&&"scatter"!=y.type||(l+=g(t,e,n)/2))}return l},v=function(t,n){var e;return n=n||!1,S.line().x(function(t,e){return b("x",t,e,n)}).y(function(t,e){return b("y",t,e,n)})(t)},r=function(t,e){var n=e.append("g").attr("class",C+"axis-"+t+" "+C+"axis-align-"+y[t+"Align"]),a="";switch(t+" "+y[t+"Align"]){case"x bottom":a="0,"+y.height;break;case"y right":a=y.width+",0";break;default:a="0,0"}return n.attr("transform","translate("+a+")"),n},_=function(t){var e,n="Axis "+y[t+"Align"];return e=S[n.toCamelCase()](c["the_"+t]),y.hasOwnProperty(t+"Ticks")&&(y.hasOwnProperty(t+"TicksFormat")&&e.tickFormat(c["format_"+t]),y.hasOwnProperty(t+"TicksAmount")&&e.ticks(y[t+"TicksAmount"])),e},k=function(t){var e,n=y[t+"Data"];switch(t){case"colors":e=S.scaleOrdinal().range(c["range_"+t]);break;case"x":case"y":e=y.dataKey0IsNum||1==n?S.scaleLinear().range(c["range_"+t]):S.scaleBand().range(c["range_"+t]).paddingInner(.1).paddingOuter(.1)}return e},T=function(t,e){y[t+"Ticks"]&&(y[t+"Label"]&&(c["lab_"+t]=c.labels.append("text").attr("class",C+"label-"+t).attr("y",function(){return n("y",t)}).attr("x",function(){return n("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(y[t+"Label"]),"y"==t&&c["lab_"+t].attr("transform","rotate(-90)")),c["rule_"+t]=r(t,e),c["axis_"+t]=_(t))},w=function(t,n){var a=null;switch(n.duration=S.transition().duration(y.transition),y.type){case"bar":n.graphItem="rect";break;case"line":case"scatter":n.graphItem="circle"}a=y.srcKey?p(t,y.srcKey):t,y.dataKey0IsNum&&a.sort(function(t,e){return p(t,y.dataKey[0],!0)-p(e,y.dataKey[0],!0)}),n.off_x=f("x"),n.off_y=f("y"),n.outerWidth=y.width+2*n.off_x,n.outerHeight=y.height+2*n.off_y,n.canvas=S.select(l).append("div").attr("class",C+"wrapper"),n.dimensionString="0 0 "+n.outerWidth+" "+n.outerHeight,n.svg=n.canvas.append("svg").attr("id",l+"-svg").attr("class",C+"svg").attr("viewBox",n.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+n.dimensionString).attr("width",n.outerWidth).attr("height",n.outerHeight),n.container=n.svg.append("g"),n.containerTransform=null;var e=1.25,r=.75,i=n.off_x,o=n.off_y;switch(y.yAlign+" "+(""==y.xLabel?"empty":"has")){case"left has":n.transformX=n.off_x*e;break;case"right has":n.transformX=n.off_x*r;break;default:n.transformX=n.off_x}switch(y.xAlign+" "+(""==y.yLabel?"empty":"has")){case"top has":n.transformX=n.off_y*e;break;case"bottom has":n.transformX=n.off_y*r;break;default:n.transformX=n.off_y}n.container.attr("transform","translate("+i+","+o+")"),"pie"==y.type||(n.labels=n.container.append("g").attr("class",C+"labels"),n.rule=n.container.append("g").attr("class",C+"axis"),L.forEach(function(t){n["range_"+t]=d(t),n["the_"+t]=k(t),"x"!=t&&"y"!=t||(T(t,n.rule),n["format_"+t]=y[t+"Parameter"]||function(t){var e=1==y[axisString+"Data"]?t/y[axisString+"Divider"]:t,n;return y[axisString+"Prepend"]+e+y[axisString+"Append"]})}),n.dom_x=h("x",a),n.the_x.domain(n.dom_x),y.xTicks&&n.rule_x.transition(y.delay).call(n.axis_x).attr("font-family","inherit").attr("font-size",null),n.dom_y=h("y",a),n.the_y.domain(n.dom_y),y.yTicks&&n.rule_y.transition(y.delay).call(n.axis_y).attr("font-family","inherit").attr("font-size",null),n.graph=n.container.insert("g",":first-child").attr("class",C+"graph "+C+(0<y.colors.length||y.linePointsColor||y.lineColor?"has-palette":"no-palette")),9<a.length&&y.width==u.width&&y.height==u.height&&console.log(l+" Width and height was not adjusted. graph elements may not fit in the canvas"),("line"!=y.type||y.linePoints)&&(n.blob=n.graph.selectAll(n.graphItem).data(a,function(t){return t[y.dataKey[y.xData]]})),"line"==y.type&&(n.line=n.graph.append("path").attr("class",C+"line").attr("fill","none").attr("d",function(){return v(a,!0)}),y.lineColor&&n.line.attr("stroke",y.lineColor)),0<y.colors.length&&(n.dom_color=h("colors",a))),n.dv_init=!1,document.addEventListener("scroll",function(t){var e;s.getBoundingClientRect().y<.5*K.innerHeight&&!n.dv_init&&(n.dv_init=!0,setTimeout(function(){A(n,a)},y.delay))},!0)},A=function(r,t){console.log(l,"-------------------------------------------------------------------"),console.log("args",y),console.log("x"),console.log("domain",r.dom_x),console.log("range",r.range_x),console.log("----------------"),console.log("y"),console.log("domain",r.dom_y),console.log("range",r.range_y),"pie"==y.type||(("line"!=y.type||y.linePoints)&&(r.blob.exit().transition(r.duration).attr("height",0).remove(),r.blobWrap=r.blob.enter().append("g").attr("class",C+"item"),r.blobItem=r.blobWrap.append(r.graphItem).attr("line"==y.type||"scatter"==y.type?"cx":"x",function(t,e){return b("x",t,e,!0)}).attr("line"==y.type||"scatter"==y.type?"cy":"y",function(t,e){return b("y",t,e,!0)}),"line"==y.type||"scatter"==y.type?r.blobItem.attr("r",function(t,e){return a(t,e,!0)}):r.blobItem.attr("width",function(t,e){return g("x",t,e,!0)}).attr("height",function(t,e){return g("y",t,e,!0)}),y.colors.length?r.blobItem.attr("fill",function(t,e){return r.the_colors(t[y.colorsData])}):"line"==y.type&&(y.linePointsColor||y.lineColor)&&r.blobItem.attr("fill",function(){return y.linePointsColor||y.lineColor}),r.blobItem.transition(r.duration).attr("line"==y.type||"scatter"==y.type?"cx":"x",function(t,e){return b("x",t,e)}).attr("line"==y.type||"scatter"==y.type?"cy":"y",function(t,e){return b("y",t,e)}),"line"==y.type||"scatter"==y.type?r.blobItem.transition(r.duration).attr("r",function(t,e){return a(t,e)}):r.blobItem.transition(r.duration).attr("width",function(t,e){return g("x",t,e)}).attr("height",function(t,e){return g("y",t,e)})),"line"==y.type&&"line"==y.type&&r.line.transition(r.duration).attr("d",function(){return v(t)})),y.xTicks&&y.yTicks||(r.blobText=r.blobWrap.append("g").attr("class",C+"item-text"+(y.xTicks||y.yTicks?"":" "+C+"item-data-no-ticks")).attr("transform",function(t,e){return"translate("+x("x",t,e,!0)+","+x("y",t,e,!0)+")"}).style("opacity",0),r.blobText.transition(r.duration).attr("transform",function(t,e){return"translate("+x("x",t,e)+","+x("y",t,e)+")"}).style("opacity",1),["x","y"].forEach(function(a){y[a+"Ticks"]||(r["blobText"+a]=r.blobText.append("text").attr("class",function(t,e){var n=C+"item-data-"+y[a+"Data"];return(parseFloat(g("y",t,e,!1))<r.mLength||0<y.colors.length&&parseFloat(g("y",t,e,!1))>r.mLength&&!F(r.the_colors(t[y.colorsData]))||"line"==y.type)&&(n+=" item-text-dark color-palette-"+y.colors.length),n}).attr("dominant-baseline",function(t,e){return i(t,e)}).attr("text-anchor",function(t,e){return o(t,e)}).attr("font-size",null).text(function(t,e){return p(t,y.dataKey[y[a+"Data"]],y[a+"Data"])}).attr("x",function(t,e){return m("x",a,t,e,!0)}).attr("y",function(t,e){return m("y",a,t,e,!0)}),r["blobText"+a].transition(r.duration).attr("x",function(t,e){return m("x",a,t,e)}).attr("y",function(t,e){return m("y",a,t,e)}))}))};switch(y.srcPath.getFileExtension()){case"csv":S.csv(y.srcPath).then(function(t){w(t,c)});break;case"tsv":S.tsv(y.srcPath).then(function(t){w(t,c)});break;case"json":S.json(y.srcPath).then(function(t){w(t,c)});break;default:if(y.srcPath.getHash()){var D=s.querySelector('script[type="application/json"').innerHTML;if(D.isValidJSONString()){var P=JSON.parse(D);w(P,c)}else"text"==y.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}};t.dataVisualizer=n,K._1p21=t}(window,d3);