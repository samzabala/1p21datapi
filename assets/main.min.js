!function(D,P){var t=t||{},S=["x","y"],K=["x","y","colors","area","r"],O=70,a=70;prefix="data-visualizer-";var L=function(t,a){return a?"x"==t?"height":"width":"x"==t?"width":"height"},M=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t=0,a,e;if(0===this.length)return t;for(a=0;a<this.length;a++)t=(t<<5)-t+(e=this.charCodeAt(a)),t|=0;return t},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0};var F=function(t){var a,e,r,n;return console.log(t),r=t.match(/^rgb/)?(a=(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],e=t[2],t[3]):(a=(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")))>>16,e=t>>8&255,255&t),n=Math.sqrt(a*a*.299+e*e*.587+r*r*.114),console.log(n),console.log("------"),!(170<n)},e=function(a,t){var c=document.querySelector(a),l={},u={width:600,height:400,margin:20,marginOffset:2,transition:1500,delay:250,type:"bar",dataKey:[0,1],xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xTicksParameter:null,xMin:null,xMax:null,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yTicksParameter:null,yMin:null,yMax:null,yPrepend:"",yAppend:"",yDivider:1,colors:[],colorsData:"",areaKey:"",srcType:"",srcPath:"",srcKey:null},f=u;for(var e in t)t.hasOwnProperty(e)&&(f[e]=t[e]);var h=function(t){var a=0;return"pie"!==f.type&&(a=f.margin*(.75*f.marginOffset),f[t+"Label"]&&(a=f.margin*f.marginOffset),"x"==t&&0==f[M(t)+"Data"]&&(a=f.margin*(1.75*f.marginOffset),f[M(t)+"Label"]&&(a+=.5*f.marginOffset))),a},p=function(t,a,e,r){r&&console.log("parameters",t,a,e);var n=a.split("."),i;function o(t,a){var e=null;return e=a.length?o(t[a[0]],a.slice(1)):t}return r&&console.log("split keys:",n),n.forEach(function(t,a){""==t&&n.splice(a,1)}),e?parseFloat(o(t,n)):o(t,n)},d=function(t){var a=[];switch(t){case"colors":a=f[t];break;case"x":case"y":a="top"==f[M(t)+"Align"]||"left"==f[M(t)+"Align"]?[0,f[L(t)]]:[f[L(t)],0]}return a},g=function(t,a){var e=f[t+"Data"],r=[];switch(t){case"colors":var n=f.colorsData||f.dataKey[0],i;r=a.reduce(function(t,a){return t.includes(p(a,n))||t.push(p(a,n)),t},[]);break;case"x":case"y":switch(e){case 1:var o,s;r=[o=null!==f[t+"Min"]?f[t+"Min"]:P.min(a,function(t){return p(t,f.dataKey[e],e)}),s=null!==f[t+"Max"]?f[t+"Max"]:P.max(a,function(t){return p(t,f.dataKey[e],e)})];break;default:r=a.map(function(t){return p(t,f.dataKey[e],e)})}}return r},r=function(t,a){var e=0;return"x"==t?"x"==a?e=f[L(a)]/2:"y"==a&&(e=-f[L(a)]/2):"x"==a?e="bottom"==f[a+"Align"]?f[L(a,!0)]+(l.off_y-.125*f.margin):-(l.off_y-1.5*f.margin):"y"==a&&(e="right"==f[a+"Align"]?f[L(a,!0)]+l.off_x:-.125*l.off_x),e},o=function(t,a,e,r){var n=f[t+"Data"],i=f.dataKey[n],o=f[M(t)+"Align"],s=20;switch(r=r||!1,f.type){case"pie":case"scatter":break;default:s=0==n?l["the_"+t].bandwidth():r?0:"right"==o||"bottom"==o?f[L(t)]-l["the_"+t](p(a,i,i)):l["the_"+t](p(a,i,i))}return s},i=function(t,a){var e="middle";return 0==f.xData&&(e="bottom"==f.xAlign?"hanging":"auto"),e},s=function(t,a){var e="middle";return"pie"==f.type||0==f.yData&&(e="start"),e},y=function(t,a,e,r,n){var i=0;return n=n||!1,"pie"==f.type||(!f.xTicks&&f.yTicks||f.xTicks&&!f.yTicks?1==f[t+"Data"]&&(i="top"==f.xAlign?parseFloat(o("y",e,r,!1))>O||n&&parseFloat(o("y",e,r,!1))<O?"-1em":"2em":"1em"):"x"==t?1==f[t+"Data"]&&(i="10"):i=0==f[M(t)+"Data"]?"bottom"==f[M(t)+"Align"]?"1.5em":e[f.dataKey[f[t+"Data"]]]!==e[f.dataKey[f[a+"Data"]]]?"-2em":"-1.75em":e[f.dataKey[f[t+"Data"]]]!==e[f.dataKey[f[a+"Data"]]]?"-.25em":"1.375em"),i},x=function(t,a,e,r){var n=f[t+"Data"],i=0;return r=r||!1,"pie"==f.type||"line"==f.type||(0==n?i=m(t,a,e)+o(t,a,e)/2:"bottom"==f[M(t)+"Align"]||"right"==f[M(t)+"Align"]?i=r?f[L(t)]-(f.xTicks||f.yTicks?30:65):f[L(t)]-o(t,a,e):"top"==f[M(t)+"Align"]&&(r?0!==f[M(t)+"Data"]?i=f[L(t)]-o(t,a,e):i+=f.xTicks||f.yTicks?30:70:i=o(t,a,e))),i},m=function(t,a,e,r){var n=f[t+"Data"],i=f.dataKey[n],o=f[M(t)+"Align"],s=0;switch(r=r||!1,f.type){case"pie":case"scatter":break;default:0==n?s=l["the_"+t](p(a,i,n)):"right"!=o&&"bottom"!=o||(s=r?f[L(t)]:f[L(t)]-(f[L(t)]-l["the_"+t](p(a,i,n))))}return s},n=function(t,a){var e=a.append("g").attr("class",prefix+"axis-"+t+" "+prefix+"axis-align-"+f[t+"Align"]),r="";switch(t+" "+f[t+"Align"]){case"x bottom":r="0,"+f.height;break;case"y right":r=f.width+",0";break;default:r="0,0"}return e.attr("transform","translate("+r+")"),e},b=function(t){var a;switch(f[t+"Align"]){case"top":a=P.axisTop(l["the_"+t]);break;case"bottom":a=P.axisBottom(l["the_"+t]);break;case"left":a=P.axisLeft(l["the_"+t]);break;case"right":a=P.axisRight(l["the_"+t])}return f.hasOwnProperty(t+"Ticks")&&(f.hasOwnProperty(t+"TicksFormat")&&a.tickFormat(l["format_"+t]),f.hasOwnProperty(t+"TicksAmount")&&a.ticks(f[t+"TicksAmount"])),a},v=function(t){var a,e=f[t+"Data"];switch(t){case"colors":a=P.scaleOrdinal().range(l["range_"+t]);break;case"x":case"y":switch(e){case 0:a=P.scaleBand().range(l["range_"+t]).paddingInner(.1).paddingOuter(.1);break;default:a=P.scaleLinear().range(l["range_"+t])}}return a},k=function(t,a){f[t+"Ticks"]&&(f[t+"Label"]&&(l["lab_"+t]=l.labels.append("text").attr("class",prefix+"label-"+t).attr("y",function(){return r("y",t)}).attr("x",function(){return r("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(f[t+"Label"]),"y"==t&&l["lab_"+t].attr("transform","rotate(-90)")),l["rule_"+t]=n(t,a),l["axis_"+t]=b(t))},_=function(t,a,e){var r=null;switch(e.duration=P.transition().duration(f.transition),f.type){case"bar":e.graphItem="rect";break;case"scatter":e.graphItem="circle"}r=f.srcKey?p(a,f.srcKey):a,e.off_x=h("x"),e.off_y=h("y"),e.outerWidth=f.width+2*e.off_x,e.outerHeight=f.height+2*e.off_y,e.canvas=P.select(t).append("div").attr("class",prefix+"wrapper"),e.dimensionString="0 0 "+e.outerWidth+" "+e.outerHeight,e.svg=e.canvas.append("svg").attr("id",t+"-svg").attr("class",prefix+"svg").attr("viewBox",e.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+e.dimensionString).attr("width",e.outerWidth).attr("height",e.outerHeight),e.container=e.svg.append("g"),e.containerTransform=null;var n=1.25,i=.75,o=e.off_x,s=e.off_y;switch(f.yAlign+" "+(""==f.xLabel?"empty":"has")){case"left has":e.transformX=e.off_x*n;break;case"right has":e.transformX=e.off_x*i;break;default:e.transformX=e.off_x}switch(f.xAlign+" "+(""==f.yLabel?"empty":"has")){case"top has":e.transformX=e.off_y*n;break;case"bottom has":e.transformX=e.off_y*i;break;default:e.transformX=e.off_y}e.container.attr("transform","translate("+o+","+s+")"),"pie"==f.type||(e.labels=e.container.append("g").attr("class",prefix+"labels"),e.rule=e.container.append("g").attr("class",prefix+"axis"),K.forEach(function(t){e["range_"+t]=d(t),e["the_"+t]=v(t),"x"!=t&&"y"!=t||(k(t,e.rule),e["format_"+t]=f[t+"Parameter"]||function(t){var a=1==f[axisString+"Data"]?t/f[axisString+"Divider"]:t,e;return f[axisString+"Prepend"]+a+f[axisString+"Append"]})}),e.dom_x=g("x",r),e.the_x.domain(e.dom_x),f.xTicks&&e.rule_x.transition(f.delay).call(e.axis_x).attr("font-family","inherit").attr("font-size",null),e.dom_y=g("y",r),e.the_y.domain(e.dom_y),f.yTicks&&e.rule_y.transition(f.delay).call(e.axis_y).attr("font-family","inherit").attr("font-size",null),e.graph=e.container.insert("g",":first-child").attr("class",prefix+"graph "+prefix+(0<f.colors.length?"has-palette":"no-palette")),9<r.length&&f.width==u.width&&f.height==u.height&&console.log(t+" Width and height was not adjusted. graph elements may not fit in the canvas"),e.blob=e.graph.selectAll(e.graphItem).data(r,function(t){return t[f.dataKey[f.xData]]}),0<f.colors.length&&(e.dom_color=g("colors",r))),e.dv_init=!1,document.addEventListener("scroll",function(t){scrollOffset=D.pageYOffset,graphPosition=c.getBoundingClientRect().y,graphPosition<.5*D.innerHeight&&!e.dv_init&&(e.dv_init=!0,setTimeout(function(){T(e)},f.delay))},!0)},T=function(n){"pie"==f.type||(n.blob.exit().transition(n.duration).attr("height",0).remove(),n.blobWrap=n.blob.enter().append("g").attr("class",prefix+"item"),n.blobItem=n.blobWrap.append(n.graphItem).attr("width",function(t,a){return o("x",t,a,!0)}).attr("height",function(t,a){return o("y",t,a,!0)}).attr("x",function(t,a){return m("x",t,a,!0)}).attr("y",function(t,a){return m("y",t,a,!0)}),0<f.colors.length&&n.blobItem.attr("fill",function(t,a){return n.the_colors(a)}),n.blobItem.transition(n.duration).attr("width",function(t,a){return o("x",t,a)}).attr("height",function(t,a){return o("y",t,a)}).attr("x",function(t,a){return m("x",t,a)}).attr("y",function(t,a){return m("y",t,a)}),f.xTicks&&f.yTicks||(n.blobText=n.blobWrap.append("g").attr("class",prefix+"item-text"+(f.xTicks||f.yTicks?"":" "+prefix+"item-data-no-ticks")).attr("transform",function(t,a){return"translate("+x("x",t,a,!0)+","+x("y",t,a,!0)+")"}).style("opacity",0),n.blobText.transition(n.duration).attr("transform",function(t,a){return"translate("+x("x",t,a)+","+x("y",t,a)+")"}).style("opacity",1),"pie"==f.type||S.forEach(function(r){f[r+"Ticks"]||(n["blobText"+r]=n.blobText.append("text").attr("class",function(t,a){var e=prefix+"item-data-"+f[r+"Data"];return(parseFloat(o("y",t,a,!1))<O||0<f.colors.length&&parseFloat(o("y",t,a,!1))>O&&!F(n.the_colors(a)))&&(console.log("punyeta"),e+=" item-text-dark"),e}).attr("dominant-baseline",function(t,a){return i(t,a)}).attr("text-anchor",function(t,a){return s(t,a)}).attr("font-size",null).text(function(t,a){return p(t,f.dataKey[f[r+"Data"]],f[r+"Data"])}).attr("x",function(t,a){return y("x",r,t,a,!0)}).attr("y",function(t,a){return y("y",r,t,a,!0)}),n["blobText"+r].transition(n.duration).attr("x",function(t,a){return y("x",r,t,a)}).attr("y",function(t,a){return y("y",r,t,a)}))})))};switch(f.srcPath.getFileExtension()){case"csv":P.csv(f.srcPath).then(function(t){_(a,t,l)});break;case"tsv":P.tsv(f.srcPath).then(function(t){_(a,t,l)});break;case"json":P.json(f.srcPath).then(function(t){_(a,t,l)});break;default:if(f.srcPath.getHash()){var w=c.querySelector('script[type="application/json"').innerHTML;if(w.isValidJSONString()){var A=JSON.parse(w);_(a,A,l)}else"text"==f.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}};t.dataVisualizer=e,D._1p21=t}(window,d3);