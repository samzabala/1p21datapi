"use strict";!function(S,L){var t=t||{},e=["x","y"],C=["x","y","colors","area","r"],K="data-visualizer-",O=function(t,e){return e?"x"==t?"height":"width":"x"==t?"width":"height"},F=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t=0,e,n;if(0===this.length)return t;for(e=0;e<this.length;e++)t=(t<<5)-t+(n=this.charCodeAt(e)),t|=0;return t},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.toCamelCase=function(){var t;return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")};var I=function(t){var e,n,a,r;return a=t.match(/^rgb/)?(e=(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=t[2],t[3]):(e=(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")))>>16,n=t>>8&255,255&t),!(170<(r=Math.sqrt(e*e*.299+n*n*.587+a*a*.114)))},n=function(l,t){var s=document.querySelector(l),c={},u={width:600,height:400,margin:20,marginOffset:2,transition:1500,delay:300,type:"bar",dataKey:[0,1],xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xTicksParameter:null,xMin:null,xMax:null,xGrid:!1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yTicksParameter:null,yMin:null,yMax:null,yGrid:!1,yPrepend:"",yAppend:"",yDivider:1,lineStyle:"",lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillAxis:"x",lineDash:[],colors:[],colorsData:null,areaKey:"",srcType:"",srcPath:"",srcKey:null},f=u;for(var e in t)t.hasOwnProperty(e)&&(f[e]=t[e]);c.mLength=f.xTicks||f.yTicks?70:120;var y=function(t){var e=0;return"pie"!==f.type&&(e=f.margin*(.75*f.marginOffset),f[t+"Label"]&&(e=f.margin*f.marginOffset),"x"==t&&0==f[F(t)+"Data"]&&(e=f.margin*(1.75*f.marginOffset),f[F(t)+"Label"]&&(e+=.5*f.marginOffset))),e},p=function(t,e,n){var a=e.split("."),r;function i(t,e){var n=null;return n=e.length?i(t[e[0]],e.slice(1)):t}return a.forEach(function(t,e){""==t&&a.splice(e,1)}),n?parseFloat(i(t,a)):i(t,a)},h=function(t){var e=[];switch(t){case"colors":e=f[t];break;case"x":case"y":e="top"==f[F(t)+"Align"]||"left"==f[F(t)+"Align"]?[0,f[O(t)]]:[f[O(t)],0]}return e},d=function(t,e){var n=f[t+"Data"],a=[];if(null!==n){switch(t){case"colors":var r=f.colorsData||f.dataKey[0],i;a=e.reduce(function(t,e){return t.includes(p(e,r))||t.push(p(e,r)),t},[]);break;case"x":case"y":switch(n){case 1:var o,l;a=[o=null!==f[t+"Min"]?f[t+"Min"]:L.min(e,function(t){return p(t,f.dataKey[n],n)}),l=null!==f[t+"Max"]?f[t+"Max"]:L.max(e,function(t){return p(t,f.dataKey[n],n)})];break;default:a=e.map(function(t){return p(t,f.dataKey[n],n)})}}return a}},n=function(t,e){var n=0;return"x"==t?"x"==e?n=f[O(e)]/2:"y"==e&&(n=-f[O(e)]/2):"x"==e?n="bottom"==f[e+"Align"]?f[O(e,!0)]+(c.off_y-.125*f.margin):-(c.off_y-1.5*f.margin):"y"==e&&(n="right"==f[e+"Align"]?f[O(e,!0)]+c.off_x:-.125*c.off_x),n},g=function(t,e,n,a){var r=f[t+"Data"],i=f.dataKey[r],o=f[F(t)+"Align"],l=20;switch(a=a||!1,f.type){case"pie":break;default:l=0==r?c["the_"+t].bandwidth():a?0:"right"==o||"bottom"==o?f[O(t)]-c["the_"+t](p(e,i,i)):c["the_"+t](p(e,i,i))}return l},a=function(t,e,n){var a=2;return n?a=0:"line"==f.type&&f.linePointsSize&&(a=f.linePointsSize),a},i=function(t,e){var n="middle";return 0==f.xData&&(n="bottom"==f.xAlign?"hanging":"auto"),n},o=function(t,e){var n="middle";return"pie"==f.type||0==f.yData&&(n="start"),n},x=function(t,e,n,a,r){var i=0;return r=r||!1,"pie"==f.type||(!f.xTicks&&f.yTicks||f.xTicks&&!f.yTicks?1==f[t+"Data"]&&(i="top"==f.xAlign?parseFloat(g("y",n,a,!1))>c.mLength||r&&parseFloat(g("y",n,a,!1))<c.mLength?"-1em":"2em":"1em"):"x"==t?1==f[t+"Data"]&&(i="10"):i=0==f[F(t)+"Data"]?"bottom"==f[F(t)+"Align"]?parseFloat(g("y",n,a,!1))>c.mLength||r&&parseFloat(g("y",n,a,!1))<c.mLength?"1.5em":"-2.5em":n[f.dataKey[f[t+"Data"]]]!==n[f.dataKey[f[e+"Data"]]]?"-2em":"-1.75em":n[f.dataKey[f[t+"Data"]]]!==n[f.dataKey[f[e+"Data"]]]?"-.25em":"1.375em"),i},m=function(t,e,n,a){var r=f[t+"Data"],i=0;return a=a||!1,"pie"==f.type||(0==r?(i=b(t,e,n)+g(t,e,n)/2,"line"!=f.type&&"scatter"!=f.type||(i-=g(t,e,n)/2)):"bottom"==f[F(t)+"Align"]||"right"==f[F(t)+"Align"]?i=a?f[O(t)]-(f.xTicks||f.yTicks?30:65):f[O(t)]-g(t,e,n):"top"==f[F(t)+"Align"]&&(a?0!==f[F(t)+"Data"]?i=f[O(t)]-g(t,e,n):i+=f.xTicks||f.yTicks?30:c.mLength:i=g(t,e,n))),i},b=function(t,e,n,a){var r=f[t+"Data"],i=f.dataKey[r],o=f[F(t)+"Align"],l=0;switch(a=a||!1,f.type){case"pie":break;case"scatter":case"line":default:0==r?(l=c["the_"+t](p(e,i,r)),"line"!=f.type&&"scatter"!=f.type||(l+=g(t,e,n)/2)):"right"==o||"bottom"==o?l=a?f[O(t)]:f[O(t)]-(f[O(t)]-c["the_"+t](p(e,i,r))):"line"!=f.type&&"scatter"!=f.type||(l=c["the_"+t](p(e,i,r)))}return l},v=function(t,n){var e;return n=n||!1,L.line().x(function(t,e){return b("x",t,e,n)}).y(function(t,e){return b("y",t,e,n)})(t)},r=function(t,e){var n=e.append("g").attr("class",K+"axis-"+t+" "+K+"axis-align-"+f[t+"Align"]),a="";switch(t+" "+f[t+"Align"]){case"x bottom":a="0,"+f.height;break;case"y right":a=f.width+",0";break;default:a="0,0"}return n.attr("transform","translate("+a+")"),n},k=function(t){var e,n="Axis "+f[t+"Align"];return e=L[n.toCamelCase()](c["the_"+t]),f.hasOwnProperty(t+"Ticks")&&(f.hasOwnProperty(t+"TicksFormat")&&e.tickFormat(c["format_"+t]),f.hasOwnProperty(t+"TicksAmount")&&e.ticks(f[t+"TicksAmount"])),e},_=function(t){var e,n=f[t+"Data"];switch(t){case"colors":e=L.scaleOrdinal().range(c["range_"+t]);break;case"x":case"y":switch(n){case 0:e=L.scaleBand().range(c["range_"+t]),"bar"==f.type&&e.paddingInner(.1).paddingOuter(.1);break;default:e=L.scaleLinear().range(c["range_"+t])}}return e},T=function(t,e){f[t+"Ticks"]&&(f[t+"Label"]&&(c["lab_"+t]=c.labels.append("text").attr("class",K+"label-"+t).attr("y",function(){return n("y",t)}).attr("x",function(){return n("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(f[t+"Label"]),"y"==t&&c["lab_"+t].attr("transform","rotate(-90)")),c["rule_"+t]=r(t,e),c["axis_"+t]=k(t))},w=function(t,n){var a=null;switch(n.duration=L.transition().duration(f.transition),f.type){case"bar":n.graphItem="rect";break;case"line":case"scatter":n.graphItem="circle"}a=f.srcKey?p(t,f.srcKey):t,n.off_x=y("x"),n.off_y=y("y"),n.outerWidth=f.width+2*n.off_x,n.outerHeight=f.height+2*n.off_y,n.canvas=L.select(l).append("div").attr("class",K+"wrapper"),n.dimensionString="0 0 "+n.outerWidth+" "+n.outerHeight,n.svg=n.canvas.append("svg").attr("id",l+"-svg").attr("class",K+"svg").attr("viewBox",n.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+n.dimensionString).attr("width",n.outerWidth).attr("height",n.outerHeight),n.container=n.svg.append("g"),n.containerTransform=null;var e=1.25,r=.75,i=n.off_x,o=n.off_y;switch(f.yAlign+" "+(""==f.xLabel?"empty":"has")){case"left has":n.transformX=n.off_x*e;break;case"right has":n.transformX=n.off_x*r;break;default:n.transformX=n.off_x}switch(f.xAlign+" "+(""==f.yLabel?"empty":"has")){case"top has":n.transformX=n.off_y*e;break;case"bottom has":n.transformX=n.off_y*r;break;default:n.transformX=n.off_y}n.container.attr("transform","translate("+i+","+o+")"),"pie"==f.type||(n.labels=n.container.append("g").attr("class",K+"labels"),n.rule=n.container.append("g").attr("class",K+"axis"),C.forEach(function(t){n["range_"+t]=h(t),n["the_"+t]=_(t),"x"!=t&&"y"!=t||(T(t,n.rule),n["format_"+t]=f[t+"Parameter"]||function(t){var e=1==f[axisString+"Data"]?t/f[axisString+"Divider"]:t,n;return f[axisString+"Prepend"]+e+f[axisString+"Append"]})}),n.dom_x=d("x",a),n.the_x.domain(n.dom_x),f.xTicks&&n.rule_x.transition(f.delay).call(n.axis_x).attr("font-family","inherit").attr("font-size",null),n.dom_y=d("y",a),n.the_y.domain(n.dom_y),f.yTicks&&n.rule_y.transition(f.delay).call(n.axis_y).attr("font-family","inherit").attr("font-size",null),n.graph=n.container.insert("g",":first-child").attr("class",K+"graph "+K+(0<f.colors.length||f.linePointsColor||f.lineColor?"has-palette":"no-palette")),9<a.length&&f.width==u.width&&f.height==u.height&&console.log(l+" Width and height was not adjusted. graph elements may not fit in the canvas"),("line"!=f.type||f.linePoints)&&(n.blob=n.graph.selectAll(n.graphItem).data(a,function(t){return t[f.dataKey[f.xData]]})),"line"==f.type&&(n.line=n.graph.append("path").attr("class",K+"line").attr("fill","none").attr("d",function(){return v(a,!0)}),f.lineColor&&n.line.attr("stroke",f.lineColor)),0<f.colors.length&&(n.dom_color=d("colors",a))),n.dv_init=!1,document.addEventListener("scroll",function(t){var e;s.getBoundingClientRect().y<.5*S.innerHeight&&!n.dv_init&&(n.dv_init=!0,setTimeout(function(){A(n,a)},f.delay))},!0)},A=function(r,t){"pie"==f.type||(("line"!=f.type||f.linePoints)&&(r.blob.exit().transition(r.duration).attr("height",0).remove(),r.blobWrap=r.blob.enter().append("g").attr("class",K+"item"),r.blobItem=r.blobWrap.append(r.graphItem).attr("line"==f.type||"scatter"==f.type?"cx":"x",function(t,e){return b("x",t,e,!0)}).attr("line"==f.type||"scatter"==f.type?"cy":"y",function(t,e){return b("y",t,e,!0)}),"line"==f.type||"scatter"==f.type?r.blobItem.attr("r",function(t,e){return a(t,e,!0)}):r.blobItem.attr("width",function(t,e){return g("x",t,e,!0)}).attr("height",function(t,e){return g("y",t,e,!0)}),f.colors.length?r.blobItem.attr("fill",function(t,e){return r.the_colors(t[f.colorsData])}):"line"==f.type&&(f.linePointsColor||f.lineColor)&&r.blobItem.attr("fill",function(){return f.linePointsColor||f.lineColor}),r.blobItem.transition(r.duration).attr("line"==f.type||"scatter"==f.type?"cx":"x",function(t,e){return b("x",t,e)}).attr("line"==f.type||"scatter"==f.type?"cy":"y",function(t,e){return b("y",t,e)}),"line"==f.type||"scatter"==f.type?r.blobItem.transition(r.duration).attr("r",function(t,e){return a(t,e)}):r.blobItem.transition(r.duration).attr("width",function(t,e){return g("x",t,e)}).attr("height",function(t,e){return g("y",t,e)})),"line"==f.type&&"line"==f.type&&r.line.transition(r.duration).attr("d",function(){return v(t)})),f.xTicks&&f.yTicks||(r.blobText=r.blobWrap.append("g").attr("class",K+"item-text"+(f.xTicks||f.yTicks?"":" "+K+"item-data-no-ticks")).attr("transform",function(t,e){return"translate("+m("x",t,e,!0)+","+m("y",t,e,!0)+")"}).style("opacity",0),r.blobText.transition(r.duration).attr("transform",function(t,e){return"translate("+m("x",t,e)+","+m("y",t,e)+")"}).style("opacity",1),["x","y"].forEach(function(a){f[a+"Ticks"]||(r["blobText"+a]=r.blobText.append("text").attr("class",function(t,e){var n=K+"item-data-"+f[a+"Data"];return(parseFloat(g("y",t,e,!1))<r.mLength||0<f.colors.length&&parseFloat(g("y",t,e,!1))>r.mLength&&!I(r.the_colors(t[f.colorsData]))||"line"==f.type)&&(n+=" item-text-dark color-palette-"+f.colors.length),n}).attr("dominant-baseline",function(t,e){return i(t,e)}).attr("text-anchor",function(t,e){return o(t,e)}).attr("font-size",null).text(function(t,e){return p(t,f.dataKey[f[a+"Data"]],f[a+"Data"])}).attr("x",function(t,e){return x("x",a,t,e,!0)}).attr("y",function(t,e){return x("y",a,t,e,!0)}),r["blobText"+a].transition(r.duration).attr("x",function(t,e){return x("x",a,t,e)}).attr("y",function(t,e){return x("y",a,t,e)}))}))};switch(f.srcPath.getFileExtension()){case"csv":L.csv(f.srcPath).then(function(t){w(t,c)});break;case"tsv":L.tsv(f.srcPath).then(function(t){w(t,c)});break;case"json":L.json(f.srcPath).then(function(t){w(t,c)});break;default:if(f.srcPath.getHash()){var D=s.querySelector('script[type="application/json"').innerHTML;if(D.isValidJSONString()){var P=JSON.parse(D);w(P,c)}else"text"==f.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}};t.dataVisualizer=n,S._1p21=t}(window,d3);