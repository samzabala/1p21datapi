"use strict";!function(t,e){var n=n||{},r=["x","y"],a=["x","y","color","area","r"],i="data-visualizer-",l=function(t,e){return e?"x"==t?"height":"width":"x"==t?"width":"height"},o=function(t){return"x"==t?"y":"x"};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t,e=0;if(0===this.length)return e;for(t=0;t<this.length;t++)e=(e<<5)-e+this.charCodeAt(t),e|=0;return e},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.toCamelCase=function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")};n.dataVisualizer=function(n,s){var c=document.querySelector(n),u={},f={width:600,height:400,margin:20,marginOffset:2,transition:2e3,delay:300,type:"bar",dataKey:[0,1],nameIsNum:!1,srcType:"",srcPath:"",srcKey:null,colorPalette:[],colorData:null,xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xTicksParameter:null,xMin:null,xMax:null,xGrid:!1,xGridIncrement:1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yTicksParameter:null,yMin:null,yMax:null,yGrid:!1,yGridIncrement:1,yPrepend:"",yAppend:"",yDivider:1,lineStyle:"",lineWeight:1,lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillOpacity:.5,lineFillInvert:"x",lineDash:[100,0],areaKey:""},h=f;for(var p in s)s.hasOwnProperty(p)&&(h[p]=s[p]);u.mLength=h.xTicks||h.yTicks?70:120;var d=function(t){var e=0;return"pie"!==h.type&&(e=h.margin*(.75*h.marginOffset),h[t+"Label"]&&(e=h.margin*h.marginOffset),"x"==t&&0==h[o(t)+"Data"]&&(e=h.margin*(1.75*h.marginOffset),h[o(t)+"Label"]&&(e+=.5*h.marginOffset))),e},g=function(t,e,n){var r=e.toString().split(".");return r.forEach(function(t,e){""==t&&r.splice(e,1)}),function t(e,r){return r.length?t(e[r[0]],r.slice(1)):n?parseFloat(e):e}(t,r)},y=function(t,n){var r=h[t+"Data"],a=[];if(null!==r){switch(t){case"color":var i=h.colorData||h.dataKey[0];a=n.reduce(function(t,e){return t.includes(g(e,i))||t.push(g(e,i)),t},[]);break;case"x":case"y":a=h.nameIsNum||1==r?[null!==h[t+"Min"]?h[t+"Min"]:e.min(n,function(t){return g(t,h.dataKey[r],!0)}),null!==h[t+"Max"]?h[t+"Max"]:e.max(n,function(t){return g(t,h.dataKey[r],!0)})]:n.map(function(t){return g(t,h.dataKey[r],!1)})}return a}},m=function(t,e){var n=0;return"x"==t?"x"==e?n=h[l(e)]/2:"y"==e&&(n=-h[l(e)]/2):"x"==e?n="bottom"==h[e+"Align"]?h[l(e,!0)]+(u.off_y-.125*h.margin):-(u.off_y-1.5*h.margin):"y"==e&&(n="right"==h[e+"Align"]?h[l(e,!0)]+u.off_x:-.125*u.off_x),n},x=function(t,e,n,r){var a=h[t+"Data"],i=h.dataKey[a],s=h[o(t)+"Align"],c=20;switch(r=r||!1,h.type){case"pie":break;default:c=h.nameIsNum||1==a?r?0:"right"==s||"bottom"==s?h[l(t)]-u["the_"+t](g(e,i,i)):u["the_"+t](g(e,i,i)):u["the_"+t].bandwidth()}return c},b=function(t,e,n){var r=2;return n?r=0:"line"==h.type&&h.linePointsSize&&(r=h.linePointsSize),r},v=function(t,e){var n="0em";return"pie"==h.type||"y"==t&&(h.xTicks||h.yTicks||(n=1==h[e+"Data"]?".5em":"-1.5em")),n},k=function(t,e,n,r){var a,i,s=h[t+"Data"],c=0,f=(h.xTicks||h.yTicks,function(){var e=0,n=1;return"top"!=h[o(t)+"Align"]&&"right"!=h[o(t)+"Align"]||(n*=-1),"x"==t?0==h[o(t)+"Data"]&&(e=15):0==h[o(t)+"Data"]&&(e=h.xTicks||h.yTicks?18.75:37.5),e*=n});switch(r=r||!1,h.type){case"pie":break;default:if(0==s)c=_(t,e,n),"bar"==h.type&&(c+=x(t,e)/2);else switch(h[o(t)+"Align"]){case"top":r?_(t,e,n):c=x(t,e);break;case"right":case"bottom":c=r||"right"==h[o(t)+"Align"]&&"bar"==h.type?h[l(t)]:h[l(t)]-x(t,e);break;case"left":"bar"!==h.type&&(c=x(t,e))}!r&&(c+=f()+(a=1,i=0,"bottom"!=h[o(t)+"Align"]&&"right"!=h[o(t)+"Align"]||(a=-1),h.type,parseFloat(x(t,e))<u.mLength&&0!==s&&("x"==t?(!r&&console.log(e.name,t,"uuugh",a),i=x(t,e)):i=2*f()),i*=a))}return c},_=function(t,e,n,r){var a=h[t+"Data"],i=h.dataKey[a],s=h[o(t)+"Align"],c=0;switch(r=r||!1,h.type){case"pie":break;default:h.nameIsNum||1==a?"right"==s||"bottom"==s?c=r&&0!==a?h[l(t)]:h[l(t)]-(h[l(t)]-u["the_"+t](g(e,i,!0))):"line"!=h.type&&"scatter"!=h.type||r&&0!==a||(c=u["the_"+t](g(e,i,!0))):c=u["the_"+t](g(e,i,!1))}return c},A=function(t,n,r){r=r||!1;var a=n?"area":"line",i=0==h.xData?"x":"y",l=e[a]();if("area"==a){var s={name:i,value:o(i)+1,fill:o(i)+0};(!h.lineFillInvert&&("right"==h[o(i)+"Align"]||"bottom"==h[o(i)+"Align"])||h.lineFillInvert&&"right"!=h[o(i)+"Align"]&&"bottom"!=h[o(i)+"Align"])&&(s.value=o(i)+0,s.fill=o(i)+1),l[s.name](function(t,e){return _(i,t,e,r)})[s.value](function(t,e){return _(o(i),t,e,r)})[s.fill](function(t,e){return _(o(i),t,e,!0)})}else l.x(function(t,e){return _("x",t,e,r)}).y(function(t,e){return _("y",t,e,r)});return l(t)},T=function(t){var n,r=h[t+"Data"];switch(t){case"color":n=e.scaleOrdinal().range(u["range_"+t]);break;case"x":case"y":n=h.nameIsNum||1==r?e.scaleLinear().range(u["range_"+t]):e.scaleBand().range(u["range_"+t]).paddingInner(.1).paddingOuter(.1)}return n},w=function(t,n,r){if(h[t+"Ticks"]){var a=r?"grid_":"";h[t+"Label"]&&(u["lab_"+t]=u.labels.append("text").attr("class",i+"label-"+t).attr("y",function(){return m("y",t)}).attr("x",function(){return m("x",t)}).attr("font-size","1em").attr("text-anchor","middle").text(h[t+"Label"]),"y"==t&&u["lab_"+t].attr("transform","rotate(-90)")),u["rule_"+a+t]=function(t,e,n){var r=e.append("g").attr("class",function(){return n?i+"grid-"+t+" ":i+"axis-"+t+" "+i+"axis-align-"+h[t+"Align"]}),a="";switch(t+" "+h[t+"Align"]){case"x bottom":a="0,"+h.height;break;case"y right":a=h.width+",0";break;default:a="0,0"}return r.attr("transform","translate("+a+")"),r}(t,n,r),u["axis_"+a+t]=function(t,n){var r,a="Axis "+h[t+"Align"];return n=n||!1,r=e[a.toCamelCase()](u["the_"+t]),h.hasOwnProperty(t+"Ticks")&&(h[t+"TicksAmount"]&&r.ticks(n&&h[t+"TicksAmount"]?h[t+"TicksAmount"]/h[t+"GridIncrement"]:h[t+"TicksAmount"],u["format_"+t]),n&&r.tickSize(-h[l(o(t))]).tickFormat("")),r}(t,r)}},P=function(r,s){var u=null;switch(s.duration=e.transition().duration(h.transition),h.type){case"bar":s.graphItem="rect";break;case"line":case"scatter":s.graphItem="circle"}if(u=h.srcKey?g(r,h.srcKey):r,h.nameIsNum){for(var p=[],m=0;m<u.length;m++)u[m]&&p.push(u[m]);p.sort(function(t,e){return g(t,h.dataKey[0],!0)-g(e,h.dataKey[0],!0)}),u=p}s.off_x=d("x"),s.off_y=d("y"),s.outerWidth=h.width+2*s.off_x,s.outerHeight=h.height+2*s.off_y,s.canvas=e.select(n).append("div").attr("class",i+"wrapper"),s.dimensionString="0 0 "+s.outerWidth+" "+s.outerHeight,s.svg=s.canvas.append("svg").attr("id",n+"-svg").attr("class",i+"svg").attr("viewBox",s.dimensionString).attr("preserveAspectRatio","xMinYMin meet").style("style","enable-background","new "+s.dimensionString).attr("width",s.outerWidth).attr("height",s.outerHeight),s.container=s.svg.append("g"),s.containerTransform=null;var x=1.25,b=.75,v=s.off_x,k=s.off_y;switch(h.yAlign+" "+(""==h.xLabel?"empty":"has")){case"left has":s.transformX=s.off_x*x;break;case"right has":s.transformX=s.off_x*b;break;default:s.transformX=s.off_x}switch(h.xAlign+" "+(""==h.yLabel?"empty":"has")){case"top has":s.transformX=s.off_y*x;break;case"bottom has":s.transformX=s.off_y*b;break;default:s.transformX=s.off_y}s.container.attr("transform","translate("+v+","+k+")"),"pie"==h.type||(s.labels=s.container.append("g").attr("class",i+"labels"),s.rule=s.container.append("g").attr("class",i+"axis"),s.grid=s.container.append("g").attr("class",i+"grid"),a.forEach(function(t){s["range_"+t]=function(t){var e=[];switch(t){case"color":e=h[t+"Palette"];break;case"x":case"y":e="top"==h[o(t)+"Align"]||"left"==h[o(t)+"Align"]?[0,h[l(t)]]:[h[l(t)],0]}return e}(t),s["the_"+t]=T(t),"x"!=t&&"y"!=t||(w(t,s.rule),s["format_"+t]=h[t+"Parameter"]||function(t){var e=1==h[axisString+"Data"]?t/h[axisString+"Divider"]:t;return h[axisString+"Prepend"]+e+h[axisString+"Append"]},s["dom_"+t]=y(t,u),s["the_"+t].domain(s["dom_"+t]),h[t+"Ticks"]&&(s["rule_"+t].transition(h.delay).call(s["axis_"+t]).attr("font-family","inherit").attr("font-size",null),h[t+"Grid"]&&(w(t,s.grid,!0),s["rule_grid_"+t].call(s["axis_grid_"+t]))))}),s.graph=s.container.insert("g",":first-child").attr("class",i+"graph "+i+(h.colorPalette.length>0||null!==h.linePointsColor||null!==h.lineColor?"has-palette":"no-palette")+(h.xTicks||h.yTicks?"":" "+i+"item-data-no-ticks")),u.length>9&&h.width==f.width&&h.height==f.height&&console.log(n+" Width and height was not adjusted. graph elements may not fit in the canvas"),("line"!=h.type||h.linePoints)&&(s.blob=s.graph.selectAll(s.graphItem).data(u,function(t){return t[h.dataKey[h.xData]]})),h.colorPalette.length>0&&(s.dom_color=y("color",u))),s.dv_init=!1,document.addEventListener("scroll",function(e){c.getBoundingClientRect().y<.5*t.innerHeight&&!s.dv_init&&(s.dv_init=!0,setTimeout(function(){D(s,u)},h.delay))},!0)},D=function(t,e){console.log(n,"-------------------------------------------------------------------"),console.log("calculated",t),"pie"==h.type||(("line"!=h.type||h.linePoints)&&(t.blob.exit().transition(t.duration).attr("height",0).remove(),t.blobWrap=t.blob.enter().append("g").attr("class",function(t){return i+"item "+i+g(t,h.dataKey[0])}),t.blobItem=t.blobWrap.append(t.graphItem).attr("line"==h.type||"scatter"==h.type?"cx":"x",function(t,e){return _("x",t,e,!0)}).attr("line"==h.type||"scatter"==h.type?"cy":"y",function(t,e){return _("y",t,e,!0)}),"line"==h.type||"scatter"==h.type?t.blobItem.attr("r",function(t,e){return b(0,0,!0)}):t.blobItem.attr("width",function(t,e){return x("x",t,0,!0)}).attr("height",function(t,e){return x("y",t,0,!0)}),h.colorPalette.length?t.blobItem.attr("fill",function(e,n){return t.the_color(e[h.colorData])}):"line"==h.type&&(h.linePointsColor||h.lineColor)&&t.blobItem.attr("fill",function(){return h.linePointsColor||h.lineColor}),t.blobItem.transition(t.duration).attr("line"==h.type||"scatter"==h.type?"cx":"x",function(t,e){return _("x",t,e)}).attr("line"==h.type||"scatter"==h.type?"cy":"y",function(t,e){return _("y",t,e)}),"line"==h.type||"scatter"==h.type?t.blobItem.transition(t.duration).attr("r",function(t,e){return b()}):t.blobItem.transition(t.duration).attr("width",function(t,e){return x("x",t)}).attr("height",function(t,e){return x("y",t)})),"line"==h.type&&(h.lineFill&&(t.fill=t.graph.append("path").attr("class",i+"fill").attr("fill-opacity",0).attr("d",function(){return A(e,!0,!0)}),(h.lineFillColor||h.lineColor)&&t.fill.attr("fill",h.lineFillColor||h.lineColor),t.fill.transition(t.duration).attr("fill-opacity",h.lineFillOpacity).attr("d",function(){return A(e,!0)})),t.line=t.graph.append("path").attr("class",i+"line").attr("fill","none").attr("stroke-width",h.lineWeight).attr("stroke-linejoin","round").attr("stroke-opacity",0).attr("d",function(){return A(e,!1,!0)}).attr("stroke-dasharray","0,0"),h.lineColor&&t.line.attr("stroke",h.lineColor),t.line.transition(t.duration).attr("d",function(){return A(e,!1)}).attr("stroke-dasharray",h.lineDash).attr("stroke-opacity",1))),h.xTicks&&h.yTicks||(t.blobText=t.blobWrap.append("text").attr("class",function(e,n){var a=i+"item-text";return r.forEach(function(n){var r,i,l,o;(parseFloat(x(n,e,0,!1))<t.mLength&&1==h[n+"Data"]||h.colorPalette.length>0&&parseFloat(x("x",e,0,!1))>t.mLength&&parseFloat(x("y",e,0,!1))>t.mLength&&((r=t.the_color(e[h.colorData])).match(/^rgb/)?(i=(r=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],l=r[2],o=r[3]):(i=(r=+("0x"+r.slice(1).replace(r.length<5&&/./g,"$&$&")))>>16,l=r>>8&255,o=255&r),Math.sqrt(i*i*.299+l*l*.587+o*o*.114)>170)||"line"==h.type)&&(a+=" dark")}),console.log("shiet",a),a}).attr("transform",function(t,e){return"translate("+k("x",t,e,!0)+","+k("y",t,e,!0)+")"}).style("opacity",1),t.blobText.transition(t.duration).attr("transform",function(t,e){return"translate("+k("x",t,e)+","+k("y",t,e)+")"}).style("opacity",1),r.forEach(function(e){h[e+"Ticks"]||(t["blobText"+e]=t.blobText.append("tspan").attr("class",i+"item-data-"+h[e+"Data"]).attr("dominant-baseline","middle").attr("text-anchor",function(t,e){return n="middle","pie"==h.type||(0==h.yData&&(n="start"),r.forEach(function(t){0==h[o(t)+"Data"]&&"right"==h[o(t)+"Align"]&&(n="end")})),n;var n}).attr("font-size",null).text(function(t,n){return g(t,h.dataKey[h[e+"Data"]])}).attr("x",v("x",e)).attr("y",v("y",e)))}))};switch(h.srcPath.getFileExtension()){case"csv":e.csv(h.srcPath).then(function(t){P(t,u)});break;case"tsv":e.tsv(h.srcPath).then(function(t){P(t,u)});break;case"json":e.json(h.srcPath).then(function(t){P(t,u)});break;default:if(h.srcPath.getHash()){var I=c.querySelector('script[type="application/json"]').innerHTML;if(I.isValidJSONString()){var S=JSON.parse(I);P(S,u)}else"text"==h.srcType?console.error("Data input may not be valid. Please check and update the syntax"):console.error("The data source is not a supported format. Please make sure data is linked either as a json,csv, tsv or direct input in the fields")}}},t._1p21=n}(window,d3);