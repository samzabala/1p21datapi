/*!
* 1point21 Data Vizualiser Version 1.2.0.2
* Render Script
* @license yes
* DO NOT EDIT min.js
* edit its corresponding unminified js file in /src instead
*/
"use strict";!function(t,e){var r=t._1p21||{};r.graphs={},r.dataVisualizer=function(n,a){var i=["x","y"],o=[0,1,"color","area"],l="data-visualizer-",s=function(t,e){return e?"x"==t?"height":"width":"x"==t?"width":"height"},c=function(t){return"x"==t?"y":"x"},p=function(){var t=navigator.userAgent;return t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var t,e=this.split("#"),r;return e[e.length-1]||""},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.toCamelCase=function(){var t;return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")};var u=function(t){var e,r,n,a;return t.match(/^rgb/)?(e=(t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],r=t[2],n=t[3]):(e=(t=+("0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&")))>>16,r=t>>8&255,n=255&t),!((a=Math.sqrt(e*e*.299+r*r*.587+n*n*.114))>170)},d=document.querySelector(n);if(p()){var g=document.createElement("div");throw g.className=l+"wrapper fatality",g.innerHTML='Sorry, this graphic needs D3 to render the data but your browser does not support it.<br><br> Newer versions of Chrome, Edge, Firefox and Safari are recommended. <br><br>See <em><a target="_blank" rel="nofollow" href="https://d3-wiki.readthedocs.io/zh_CN/master/Home/#browser-platform-support">the official wiki</a></em> for more information',d.appendChild(g),new Error("D3 not supported by browser")}var h={};h.dv_container=d;var f={width:600,height:600,margin:40,transition:1500,delay:250,fontSize:"16px",title:"",description:"",srcType:"",srcPath:"",srcKey:null,srcMultiple:!1,srcMultipleKey:"",textNameSize:.75,textValueSize:1.25,textTicksSize:.75,textLegendSize:.75,type:"bar",nameIsNum:!1,key:{0:0,1:1,color:null,area:null},reverse:{0:!1,1:!1,color:!1,multiple:!1,area:!1},format0Prepend:"",format0Append:"",format0Parameter:null,format0Divider:1,format1Prepend:"",format1Append:"",format1Parameter:null,format1Divider:1,formatcolorPrepend:"",formatcolorAppend:"",formatcolorParameter:null,areaMin:10,areaMax:50,areaOpacity:.8,colorBackground:"#eee",colorPalette:[],colorData:null,colorLegend:!1,xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xParameter:null,xMin:null,xMax:null,xGrid:!1,xGridIncrement:1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yParameter:null,yMin:null,yMax:null,yGrid:!1,yGridIncrement:1,yPrepend:"",yAppend:"",yDivider:1,barTextWithin:!1,barGutter:.1,lineStyle:"",lineWeight:1,lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillInvert:!1,lineFillOpacity:.5,lineDash:[100,0],piLabelStyle:null,piInRadius:0,tooltipEnable:!1,tooltipTextAlign:"left",tooltipWidth:"auto",tooltipDirection:"n",tooltipDirectionParameter:null,tooltipContent:null,colorBy:"key",colorScheme:null},y=f;for(var m in a)a.hasOwnProperty.call(a,m)&&(y[m]=a[m]);h.user_can_debug=document.body.classList.contains("logged-in"),h.has_text=!(y.toolTip||("pie"===y.type||"scatter"===y.type||y.xTicks&&y.yTicks)&&("pie"!=y.type||!y.piLabelStyle&&y.colorLegend)),h.has_both_text_on_blob=!(!h.has_text||("pie"===y.type||y.xTicks||y.yTicks)&&("pie"!=y.type||y.colorLegend||null===y.piLabelStyle)),h.text_padding=2.25;var _=function(t){return 0==t||1==t?y.xData==t?"x":"y":t},b=function(t){return t>10?10*Math.pow(10,t.toString().length-1):1},x=function(t,e,r){var a=e.toString().split(".");function i(t,e){var n=null;return n=e.length?i(t[e[0]],e.slice(1)):1==r?parseFloat(t):t}r=r||!1,a.forEach(function(t,e){""==t&&a.splice(e,1)});var o=i(t,a);return 1==r&&isNaN(o)&&console.warn(n+" data with the key source of `"+e+"` was passed as numeric but is not."),o},v=function(t){var e=[];switch(t){case"color":e=y[t+"Palette"];break;case"area":e=[y.areaMin,y.areaMax];break;case 0:case 1:e="top"==y[c(_(t))+"Align"]||"left"==y[c(_(t))+"Align"]?[0,y[s(_(t))]]:[y[s(_(t))],0]}return e},k=function(t,r){var n=[],a=y.key[t];if(a)switch(t){case"color":var i;n=r.reduce(function(t,e){return t.includes(x(e,a))||t.push(x(e,a)),t},[]);break;case"area":case 0:case 1:var o,l,s,c;if(1==y.nameIsNum||1==t||"area"==t){if(n=[o=null!==y[_(t)+"Min"]&&"area"!==t?y[_(t)+"Min"]:e.min(r,function(t){return x(t,a,!0)}),l=null!==y[_(t)+"Max"]&&"area"!==t?y[_(t)+"Max"]:e.max(r,function(t){return x(t,a,!0)})],"scatter"==y.type&&0==t)n=[b(o),b(l)]}else n=r.map(function(t){return x(t,a,!1)});if(y.reverse[t]){for(var p=[],u=n.length-1;u>=0;u--)p.push(n[u]);n=p}}return n},w=function(t,e){var r=0;return"x"==t?"x"==e?r=y[s(e)]/2:"y"==e&&(r=-y[s(e)]/2):"x"==e?r="bottom"==y[e+"Align"]?y[s(e,!0)]+.875*h.margin.bottom:-.875*h.margin.top:"y"==e&&(r="right"==y[e+"Align"]?y[s(e,!0)]+(.875*h.margin.right+h.text_base_size):-(.875*h.margin.left-h.text_base_size)),r},S=function(t,e,r,n){var a=y[t+"Data"],i=y[c(t)+"Align"],o=20;switch(n=n||!1,y.type){case"pie":break;default:(o=1==y.nameIsNum||1==a?n?0:"right"==i||"bottom"==i?y[s(t)]-h["the_"+a](x(e,y.key[a],!0)):h["the_"+a](x(e,y.key[a],!0)):h["the_"+a].bandwidth())<0&&(o=0)}return o},T=function(t,e,r){var n=(r=r||!1)?0:2;return r||("line"==y.type?"line"==y.type&&y.linePointsSize&&(n=y.linePointsSize):"scatter"==y.type&&y.key.area&&(n=h.the_area(x(t,y.key.area,!0)))),n},z=function(t,e){var r="middle";return"pie"==y.type||(0==y.yData&&(r="start"),i.forEach(function(t){0==y[c(t)+"Data"]&&"right"==y[c(t)+"Align"]&&(r="end")})),r},A=function(t,e){var r="0em";if(h.has_both_text_on_blob&&"y"==t&&h.has_both_text_on_blob){var n=h.text_base_size*(y.textNameSize+y.textValueSize+h.text_padding);r=1==e?(-.5*n+h.text_base_size*y.textValueSize*.5+h.text_base_size)/(h.text_base_size*y.textValueSize)+"em":(.5*n-h.text_base_size*y.textNameSize*.5-h.text_base_size)/(h.text_base_size*y.textNameSize)+"em"}return r},L=function(t,e,r,n){n=n||!1;var a=y[t+"Data"],i=0,o;if("pie"==y.type){var l="linked"!=y.piLabelStyle&&n,p=(o=0,"linked"==y.piLabelStyle?o=n?1:2.5:0==n&&(o=1),o),u="linked"!=y.piLabelStyle,d=F(M(r),u,"centroid",p,l);i="x"==t?d[0]:d[1]}else{var g=function(){var e=0,r=1;return n||"scatter"==y.type||("bottom"!=y[c(t)+"Align"]&&"right"!=y[c(t)+"Align"]||(r=-1),0!==a&&"x"==t&&(e=.5*h.text_padding*h.text_base_size),e*=r),e},f=function(){var i=1,o=0;return n||"scatter"==y.type||(("bar"===y.type&&y.barTextWithin||"bottom"!=y[c(t)+"Align"]&&"right"!=y[c(t)+"Align"])&&("bar"!=y.type||!y.barTextWithin||"top"!=y[c(t)+"Align"]&&"left"!=y[c(t)+"Align"])||(i=-1),0!==a&&("x"==t?("bar"!==y.type||!y.barTextWithin)&&parseFloat(S(t,e,r))>=y[s(t,!0)]-h.m_length(t,r)?o=-h.m_length(t,r):"bar"==y.type&&y.barTextWithin&&parseFloat(S(t,e,r))<h.m_length(t,r)&&(o=-S(t,e,r)):o=("bar"!==y.type||!y.barTextWithin)&&parseFloat(S(t,e,r))>=y[s(t,!0)]-h.m_length(t,r)||"bar"==y.type&&y.barTextWithin&&parseFloat(S(t,e,r))<h.m_length(t,r)?-.5*h.m_length(t,r):.5*h.m_length(t,r)),o*=i),o};if(0==a)i=P(t,e,r),"bar"==y.type&&(i+=S(t,e,r)/2);else switch(y[c(t)+"Align"]){case"top":n||"scatter"===y.type||(i=S(t,e,r));break;case"right":case"bottom":i=n&&"scatter"!==y.type||y.barTextWithin&&"right"==y[c(t)+"Align"]?y[s(t)]:y[s(t)]-S(t,e,r);break;case"left":"bar"===y.type&&y.barTextWithin||n||(i=S(t,e,r))}i+=g()+f()}return i},P=function(t,e,r,n){var a=y[t+"Data"],i=y[c(t)+"Align"],o=0;return n=n||!1,"pie"!==y.type&&(1==y.nameIsNum||1==a?"right"==i||"bottom"==i?o=n&&0!==a&&"scatter"!==y.type?y[s(t)]:y[s(t)]-(y[s(t)]-h["the_"+y[t+"Data"]](x(e,y.key[a],!0))):"line"!=y.type&&"scatter"!=y.type||n&&0!==a&&"scatter"!==y.type||(o=h["the_"+y[t+"Data"]](x(e,y.key[a],!0))):(o=h["the_"+y[t+"Data"]](x(e,y.key[a],!1)),"line"!=y.type&&"scatter"!=y.type||y.nameIsNum||(o+=S(t,e,r)/2))),o},C=function(t){if(h.container_legend){var e=0,r="x"==t?h.container_legend.nodes()[0].getBoundingClientRect()[s(t)]:h.legend_height,n=function(){var e=0,n=1;return("pie"==y.type||"pie"!==y.type&&"left"==y[c(t)+"Align"]||"top"==y[c(t)+"Align"])&&(n=-1),"pie"==y.type&&"x"==t||"pie"!==y.type&&"left"==y[c(t)+"Align"]||"top"==y[c(t)+"Align"]?e=r+h.text_base_size:"pie"==y.type&&"y"==t&&(e=.5*r),e*n};return"pie"==y.type&&"x"==t||"pie"!==y.type&&"left"==y[c(t)+"Align"]||"top"==y[c(t)+"Align"]?e=y[s(t)]:"pie"==y.type&&"y"==t&&(e=.5*y[s(t)]),e+n()}},D=function(t,r){var n=t?"area":"line",a=0==y.xData?"x":"y",i=function(){var t="curveLinear";switch(y.lineStyle){case"step":t="curveStepBefore";break;case"curve":t="curveMonotone"+a.toUpperCase()}return t}(),o=e[n](),l;if("area"==n){var p={name:a,value:c(a)+1,fill:c(a)+0},u=(l=0,y.lineFillInvert&&(l="top"==y[a+"Align"]||"left"==y[a+"Align"]?1:-1),l);o[p.name](function(t,e){return P(a,t,e,r)})[p.value](function(t,e){return P(c(a),t,e,r)})[p.fill](function(t,e){return P(c(a),t,e,!0)+u*y[s(a)]})}else o.x(function(t,e){return P("x",t,e,r)}).y(function(t,e){return P("y",t,e,r)});return i&&o.curve(e[i]),o(h.data)},F=function(t,r,n,a,i){a=a||1,n=n||"",i=i||!1;var o=(c=0,(r=r||!1)&&(c=h.pi_radius*y.piInRadius),c),l=function(){var t=0;return(!i||i&&a<=1&&0==r)&&(t=h.pi_radius*a),t}(),s=e.arc().outerRadius(l).innerRadius(o),c;return n?s[n](t):s(t)},M=function(t){var r;return e.pie().sort(null).value(function(t,e){return x(t,y.key[1],!0)})(h.data)[t]},N=function(t){var e=0;return e=y.colorLegend&&"x"==t?.375*y[s(t)]:.5*y[s(t)]},E=function(t){return t.startAngle+(t.endAngle-t.startAngle)/2},I=function(t,r,n,a){n=n||function(t,e,r){return t};var i=e[a=a||"interpolate"](t,r);return function(e){var a=i(e);return n(a,t,r)}},W=function(t){var r;switch(t){case"color":r=e.scaleOrdinal().range(h["range_"+t]);break;case"area":case 0:case 1:r=1==y.nameIsNum||1==t||"area"==t?1==y.nameIsNum&&0==t&&"scatter"==y.type?e.scaleSymlog().constant(10).range(h["range_"+t]):e.scaleLinear().range(h["range_"+t]):"line"==y.type||"scatter"==y.type?e.scalePoint().range(h["range_"+t]):e.scaleBand().range(h["range_"+t]).paddingInner(y.barGutter).paddingOuter(y.barGutter)}return r},B=function(t,e,r){if(y[t+"Ticks"]){r=r||!1;var n=y[t+"Align"],a=(r?"grid_":"rule_")+t;y[t+"Label"]&&!r&&(h["lab_"+t]=h.container_lab.append("text").attr("class",l+"label-"+t).attr("y",function(){return w("y",t)}).attr("x",function(){return w("x",t)}).attr("font-size","1em").attr("text-anchor","middle").attr("fill","currentColor").attr("opacity",0).text(y[t+"Label"]),"y"==t&&h["lab_"+t].attr("transform","rotate(-90)"),h["lab_"+t].transition(h.duration).attr("opacity",1)),h[a]=e.append("g").attr("class",function(){var e=null;return e=r?l+"grid-"+t+" grid-increment-"+y[t+"GridIncrement"]:l+"axis-"+t+" "+l+"axis-align-"+n});var i="";switch(t+" "+n){case"x bottom":i="0,"+y.height;break;case"y right":i=y.width+",0";break;default:i="0,0"}h[a].attr("transform","translate("+i+")")}},O=function(t){var e=null;if(e=(e=y.srcKey?x(t,y.srcKey)?x(t,y.srcKey):void H(n+" provided source key is invalid"):t).filter(function(t,e){var r=!0;if(o.forEach(function(a){if(y.key[a]&&null==x(t,y.key[a])&&(r=!1,h.user_can_debug)){var i=0==a?"name":1==a?"value":a;console.warn(n+" datum index `"+e+"` was filtered.\ndatum does not have data for the key `"+y.key[a]+"`, which is set as the property for `"+i+"`")}}),r)return t}),1==y.nameIsNum){for(var r=[],a=0;a<e.length;a++)e[a]&&r.push(e[a]);r.sort(function(t,e){return x(t,y.key[0],!0)-x(e,y.key[0],!0)}),e=r}return e},G=function(t,r){r=r||!1;var n="Axis "+y[t+"Align"],a=e[n.toCamelCase()](h["the_"+y[t+"Data"]]);if(y[t+"Ticks"]){if("scatter"==y.type&&0==y[t+"Data"]&&1==y.nameIsNum){var i=function(){var t=[],e=k(0,h.data)[0];do{t.push(e),e*=10}while(e<=k(1,h.data)[1]);return t};a.tickValues(i())}if(y[t+"TicksAmount"]){var o=function(){return r&&y[t+"TicksAmount"]?y[t+"TicksAmount"]*y[t+"GridIncrement"]:y[t+"TicksAmount"]};a.ticks(o())}r?a.tickSize(-y[s(t,!0)]).tickFormat(""):a.tickFormat(function(e,r){return h["format_"+y[t+"Data"]](e)})}return a},V=function(t){return h.tooltip_cursor_stalker.attr("cx",t.offsetX*(h.outer_width/h.svg.node().clientWidth)+"px").attr("cy",t.offsetY*(h.outer_height/h.svg.node().clientHeight)+"px").node()},H=function(t,r){r=r||!0;var a="Sorry, unable to display data."+(h.user_can_debug?"<br> Please check the console for more details":"");if(e.select(n).classed(l+"initialized",!0),d.querySelector("."+l+"wrapper.fatality")||e.select(n).append("div").attr("class",l+"wrapper fatality").html(a),r)throw new Error(t);console.error(t)},R=function(t){console.log("\n",n,"("+y.title+")","-------------------------------------------------------------------","\n","calculated shit",h,"\n","data",t,"\n","args",y,"\n","\n"),o.forEach(function(e){h["dom_"+e]=k(e,t),h["the_"+e]&&h["dom_"+e]&&h["the_"+e].domain(h["dom_"+e])}),"pie"!==y.type&&i.forEach(function(t){y[t+"Ticks"]&&(h["rule_"+t+"_axis"]=G(t),h["rule_"+t].transition(y.duration).call(h["rule_"+t+"_axis"]).attr("font-family",null).attr("font-size",null),y[t+"Grid"]&&(h["grid_"+t+"_axis"]=G(t,!0),h["grid_"+t].transition(y.duration).call(h["grid_"+t+"_axis"]),h["grid_"+t].selectAll("g").classed("grid",!0).filter(function(e,r){var n=!1;return h["rule_"+t].selectAll("g").each(function(t){t==e&&(n=!0)}),n}).classed("tick-aligned",!0)))}),h.blob=h.container_graph.selectAll(h.graph_item_element+"."+l+"graph-item.graph-item-blob").data(t,function(t){return x(t,y.key[0])}),h.blob.exit().transition(h.duration).attr("fill","transparent").attr("stroke","transparent").remove(),h.has_text&&(h.blob_text=h.container_graph.selectAll("text."+l+"graph-item.graph-item-text").data(t,function(t){return x(t,y.key[0])}),h.blob_text.exit().transition(h.duration).attr("fill","transparent").attr("stroke","transparent").remove(),"pie"==y.type&&"linked"==y.piLabelStyle&&(h.blob_text_link=h.container_graph.selectAll("polyline."+l+"graph-item.graph-item-link").data(t,function(t){return x(t,y.key[0])}),h.blob_text_link.exit().transition(h.duration).attr("fill","transparent").attr("stroke","transparent").remove())),"pie"!==y.type&&"line"==y.type&&(h.line=h.container_graph.select("."+l+"line").remove(),h.line=h.container_graph.append("path").lower().attr("class",l+"line"+(null!==y.lineColor?" has-color":" no-color")).attr("fill","none").attr("stroke-width",y.lineWeight).attr("stroke-linejoin","round").attr("stroke-dasharray",y.lineDash).attr("stroke-opacity",1).attr("stroke-dasharray","0,0").transition(h.duration).attrTween("d",function(){return I(D(!1,!0),D(!1,!1))}),y.lineColor&&h.line.attr("stroke",y.lineColor),y.lineFill&&(h.fill=h.container_graph.select("."+l+"fill").remove(),h.fill=h.container_graph.append("path").lower().attr("class",l+"fill"+(null!==y.lineFillColor||null!==y.lineColor?" has-color":" no-color")).attr("fill-opacity",y.lineFillOpacity),h.fill.transition(h.duration).attrTween("d",function(){return I(D(!0,!0),D(!0,!1))}),(y.lineFillColor||y.lineColor)&&h.fill.attr("fill",y.lineFillColor||y.lineColor))),h.enter_blob=h.blob.enter().append(h.graph_item_element).attr("class",function(t){return l+"graph-item graph-item-blob data-name-"+x(t,y.key[0])}),h.merge_blob=h.blob.merge(h.enter_blob),"pie"!==y.type&&h.merge_blob.transition(h.duration).attrTween("line"==y.type||"scatter"==y.type?"cx":"x",function(t,e){return I(P("x",t,e,!0),P("x",t,e,!1))}).attrTween("line"==y.type||"scatter"==y.type?"cy":"y",function(t,e){return I(P("y",t,e,!0),P("y",t,e,!1))}),"pie"==y.type&&h.merge_blob.transition(h.duration).attrTween("d",function(t,e){var r=M(e);return I(r.endAngle,r.startAngle,function(t){return r.startAngle=t,F(r,!0)})}),"line"==y.type||"scatter"==y.type?(h.merge_blob.transition(h.duration).attrTween("r",function(t,e){return I(T(t,e,!0),T(t,e,!1))}),"line"!=y.type||y.linePoints||h.merge_blob.attr("fill-opacity",0).attr("stroke-opacity",0)):h.merge_blob.transition(h.duration).attrTween("width",function(t,e){return I(S("x",t,e,!0),S("x",t,e,!1))}).attrTween("height",function(t,e){return I(S("y",t,e,!0),S("y",t,e,!1))}),y.tooltipEnable&&h.merge_blob.on("mousemove",function(t){h.tooltip.show(t,V(e.event))}).on("mouseleave",h.tooltip.hide),y.colorPalette.length?(h.merge_blob.attr("fill",function(t,e){return h.the_color(x(t,y.key.color))}),"scatter"==y.type&&h.merge_blob.attr("fill-opacity",y.areaOpacity).attr("stroke-width",1).attr("stroke",function(t,e){return h.the_color(x(t,y.key.color))})):"line"==y.type&&(y.linePointsColor||y.lineColor)&&h.merge_blob.attr("fill",function(){return y.linePointsColor||y.lineColor}),h.has_text&&(h.blob_text_link&&(h.enter_blob_text_link=h.blob_text_link.enter().append("polyline").attr("class",function(t){return l+"graph-item graph-item-link data-name-"+x(t,y.key[0])}),h.merge_blob_text_link=h.blob_text_link.merge(h.enter_blob_text_link).transition(h.duration).attrTween("stroke-opacity",function(t,e){return I(0,.75)}).attrTween("points",function(t,e){var r=[F(M(e),!0,"centroid",1,!1),F(M(e),!0,"centroid",1,!1)],n=[F(M(e),!0,"centroid",1,!1),F(M(e),!1,"centroid",2.25,!1)];return I(r,n)})),h.enter_blob_text=h.blob_text.enter().append("text").attr("line-height",1.25).attr("dominant-baseline","middle"),[0,1].forEach(function(t){("pie"!==y.type&&!y[_(t)+"Ticks"]||"pie"==y.type&&(0==t&&!y.colorLegend||1==t&&null!==y.piLabelStyle))&&(h["blob_text_"+t]=h.enter_blob_text.append("tspan").attr("class",function(e){return"graph-item-text-data-"+t+" data-name-"+x(e,y.key[0])}).attr("dominant-baseline","middle").attr("text-anchor",function(t,e){return z(t,e)}).attr("font-size",function(){var e=null;return("pie"!==y.type&&!y[c(_(t))+"Ticks"]||"pie"==y.type&&!y.colorLegend&&null!==y.piLabelStyle)&&(e=0==t?y.textNameSize+"em":y.textValueSize+"em"),e}).attr("x",A("x",t)).attr("y",A("y",t)).attr("font-weight",function(){var e=700;return("pie"!==y.type&&!y[c(_(t))+"Ticks"]||"pie"==y.type&&!y.colorLegend&&null!==y.piLabelStyle)&&0!==t&&(e=300),e}).text(function(e,r){return h["format_"+t](x(e,y.key[t]))}))}),h.merge_blob_text=h.blob_text.merge(h.enter_blob_text),h.m_length=function(t,e){if(h.has_text&&h.merge_blob_text){var r=0;return r="width"==s(t)?h.merge_blob_text.nodes()[e].getBBox()[s(t)]+h.text_padding*h.text_base_size:h.text_base_size*(y.textNameSize+y.textValueSize+h.text_padding),parseFloat(r)}},h.merge_blob_text.attr("class",function(t,e){var r=l+"graph-item graph-item-text";return"bar"==y.type&&(y.barTextWithin&&(parseFloat(S(_(1),t,e,!1))<h.m_length(_(1),e)&&!u(y.colorBackground)||parseFloat(S(_(1),t,e,!1))>=h.m_length(_(1),e)&&y.colorPalette.length>0&&!u(h.the_color(x(t,y.key.color))))||!y.barTextWithin&&(parseFloat(S(_(1),t,e,!1))+h.m_length(_(1),e)<=y[s(_(1))]&&!u(y.colorBackground)||parseFloat(S(_(1),t,e,!1))+h.m_length(_(1),e)>y[s(_(1))]&&y.colorPalette.length>0&&!u(h.the_color(x(t,y.key.color)))))||("line"==y.type||"scatter"==y.type)&&!u(y.colorBackground)||"pie"==y.type&&("within"==y.piLabelStyle&&y.colorPalette.length>0&&!u(h.the_color(x(t,y.key.color)))||"linked"==y.piLabelStyle&&!u(y.colorBackground))?r+=" dark":r+=" light",r}).attr("stroke",function(t,e){return"pie"==y.type&&"within"==y.piLabelStyle&&y.colorPalette.length>0||"bar"==y.type&&(!y.barTextWithin&&parseFloat(S(_(1),t,e))>=y[s(_(1),!0)]-h.m_length(_(1),e)||y.barTextWithin&&parseFloat(S(_(1),t,e))>=h.m_length(_(1),e))?h.the_color(x(t,y.key.color)):"bar"!==y.type&&"pie"!==y.type||"pie"==y.type&&"linked"==y.piLabelStyle?y.colorBackground:void 0}).transition(h.duration).attrTween("transform",function(t,e){var r="pie"==y.type?M(e):t;return I("translate("+L("x",r,e,!0)+","+L("y",r,e,!0)+")","translate("+L("x",r,e,!1)+","+L("y",r,e,!1)+")")}).styleTween("opacity",function(){return I(0,1)})),y.colorLegend&&(h.legend_height=0,h.container_legend&&h.container_legend.remove(),h.container_legend=h.container.append("g").attr("class",l+"legend").attr("font-size",y.textLegendSize+"em"),h.dom_color.forEach(function(t,e){h.legend=h.container_legend.append("g").attr("class",l+"legend-item"),h.legend.append("rect").attr("class","legend-item-blob").attr("width",.75*h.legend_size).attr("height",.75*h.legend_size).attr("fill",h.the_color(t)).attr("stroke",y.colorBackground),h.legend.append("text").attr("class","legend-item-text").text(t).attr("dominant-baseline","middle").attr("x",h.legend_size).attr("y",.375*h.legend_size).attr("stroke",y.colorBackground),h.legend.attr("transform","translate(0, "+e*h.legend_size+")"),h.legend_height+=h.legend_size}),h.container_legend.attr("transform","translate("+C("x")+","+C("y")+")").transition(h.duration).styleTween("opacity",function(){return I(0,1)}))},J=function(i){switch(h.the_container=e.select(n),h.the_container.classed(l+"initialized"+(u(y.colorBackground)?" "+l+"dark":""),!0).style("background-color",y.colorBackground),h.data=null,y.type){case"bar":h.graph_item_element="rect";break;case"pie":h.graph_item_element="path";break;case"line":case"scatter":h.graph_item_element="circle"}if(h.text_base_size=parseFloat(y.fontSize),1==y.srcMultiple?h.data=e.stratify(i).parentId(function(t){return t[y.srcMultipleKey]}):h.data=O(i),console.log(n,h.data),h.data.length>0){a.key.color||(a.key.color=y.key[0],a.colorLegend||(y.colorLegend=!1)),h.legend_size=y.textLegendSize*parseFloat(y.fontSize)*2,h.margin={top:y.margin[0]||y.margin,right:y.margin[1]||y.margin[0]||y.margin,bottom:y.margin[2]||y.margin[0]||y.margin,left:y.margin[3]||y.margin[1]||y.margin[0]||y.margin},h.tooltip_html=y.tooltipContent||function(t,e){var r='<div class="'+l+'tooltip-data">';for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=!1;"object"!=typeof t[n]&&(r+='<div class="'+l+'tooltip-data-property">',"row"!==y.srcType&&(r+='<strong class="'+l+'tooltip-data-property-label">'+n+":</strong> "),o.forEach(function(e){y.key[e]&&y.key[e].lastIndexOf(n)>-1&&h["format_"+e]&&0==a&&(r+='<span class="'+l+'tooltip-data-property-content">'+h["format_"+e](x(t,y.key[e]))+"</span>",a=!0)}),0==a&&(r+='<span class="'+l+'tooltip-data-property-content">'+t[n]+"</span>"),r+="</div>")}return r+="</div>"},h.outer_width=y.width+h.margin.left+h.margin.right,h.outer_height=y.height+h.margin.top+h.margin.bottom,e.select(n).append("div").lower().attr("class",l+"heading"),h.heading_sel=e.select(n).select("div."+l+"heading"),y.title&&(h.heading_title=h.heading_sel.append("span").attr("class",l+"title").text(y.title)),y.description&&(h.heading_description=h.heading_sel.append("span").attr("class",l+"description").text(y.description)),h.heading_sel.style("padding-top",function(){return h.margin.top/y.height*50+"%"}).style("padding-left",function(){return h.margin.left/h.outer_width*100+"%"}).style("padding-right",function(){return h.margin.right/h.outer_width*100+"%"}).transition(h.duration).styleTween("opacity",function(){return I(0,1)}),h.canvas=e.select(n).append("div").attr("class",l+"wrapper").style("position","relative").style("padding-bottom",function(){return h.outer_height/h.outer_width*100+"%"}).style("position","relative");var s="0 0 "+h.outer_width+" "+h.outer_height;h.dv_init=!1,document.addEventListener("scroll",function(a){var i;d.getBoundingClientRect().top<.5*t.innerHeight&&!h.dv_init&&(h.dv_init=!0,setTimeout(function(){var a;h.svg=h.canvas.append("svg").attr("id",n+"-svg").style("position","absolute").style("top","0").style("left","0").style("bottom","0").style("right","0").style("margin","auto").attr("version","1.1").attr("x","0px").attr("y","0px").attr("class",l+"svg "+l+"type-"+y.type+" "+l+(y.colorPalette.length>0||null!==y.linePointsColor||null!==y.lineColor?"has":"no")+"-palette "+l+("pie"===y.type||y.xTicks||y.yTicks?"has":"no")+"-ticks "+l+(y.colorLegend?"has":"no")+"-legend"+("pie"==y.type&&null!==y.piLabelStyle?" "+l+"pi-label-style-"+y.piLabelStyle:" "+l+"no-label")).attr("viewBox",s).attr("preserveAspectRatio","xMidYMid meet").attr("xml:space","preserve").attr("width",h.outer_width).attr("height",h.outer_height),h.duration=h.svg.transition().duration(y.transition).ease(e.easeLinear),h.container=h.svg.append("g").attr("class",l+"svg-wrapper").attr("font-size",y.fontSize).style("line-height",1).attr("transform","translate("+h.margin.left+","+h.margin.top+")"),y.tooltipEnable&&(h.svg.append("circle").attr("class",l+"cursor-stalker"),h.tooltip_cursor_stalker=h.svg.select("circle."+l+"cursor-stalker"),h.tooltip=e.tip().attr("class",l+"tooltip").style("width",function(){return"number"==typeof y.tooltipWidth?parseFloat(y.tooltipWidth)+"px":"auto"==y.tooltipWidth?y.tooltipWidth:void 0}).style("text-align",y.tooltipTextAlign).direction(y.tooltipDirectionParameter||y.tooltipDirection).html(h.tooltip_html),h.svg.call(h.tooltip)),"pie"==y.type?h.pi_radius=(a=Math.min(.5*y.width,.5*y.height),y.colorLegend&&(a-=.25*a),"linked"==y.piLabelStyle&&(a-=.25*a),a):(h.container_lab=h.container.append("g").attr("class",l+"label"),h.container_rule=h.container.append("g").attr("class",l+"axis").attr("font-size",y.textTicksSize+"em"),(y.xGrid||y.yGrid)&&(h.container_grid=h.container.append("g").attr("class",l+"grid").attr("font-size",y.textTicksSize+"em"))),h.container_graph=h.container.insert("g").attr("class",l+"graph"),h.user_can_debug&&(y.width==f.width&&y.height==f.height&&h.data.length>9?console.warn(n+" Width and height was not adjusted. graph elements may not fit in the canvas"):y.width<f.width&&y.height<f.height&&console.warn(n+" set canvas width and or height may be too small.\n Tip: The given height and width are not absolute and act more like aspect ratios. svgs are responsive and will shrink along with content."),JSON.stringify(y.margin)==JSON.stringify(f.margin)&&(y.xLabel||y.yLabel)&&(y.xTicks||y.yTicks)&&console.debug(n+" text may overlap. margins may need to be modified")),"pie"==y.type&&h.container_graph.attr("transform","translate("+N("x")+","+N("y")+")"),y.srcMultiple||(o.forEach(function(t){switch(h["range_"+t]=v(t),h["the_"+t]=W(t),h["format_"+t]="function"==typeof y["format"+t+"Parameter"]?y["format"+t+"Parameter"]:"string"==typeof y["format"+t+"Parameter"]?function(r){return e.format(y["format"+t+"Parameter"])(r)}:function(e){var r=y["format"+t.toString().toUpperCase()+"Divider"],n=y["format"+t.toString().toUpperCase()+"Prepend"],a=y["format"+t.toString().toUpperCase()+"Append"],i,o;return n+(1==t||1==y.nameIsNum?e/r:e)+a},t){case 0:case 1:B(_(t),h.container_rule),y[_(t)+"Grid"]&&B(_(t),h.container_grid,!0);case"color":if(y.colorPalette.length)break}}),R(h.data)),r.graphs[n]={data:h.data,calcuated:h},t.addEventListener("resize",function(){clearTimeout(h.resize),h.resize=setTimeout(function(){y.srcMultiple||R(h.data)},100)})},y.delay))},!0)}else H("Data for "+n+" was filtered and all items are invalid for visualizing. check provided data keys and make sure they are correct")};if(y.srcPath.indexOf(t.location.href)>-1){var K=document.getElementById(y.srcPath.getHash()).innerHTML,j;if(K.isValidJSONString())J(JSON.parse(K));else H("Data input may not be valid. Please check and update the syntax")}else switch(y.srcPath.getFileExtension()){case"csv":case"dsv":case"tsv":case"xml":e[y.srcPath.getFileExtension()](y.srcPath,function(t){return t}).then(J).catch(function(t){H(t,!1)});break;default:e.json(y.srcPath,function(t){return t}).then(J).catch(function(t){H(t,!1)})}},t._1p21=r}(window,d3);