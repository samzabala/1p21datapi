/*!
* 1point21 Data Vizualiser Version 2.0.0
* Render Script
* @license yes
* DO NOT EDIT min.js
* edit its corresponding unminified js file in /src instead
*/
!function(e,t){"use strict";var n=e._1p21||{};n.graphs={},n.dataVisualizer=function(r,a){var i=["x","y"],o=["x","y","color","r"],l=[0,1,"color","area"],s="data-visualizer-",c=function(e,t){return t?"x"==e?"height":"width":"x"==e?"width":"height"},u=function(e){return"x"==e?"y":"x"},d=function(){var e=navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1};String.prototype.getFileExtension=function(){return this.split(".").pop()},String.prototype.getHash=function(){var e,t=this.split("#"),n;return t[t.length-1]||""},String.prototype.isValidJSONString=function(){try{JSON.parse(this)}catch(e){return!1}return!0},String.prototype.toCamelCase=function(){var e;return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0==t?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")};var p=function(e){var t,n,r,a;return e.match(/^rgb/)?(t=(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=e[2],r=e[3]):(t=(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")))>>16,n=e>>8&255,r=255&e),!((a=Math.sqrt(t*t*.299+n*n*.587+r*r*.114))>170)},g=document.querySelector(r);if(d()){var h=document.createElement("div");throw h.className=s+"wrapper fatality",h.innerHTML='Sorry, this graphic needs D3 to render the data but your browser does not support it.<br><br> Newer versions of Chrome, Edge, Firefox and Safari are recommended. <br><br>See <em><a target="_blank" rel="nofollow" href="https://d3-wiki.readthedocs.io/zh_CN/master/Home/#browser-platform-support">the official wiki</a></em> for more information',g.appendChild(h),new Error("D3 not supported by browser")}var y={};y.dv_container=g;var f={width:600,height:600,margin:40,transition:1500,delay:250,fontSize:"16px",title:"",description:"",srcType:"",srcPath:"",srcKey:null,textNameSize:.75,textValueSize:1.25,textTicksSize:.75,textLegendSize:.75,type:"bar",nameIsNum:!1,key:{0:0,1:1,color:null,area:null},format0Prepend:"",format0Append:"",format0Parameter:null,format0Divider:1,format1Prepend:"",format1Append:"",format1Parameter:null,format1Divider:1,format1Prepend:"",format1Append:"",format1Parameter:null,areaMin:10,areaMax:50,areaOpacity:.8,colorBackground:"#eee",colorPalette:[],colorData:null,colorLegend:!1,xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xParameter:null,xMin:null,xMax:null,xGrid:!1,xGridIncrement:1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yParameter:null,yMin:null,yMax:null,yGrid:!1,yGridIncrement:1,yPrepend:"",yAppend:"",yDivider:1,barTextOut:!1,lineStyle:"",lineWeight:1,lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillInvert:!1,lineFillOpacity:.5,lineDash:[100,0],piLabelStyle:null,piInRadius:0,srcMultiple:!1,reverse:{0:!1,1:!1,color:!1,multiple:!1},srcKeyMultiple:null,barTextOut:!1,colorBackground:"#EEE",colorBy:"key",colorScheme:null,toolTip:!1,toolTipContent:null},m=f;for(var _ in a)a.hasOwnProperty(_)&&(m[_]=a[_]);y.has_text=!(m.toolTip||("pie"===m.type||"scatter"===m.type||m.xTicks&&m.yTicks)&&("pie"!=m.type||!m.piLabelStyle&&m.colorLegend)),y.has_both_text_on_blob=!(!y.has_text||("pie"===m.type||m.xTicks||m.yTicks)&&("pie"!=m.type||m.colorLegend||null===m.piLabelStyle)),y.text_padding=2.25;var b=function(e){return 0==e||1==e?m.xData==e?"x":"y":e},x=function(e){return e>10?10*Math.pow(10,e.toString().length-1):1},k=function(e,t,n){var a=t.toString().split(".");function i(e,t){var r=null;return r=t.length?i(e[t[0]],t.slice(1)):1==n?parseFloat(e):e}n=n||!1,a.forEach(function(e,t){""==e&&a.splice(t,1)});var o=i(e,a);return 1==n&&isNaN(o)&&console.warn(r+" data with the key source of `"+t+"` was passed as numeric but is not."),o},v=function(e){var t=[];switch(e){case"color":t=m[e+"Palette"];break;case"area":t=[m.areaMin,m.areaMax];break;case 0:case 1:t="top"==m[u(b(e))+"Align"]||"left"==m[u(b(e))+"Align"]?[0,m[c(b(e))]]:[m[c(b(e))],0]}return t},w=function(e,n){var r=[],a=m.key[e];if(a)switch(e){case"color":var i;r=n.reduce(function(e,t){return e.includes(k(t,a))||e.push(k(t,a)),e},[]);break;case"area":case 0:case 1:var o,l,s,c;if(1==m.nameIsNum||1==e||"area"==e){if(r=[o=null!==m[b(e)+"Min"]&&"area"!==e?m[b(e)+"Min"]:t.min(n,function(e){return k(e,a,!0)}),l=null!==m[b(e)+"Max"]&&"area"!==e?m[b(e)+"Max"]:t.max(n,function(e){return k(e,a,!0)})],"scatter"==m.type&&0==e)r=[x(o),x(l)]}else r=n.map(function(e){return k(e,a,!1)});if(m.reverse[e]&&"area"!==e){for(var u=[],d=r.length-1;d>=0;d--)u.push(r[d]);r=u}}return r},S=function(e,t){var n=0;return"x"==e?"x"==t?n=m[c(t)]/2:"y"==t&&(n=-m[c(t)]/2):"x"==t?n="bottom"==m[t+"Align"]?m[c(t,!0)]+.875*y.margin.bottom:-.875*y.margin.top:"y"==t&&(n="right"==m[t+"Align"]?m[c(t,!0)]+(.875*y.margin.right+y.text_base_size):-(.875*y.margin.left-y.text_base_size)),n},T=function(e,t,n,r){var a=m[e+"Data"],i=m[u(e)+"Align"],o=20;switch(r=r||!1,m.type){case"pie":break;default:(o=1==m.nameIsNum||1==a?r?0:"right"==i||"bottom"==i?m[c(e)]-y["the_"+a](k(t,m.key[a],!0)):y["the_"+a](k(t,m.key[a],!0)):y["the_"+a].bandwidth())<0&&(o=0)}return o},z=function(e,t,n){var r=(n=n||!1)?0:2;return n||("line"==m.type?"line"==m.type&&m.linePointsSize&&(r=m.linePointsSize):"scatter"==m.type&&m.key.area&&(r=y.the_area(k(e,m.key.area,!0)))),r},A=function(e,t){var n="middle";return"pie"==m.type||(0==m.yData&&(n="start"),i.forEach(function(e){0==m[u(e)+"Data"]&&"right"==m[u(e)+"Align"]&&(n="end")})),n},P=function(e,t){var n="0em";if(y.has_both_text_on_blob&&"y"==e&&y.has_both_text_on_blob){var r=y.text_base_size*(m.textNameSize+m.textValueSize+y.text_padding);n=1==t?(-.5*r+y.text_base_size*m.textValueSize*.5+y.text_base_size)/(y.text_base_size*m.textValueSize)+"em":(.5*r-y.text_base_size*m.textNameSize*.5-y.text_base_size)/(y.text_base_size*m.textNameSize)+"em"}return n},L=function(e,t,n,a){a=a||!1;var i=m[e+"Data"],o=0,l;if("pie"==m.type){var s="linked"!=m.piLabelStyle&&a,d=(l=0,"linked"==m.piLabelStyle?l=a?1:2.5:0==a&&(l=1),l),p="linked"!=m.piLabelStyle,g=N(F(n),p,"centroid",d,s);o="x"==e?g[0]:g[1]}else{var h=function(){var t=0,r=1;return a||"scatter"==m.type||(("bar"!=m.type||m.barTextOut||"top"!=m[u(e)+"Align"]&&"right"!=m[u(e)+"Align"])&&("bar"==m.type&&!m.barTextOut||"bottom"!=m[u(e)+"Align"]&&"right"!=m[u(e)+"Align"])||(r*=-1),0==m[u(e)+"Data"]&&(t="x"==e?y.text_base_size:y.m_length(e,n)/2),t*=r),t},f=function(){var o=1,l=0;return a||"scatter"==m.type||(("bar"!=m.type||m.barTextOut||"bottom"!=m[u(e)+"Align"]&&"right"!=m[u(e)+"Align"])&&("bar"==m.type&&!m.barTextOut||"top"!=m[u(e)+"Align"]&&"left"!=m[u(e)+"Align"])||(o=-1),("bar"==m.type&&!m.barTextOut&&parseFloat(T(e,t,n))<y.m_length(e,n)||("bar"!=m.type||m.barTextOut)&&parseFloat(T(e,t,n))>=m[c(e,!0)]-y.m_length(e,n))&&0!==i&&("x"!=e||"line"===m.type||"bar"==m.type&&m.barTextOut?(l=y.m_length(e,n),console.log(r,l)):l=T(e,t,n)),l*=o),l};if(0==i)o=C(e,t,n),"bar"==m.type&&(o+=T(e,t,n)/2);else switch(m[u(e)+"Align"]){case"top":a||"scatter"===m.type||(o=T(e,t,n));break;case"right":case"bottom":o=a&&"scatter"!==m.type||"right"==m[u(e)+"Align"]&&"bar"==m.type&&!m.barTextOut?m[c(e)]:m[c(e)]-T(e,t,n);break;case"left":a||"bar"==m.type&&!m.barTextOut||(o=T(e,t,n))}o+=h()+f()}return o},C=function(e,t,n,r){var a=m[e+"Data"],i=m[u(e)+"Align"],o=0;return r=r||!1,"pie"!==m.type&&(1==m.nameIsNum||1==a?"right"==i||"bottom"==i?o=r&&0!==a&&"scatter"!==m.type?m[c(e)]:m[c(e)]-(m[c(e)]-y["the_"+m[e+"Data"]](k(t,m.key[a],!0))):"line"!=m.type&&"scatter"!=m.type||r&&0!==a&&"scatter"!==m.type||(o=y["the_"+m[e+"Data"]](k(t,m.key[a],!0))):(o=y["the_"+m[e+"Data"]](k(t,m.key[a],!1)),"line"!=m.type&&"scatter"!=m.type||m.nameIsNum||(o+=T(e,t,n)/2))),o},D=function(e){if(y.container_legend){var t=0,n="x"==e?y.container_legend.nodes()[0].getBoundingClientRect()[c(e)]:y.legend_height,r=function(){var t=0,r=1;return("pie"==m.type||"pie"!==m.type&&"left"==m[u(e)+"Align"]||"top"==m[u(e)+"Align"])&&(r=-1),"pie"==m.type&&"x"==e||"pie"!==m.type&&"left"==m[u(e)+"Align"]||"top"==m[u(e)+"Align"]?t=n+y.text_base_size:"pie"==m.type&&"y"==e&&(t=.5*n),t*r};return"pie"==m.type&&"x"==e||"pie"!==m.type&&"left"==m[u(e)+"Align"]||"top"==m[u(e)+"Align"]?t=m[c(e)]:"pie"==m.type&&"y"==e&&(t=.5*m[c(e)]),t+r()}},O=function(e,n){var r=e?"area":"line",a=0==m.xData?"x":"y",i=function(){var e="curveLinear";switch(m.lineStyle){case"step":e="curveStepAfter";break;case"curve":e="curveMonotone"+a.toUpperCase()}return e}(),o=t[r](),l;if("area"==r){var s={name:a,value:u(a)+1,fill:u(a)+0},d=(l=0,m.lineFillInvert&&(l="top"==m[a+"Align"]||"left"==m[a+"Align"]?1:-1),l);o[s.name](function(e,t){return C(a,e,t,n)})[s.value](function(e,t){return C(u(a),e,t,n)})[s.fill](function(e,t){return C(u(a),e,t,!0)+d*m[c(a)]})}else o.x(function(e,t){return C("x",e,t,n)}).y(function(e,t){return C("y",e,t,n)});return i&&o.curve(t[i]),o(y.data)},N=function(e,n,r,a,i){a=a||1,r=r||"",i=i||!1;var o=(c=0,(n=n||!1)&&(c=y.pi_radius*m.piInRadius),c),l=function(){var e=0;return(!i||i&&a<=1&&0==n)&&(e=y.pi_radius*a),e}(),s=t.arc().outerRadius(l).innerRadius(o),c;return r?s[r](e):s(e)},F=function(e){var n;return t.pie().sort(null).value(function(e,t){return k(e,m.key[1],!0)})(y.data)[e]},M=function(e){var t=0;return t=m.colorLegend&&"x"==e?.375*m[c(e)]:.5*m[c(e)]},E=function(e){return e.startAngle+(e.endAngle-e.startAngle)/2},I=function(e,n,r,a){r=r||function(e,t,n){return e};var i=t[a=a||"interpolate"](e,n);return function(t){var a=i(t);return r(a,e,n)}},B=function(e){var n;switch(e){case"color":n=t.scaleOrdinal().range(y["range_"+e]);break;case"area":case 0:case 1:n=1==m.nameIsNum||1==e||"area"==e?1==m.nameIsNum&&0==e&&"scatter"==m.type?t.scaleSymlog().constant(10).range(y["range_"+e]):t.scaleLinear().range(y["range_"+e]):"line"==m.type||"scatter"==m.type?t.scalePoint().range(y["range_"+e]):t.scaleBand().range(y["range_"+e]).paddingInner(.1).paddingOuter(.1)}return n},G=function(e,t,n){if(m[e+"Ticks"]){n=n||!1;var r=m[e+"Align"],a=(n?"grid_":"rule_")+e;m[e+"Label"]&&!n&&(y["lab_"+e]=y.container_lab.append("text").attr("class",s+"label-"+e).attr("y",function(){return S("y",e)}).attr("x",function(){return S("x",e)}).attr("font-size","1em").attr("text-anchor","middle").attr("opacity",0).text(m[e+"Label"]),"y"==e&&y["lab_"+e].attr("transform","rotate(-90)"),y["lab_"+e].transition(y.duration).attr("opacity",1)),y[a]=t.append("g").attr("class",function(){var t=null;return t=n?s+"grid-"+e+" grid-increment-"+m[e+"GridIncrement"]:s+"axis-"+e+" "+s+"axis-align-"+r});var i="";switch(e+" "+r){case"x bottom":i="0,"+m.height;break;case"y right":i=m.width+",0";break;default:i="0,0"}y[a].attr("transform","translate("+i+")")}},V=function(e,n){n=n||!1;var r="Axis "+m[e+"Align"],a=t[r.toCamelCase()](y["the_"+m[e+"Data"]]);if(m[e+"Ticks"]){if("scatter"==m.type&&0==m[e+"Data"]&&1==m.nameIsNum){var i=function(){var e=[],t=w(0,y.data)[0];do{e.push(t),t*=10}while(t<=w(1,y.data)[1]);return e};a.tickValues(i())}if(m[e+"TicksAmount"]){var o=function(){return n&&m[e+"TicksAmount"]?m[e+"TicksAmount"]*m[e+"GridIncrement"]:m[e+"TicksAmount"]};a.ticks(o())}n?a.tickSize(-m[c(e,!0)]).tickFormat(""):a.tickFormat(function(t,n){return y["format_"+m[e+"Data"]](t)})}return a},R=function(e,n){throw t.select(r).classed(s+"initialized",!0),t.select(r).append("div").attr("class",s+"wrapper fatality").html(n||"Sorry, unable to display data.<br> Please check the console for more details"),new Error(e)},H=function(e){y.data=e,console.log(r,"-------------------------------------------------------------------","\n","calculated shit",y,"\n","data",y.data,"\n","args",m,"\n"),l.forEach(function(e){y["dom_"+e]=w(e,y.data),y["the_"+e]&&y["dom_"+e]&&y["the_"+e].domain(y["dom_"+e])}),"pie"!==m.type&&i.forEach(function(e){m[e+"Ticks"]&&(y["rule_"+e+"_axis"]=V(e),y["rule_"+e].transition().duration(m.duration).call(y["rule_"+e+"_axis"]).attr("font-family",null).attr("font-size",null),m[e+"Grid"]&&(y["grid_"+e+"_axis"]=V(e,!0),y["grid_"+e].transition().duration(m.duration).call(y["grid_"+e+"_axis"]),y["grid_"+e].selectAll("g").classed("grid",!0).filter(function(t,n){var r=!1;return y["rule_"+e].selectAll("g").each(function(e){e==t&&(r=!0)}),r}).classed("tick-aligned",!0)))}),("line"!=m.type||m.linePoints)&&(y.blob=y.container_graph.selectAll(y.graph_item_element+"."+s+"graph-item.graph-item-blob").data(y.data,function(e){return k(e,m.key[0])}),y.blob.exit().transition(y.duration).attr("fill","red").remove()),y.has_text&&(y.blob_text=y.container_graph.selectAll("text."+s+"graph-item.graph-item-text").data(y.data,function(e){return k(e,m.key[0])}),y.blob_text.exit().transition(y.duration).remove(),"pie"==m.type&&"linked"==m.piLabelStyle&&(y.blob_text_link=y.container_graph.selectAll("polyline."+s+"graph-item.graph-item-link").data(y.data,function(e){return k(e,m.key[0])}),y.blob_text_link.exit().transition(y.duration).remove())),"pie"!==m.type&&"line"==m.type&&(y.container_graph.select("."+s+"line").remove(),m.lineFill&&(y.container_graph.select("."+s+"fill").remove(),y.fill=y.container_graph.append("path").attr("class",s+"fill"+(null!==m.lineFillColor||null!==m.lineColor?" has-color":" no-color")).attr("fill-opacity",m.lineFillOpacity),y.fill.transition(y.duration).attrTween("d",function(){return I(O(!0,!0),O(!0,!1))}),(m.lineFillColor||m.lineColor)&&y.fill.attr("fill",m.lineFillColor||m.lineColor)),y.line=y.container_graph.append("path").attr("class",s+"line"+(null!==m.lineColor?" has-color":" no-color")).attr("fill","none").attr("stroke-width",m.lineWeight).attr("stroke-linejoin","round").attr("stroke-dasharray",m.lineDash).attr("stroke-opacity",1).attr("stroke-dasharray","0,0").transition(y.duration).attrTween("d",function(){return I(O(!1,!0),O(!1,!1))}),m.lineColor&&y.line.attr("stroke",m.lineColor)),("line"!=m.type||m.linePoints)&&(y.enter_blob=y.blob.enter().append(y.graph_item_element).attr("class",function(e){return s+"graph-item graph-item-blob data-name-"+k(e,m.key[0])}),y.merge_blob=y.blob.merge(y.enter_blob),"pie"!==m.type&&y.merge_blob.transition(y.duration).attrTween("line"==m.type||"scatter"==m.type?"cx":"x",function(e,t){return I(C("x",e,t,!0),C("x",e,t,!1))}).attrTween("line"==m.type||"scatter"==m.type?"cy":"y",function(e,t){return I(C("y",e,t,!0),C("y",e,t,!1))}),"pie"==m.type&&y.merge_blob.transition(y.duration).attrTween("d",function(e,t){var n=F(t);return I(n.endAngle,n.startAngle,function(e){return n.startAngle=e,N(n,!0)})}),"line"==m.type||"scatter"==m.type?y.merge_blob.transition(y.duration).attrTween("r",function(e,t){return I(z(e,t,!0),z(e,t,!1))}):y.merge_blob.transition(y.duration).attrTween("width",function(e,t){return I(T("x",e,t,!0),T("x",e,t,!1))}).attrTween("height",function(e,t){return I(T("y",e,t,!0),T("y",e,t,!1))}),m.colorPalette.length?(y.merge_blob.attr("fill",function(e,t){return y.the_color(k(e,m.key.color))}),"scatter"==m.type&&y.merge_blob.attr("fill-opacity",m.areaOpacity).attr("stroke-width",1).attr("stroke",function(e,t){return y.the_color(k(e,m.key.color))})):"line"==m.type&&(m.linePointsColor||m.lineColor)&&y.merge_blob.attr("fill",function(){return m.linePointsColor||m.lineColor})),y.has_text&&(y.blob_text_link&&(y.enter_blob_text_link=y.blob_text_link.enter().append("polyline").attr("class",function(e){return s+"graph-item graph-item-link data-name-"+k(e,m.key[0])}),y.merge_blob_text_link=y.blob_text_link.merge(y.enter_blob_text_link).transition(y.duration).attrTween("stroke-opacity",function(e,t){return I(0,.75)}).attrTween("points",function(e,t){var n=[N(F(t),!0,"centroid",1,!1),N(F(t),!0,"centroid",1,!1)],r=[N(F(t),!0,"centroid",1,!1),N(F(t),!1,"centroid",2.25,!1)];return I(n,r)})),y.enter_blob_text=y.blob_text.enter().append("text").attr("line-height",1.25).attr("dominant-baseline","middle").attr("stroke",function(e){return"pie"==m.type&&"within"==m.piLabelStyle&&m.colorPalette.length>0?y.the_color(k(e,m.key.color)):"bar"!==m.type&&"pie"!==m.type||"pie"==m.type&&"linked"==m.piLabelStyle?m.colorBackground:void 0}),[0,1].forEach(function(e){("pie"!==m.type&&!m[b(e)+"Ticks"]||"pie"==m.type&&(0==e&&!m.colorLegend||1==e&&null!==m.piLabelStyle))&&(y["blob_text_"+e]=y.enter_blob_text.append("tspan").attr("class",function(t){return"graph-item-text-data-"+e+" data-name-"+k(t,m.key[0])}).attr("dominant-baseline","middle").attr("text-anchor",function(e,t){return A(e,t)}).attr("font-size",function(){var t=null;return("pie"!==m.type&&!m[u(b(e))+"Ticks"]||"pie"==m.type&&!m.colorLegend&&null!==m.piLabelStyle)&&(t=0==e?m.textNameSize+"em":m.textValueSize+"em"),t}).attr("font-weight",function(){var t=700;return("pie"!==m.type&&!m[u(b(e))+"Ticks"]||"pie"==m.type&&!m.colorLegend&&null!==m.piLabelStyle)&&0!==e&&(t=300),t}).text(function(t,n){return y["format_"+e](k(t,m.key[e]))}),y["blob_text_"+e].attr("x",P("x",e)).attr("y",P("y",e)))}),y.m_length=function(e,t){if(y.has_text){var n=y.text_base_size*(m.textNameSize+m.textValueSize+y.text_padding);return"width"==c(e)&&(n=y.enter_blob_text.nodes()[t].getBoundingClientRect()[c(e)]+y.text_base_size),n}},y.merge_blob_text=y.blob_text.merge(y.enter_blob_text).attr("class",function(e,t){var n=s+"graph-item graph-item-text";return"bar"==m.type&&(!m.barTextOut&&(parseFloat(T(b(1),e,t,!1))<y.m_length(b(1),t)&&!p(m.colorBackground)||parseFloat(T(b(1),e,t,!1))>=y.m_length(b(1),t)&&m.colorPalette.length>0&&!p(y.the_color(k(e,m.key.color))))||1==m.barTextOut&&(parseFloat(T(b(1),e,t,!1))+y.m_length(b(1),t)<=m[c(b(1))]&&!p(m.colorBackground)||parseFloat(T(b(1),e,t,!1))+y.m_length(b(1),t)>m[c(b(1))]&&m.colorPalette.length>0&&!p(y.the_color(k(e,m.key.color)))))||("line"==m.type||"scatter"==m.type)&&!p(m.colorBackground)||"pie"==m.type&&("within"==m.piLabelStyle&&m.colorPalette.length>0&&!p(y.the_color(k(e,m.key.color)))||"linked"==m.piLabelStyle&&!p(m.colorBackground))?n+=" dark":n+=" light",n}).transition(y.duration).attrTween("transform",function(e,t){var n="pie"==m.type?F(t):e;return I("translate("+L("x",n,t,!0)+","+L("y",n,t,!0)+")","translate("+L("x",n,t,!1)+","+L("y",n,t,!1)+")")}).styleTween("opacity",function(){return I(0,1)})),m.colorLegend&&(y.legend_height=0,y.container_legend&&y.container_legend.remove(),y.container_legend=y.container.append("g").attr("class",s+"legend").attr("font-size",m.textLegendSize+"em"),y.dom_color.forEach(function(e,t){y.legend=y.container_legend.append("g").attr("class",s+"legend-item"),y.legend.append("rect").attr("class","legend-item-blob").attr("width",.75*y.legend_size).attr("height",.75*y.legend_size).attr("fill",y.the_color(e)).attr("stroke",m.colorBackground),y.legend.append("text").attr("class","legend-item-text").text(e).attr("dominant-baseline","middle").attr("x",y.legend_size).attr("y",.375*y.legend_size).attr("stroke",m.colorBackground),y.legend.attr("transform","translate(0, "+t*y.legend_size+")"),y.legend_height+=y.legend_size}),y.container_legend.attr("transform","translate("+D("x")+","+D("y")+")").transition(y.duration).styleTween("opacity",function(){return I(0,1)})),n.graphs[r]={data:y.data,_:y}},J=function(n){switch(y.the_container=t.select(r),y.the_container.classed(s+"initialized"+(p(m.colorBackground)?" "+s+"dark":""),!0).style("background-color",m.colorBackground),y.data=null,m.type){case"bar":y.graph_item_element="rect";break;case"pie":y.graph_item_element="path";break;case"line":case"scatter":y.graph_item_element="circle"}if(y.text_base_size=parseFloat(m.fontSize),y.data=m.srcKey?k(n,m.srcKey)?k(n,m.srcKey):void R(r+" provided source key is invalid"):n,y.data=y.data.filter(function(e,t){var n=!0;if(l.forEach(function(a){m.key[a]&&null==k(e,m.key[a])&&(n=!1,console.info(r+" datum index `"+t+"` was filtered.\ndatum does not have data for the key `"+m.key[a]+"`, which is set as data for `"+a+"`"))}),n)return e}),y.data.length>0){if(1==m.nameIsNum){for(var i=[],o=0;o<y.data.length;o++)y.data[o]&&i.push(y.data[o]);i.sort(function(e,t){return k(e,m.key[0],!0)-k(t,m.key[0],!0)}),y.data=i}a.key.color||(a.key.color=m.key[0],a.colorLegend||(m.colorLegend=!1)),y.legend_size=m.textLegendSize*parseFloat(m.fontSize)*2,y.margin={top:m.margin[0]||m.margin,right:m.margin[1]||m.margin[0]||m.margin,bottom:m.margin[2]||m.margin[0]||m.margin,left:m.margin[3]||m.margin[1]||m.margin[0]||m.margin},y.outer_width=m.width+y.margin.left+y.margin.right,y.outer_height=m.height+y.margin.top+y.margin.bottom,t.select(r).append("div",":first-child").attr("class",s+"heading"),y.heading_sel=t.select(r).select("div."+s+"heading"),m.title&&(y.heading_title=y.heading_sel.append("span").attr("class",s+"title").text(m.title)),m.description&&(y.heading_description=y.heading_sel.append("span").attr("class",s+"description").text(m.description)),y.heading_sel.style("padding-top",function(){return y.margin.top/m.height*50+"%"}).style("padding-left",function(){return y.margin.left/y.outer_width*100+"%"}).style("padding-right",function(){return y.margin.right/y.outer_width*100+"%"}).transition(y.duration).styleTween("opacity",function(){return I(0,1)}),y.canvas=t.select(r).append("div").attr("class",s+"wrapper").style("position","relative").style("padding-bottom",function(){return y.outer_height/y.outer_width*100+"%"}).style("position","relative");var c="0 0 "+y.outer_width+" "+y.outer_height;y.dv_init=!1,document.addEventListener("scroll",function(n){var a;g.getBoundingClientRect().top<.5*e.innerHeight&&!y.dv_init&&(y.dv_init=!0,setTimeout(function(){var n;y.svg=y.canvas.append("svg").attr("id",r+"-svg").style("position","absolute").style("top","0").style("left","0").style("bottom","0").style("right","0").style("margin","auto").attr("version","1.1").attr("x","0px").attr("y","0px").attr("class",s+"svg "+s+"type-"+m.type+" "+s+(m.colorPalette.length>0||null!==m.linePointsColor||null!==m.lineColor?"has":"no")+"-palette "+s+("pie"===m.type||m.xTicks||m.yTicks?"has":"no")+"-ticks "+s+(m.colorLegend?"has":"no")+"-legend"+("pie"==m.type&&null!==m.piLabelStyle?" "+s+"pi-label-style-"+m.piLabelStyle:" "+s+"no-label")).attr("viewBox",c).attr("preserveAspectRatio","xMidYMid meet").attr("xml:space","preserve").attr("width",y.outer_width).attr("height",y.outer_height),y.duration=y.svg.transition().duration(m.transition).ease(t.easeLinear),y.container=y.svg.append("g").attr("class",s+"svg-wrapper").attr("font-size",m.fontSize).style("line-height",1).attr("transform","translate("+y.margin.left+","+y.margin.top+")"),"pie"==m.type?y.pi_radius=(n=Math.min(.5*m.width,.5*m.height),m.colorLegend&&(n-=.25*n),"linked"==m.piLabelStyle&&(n-=.25*n),n):(y.container_lab=y.container.append("g").attr("class",s+"label"),y.container_rule=y.container.append("g").attr("class",s+"axis").attr("font-size",m.textTicksSize+"em"),(m.xGrid||m.yGrid)&&(y.container_grid=y.container.append("g").attr("class",s+"grid").attr("font-size",m.textTicksSize+"em"))),y.container_graph=y.container.insert("g").attr("class",s+"graph"),m.width==f.width&&m.height==f.height&&y.data.length>9?console.warn(r+" Width and height was not adjusted. graph elements may not fit in the canvas"):m.width<f.width&&m.height<f.height&&console.warn(r+" set canvas width and or height may be too small.\n Tip: The given height and width are not absolute and act more like aspect ratios. svgs are responsive and will shrink along with content."),JSON.stringify(m.margin)==JSON.stringify(f.margin)&&(m.xLabel||m.yLabel)&&(m.xTicks||m.yTicks)&&console.debug(r+" text may overlap. margins may need to be modified"),"pie"==m.type&&y.container_graph.attr("transform","translate("+M("x")+","+M("y")+")"),l.forEach(function(e){switch(y["range_"+e]=v(e),y["the_"+e]=B(e),y["format_"+e]="function"==typeof m["format"+e+"Parameter"]?m["format"+e+"Parameter"]:"string"==typeof m["format"+e+"Parameter"]?function(n){return t.format(m["format"+e+"Parameter"])(n)}:function(t){var n=m["format"+e.toString().toUpperCase()+"Divider"],r=m["format"+e.toString().toUpperCase()+"Prepend"],a=m["format"+e.toString().toUpperCase()+"Append"],i,o;return r+(1==e||1==m.nameIsNum?t/n:t)+a},e){case 0:case 1:G(b(e),y.container_rule),m[b(e)+"Grid"]&&G(b(e),y.container_grid,!0);case"color":if(m.colorPalette.length)break}}),H(y.data),e.addEventListener("resize",function(){H(y.data)})},m.delay))},!0)}else R("Data was filtered and all items are invalid for visualizing. check provided data keys and make sure they are correct")};if(m.srcPath.indexOf(e.location.href)>-1){var K=document.getElementById(m.srcPath.getHash()).innerHTML,U;if(K.isValidJSONString())J(JSON.parse(K));else R("Data input may not be valid. Please check and _ the syntax")}else switch(m.srcPath.getFileExtension()){case"csv":case"dsv":case"tsv":case"xml":t[m.srcPath.getFileExtension()](m.srcPath,function(e){return e}).then(J).catch(function(e){R(e,"Data source couldn't be requested. Please check console for more details")});break;default:t.json(m.srcPath,function(e){return e}).then(J).catch(function(e){R(e,"Data source couldn't be requested. Please check console for more details")})}},e._1p21=n}(window,d3);