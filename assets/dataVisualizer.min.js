!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).dataVisualizer=e()}(this,(function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&o(t,e)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)},i(t)}function o(t,e){return o=Object.setPrototypeOf||function t(e,a){return e.__proto__=a,e},o(t,e)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}function u(t){var e=s();return function a(){var n=i(t),r;if(e){var o=i(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function h(t){throw new TypeError('"'+t+'" is read-only')}function f(t,e){return d(t)||g(t,e)||p(t,e)||v()}function d(t){if(Array.isArray(t))return t}function g(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var n=[],r=!0,i=!1,o,s;try{for(a=a.call(t);!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n}}function p(t,e){if(t){if("string"==typeof t)return y(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(t,e){var a;return w(t,_(t,e,"get"))}function k(t,e,a){var n;return x(t,_(t,e,"set"),a),a}function _(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}function b(t,e,a){return S(t,e),a}function w(t,e){return e.get?e.get.call(t):e.value}function x(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}function S(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}function C(t,e,a){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return a}function T(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A(t,e,a){T(t,e),e.set(t,a)}function P(t,e){T(t,e),e.add(t)}var L=function(){function a(n,r){if(e(this,a),n&&(this.dv=n,"object"===t(r)))for(var i in r)this[i]=r[i]}return n(a,[{key:"dispose",value:function t(){this.dv=null}}]),a}(),E=["x","y"],z=[0,1,"color","area"],D=function t(e,a){var n=e;return Object.keys(a).forEach((function(e,r){"key"==e||"reverse"==e?n[e]=t(n[e],a[e]):a.hasOwnProperty.call(a,e)&&(n[e]=a[e])})),n},O=function t(e,a){return a?"x"==e?"height":"width":"x"==e?"width":"height"},I=function t(e){return"x"==e?"y":"x"},M=function t(){var e=navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1},N={fileExtension:function t(e){return e.split(".").pop()},hash:function t(e){var a,n=e.split("#"),t=n[n.length-1]||"";return t},IsValidJSONString:function t(e){try{JSON.parse(e)}catch(t){return!1}return!0},toCamelCase:function t(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()})).replace(/\s+/g,"")},toCapitalize:function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}},j=function t(e){var a,n,r,i;return e.match(/^rgb/)?(a=(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],n=e[2],r=e[3]):(a=(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")))>>16,n=e>>8&255,r=255&e),!((i=Math.sqrt(a*a*.299+n*n*.587+r*r*.114))>170)},F=function t(e){if("number"==typeof e)return e},U=function t(e){return e>10?10*Math.pow(10,e.toString().length-1):1},W=function(t){r(i,t);var a=u(i);function i(t,n){return e(this,i),a.call(this,t,{axisName:n})}return n(i,[{key:"amount",value:function t(e){var a=this.dv,n=this.axisName;return e&&a.args("".concat(n,"TicksAmount"))?a.args("".concat(n,"TicksAmount"))*a.args("".concat(n,"GridIncrement")):a.args("".concat(n,"TicksAmount"))}},{key:"values",value:function t(){var e=this.dv,t=[],a=e.domain(0)[0];do{t.push(a),a*=10}while(a<=e.domain(1).values);return t}},{key:"getCall",value:function t(e){e=e||!1;var a=this.dv,n=this.axisName,r="Axis "+a.args("".concat(n,"Align")),i=d3[N.toCamelCase(r)](a.scale(a.args("".concat(this.axisName,"Data"))));return a._is_base("scatter")&&0==a.args("".concat(n,"Data"))&&1==a._name_is_num&&i.tickValues(this.values()),a._has_axis_prop("ticksAmount",n)&&i.ticks(this.amount(e)),e?i.tickSize(-1*a.args(O(n,!0))).tickFormat(""):i.tickFormat((function(t,e){return a.format(a.args("".concat(n,"Data")))(t,e)})),i}}]),i}(L),G=function(t){r(i,t);var a=u(i);function i(t,n,r){return e(this,i),a.call(this,t,{dis:n,i:r})}return n(i,[{key:"dimension",value:function t(e){return this.dv.args(O(e))}},{key:"tag",get:function t(){var e;switch(this.dv.baseType){case"bar":return"rect";case"pie":return"path";case"line":case"scatter":return"circle"}}},{key:"coordAttr",value:function t(e){var a;return this.dv._is_base(["line","scatter"])?"c".concat(e):"".concat(e)}},{key:"radius",value:function t(e){var a=this.dv,n=this.dis;this.i;var t=(e=e||!1)?0:a._is_base("scatter")?(a.args("areaMin")+a.args("areaMax"))/2:5;return e||(a._is_base("line")?a._is_base("line")&&a.args("linePointsSize")&&(t=args.linePointsSize):a._is_base("scatter")&&a.args("key['area']")&&(t=a.scale("area",a._get(n,a.args("key['area']"),!0)))),t}},{key:"scaledValue",value:function t(e){var a=this.dv,n=this.dis,r;return r=1==a._name_is_num||1==e?a._get(n,a.args("key['".concat(e,"']")),!0):a._get(n,a.args("key['".concat(e,"']")),!1),a.scale(e,r)}},{key:"size",value:function t(e,a){a=a||!1;var n=this.dv;if(this.dis,this.i,!n._is_base("pie")){var r=20,i=n.args("".concat(e,"Data")),o=n.args("".concat(I(e),"Align"));return(r=1==n._name_is_num||1==i?a?0:"right"==o||"bottom"==o?this.dimension(e)-this.scaledValue(i):this.scaledValue(i):n.scale(i).bandwidth())<0&&(r=0),r}}},{key:"offset",value:function t(e,a){a=a||!1;var n=this.dv,r=this.dis;if(this.i,!n._is_base("pie")){var i=n.args("".concat(e,"Data")),o=n.args("".concat(I(e),"Align")),s=0;return 1==n._name_is_num||1==i?"right"==o||"bottom"==o?a&&1==i&&n._is_base(["bar","line"])?s=this.dimension(e):(s=this.dimension(e)-this.scaledValue(i),console.warn("offe",r.name,e,this.dimension(e),this.scaledValue(i),s)):n._is_base(["line","scatter"])&&(a&&1==i&&n._is_base("line")||(s=this.scaledValue(i))):(s=this.scaledValue(i),n._is_base(["line","scatter"])&&!n._name_is_num&&(s+=this.size(e)/2)),s}}}]),i}(L),R=.875,V=function(t){r(i,t);var a=u(i);function i(t,n){return e(this,i),a.call(this,t,{axisName:n})}return n(i,[{key:"offset",value:function t(e){var t=0,a=this.dv,n=this.axisName;return"x"==e?"x"==n?t=a.args(O(n))/2:"y"==n&&(t=-a.args(O(n))/2):"x"==n?t="bottom"==a.args("".concat(n,"Align"))?a.args(O(n,!0))+a.margin.bottom*R:-a.margin.top*R:"y"==n&&(t="right"==a.args("".concat(n,"Align"))?a.args(O(n,!0))+(a.margin.right*R+a.fontSize):-(a.margin.left*R-a.fontSize)),t}}]),i}(L),B=function(t){r(i,t);var a=u(i);function i(t,n){return e(this,i),a.call(this,t,{data:n})}return n(i,[{key:"axisToFill",get:function t(){return 0==this.dv.args("xData")?"x":"y"}},{key:"style",get:function t(){var e;switch(this.dv.args("lineStyle")){case"step":e="curveStepBefore";break;case"curve":e="curveMonotone"+this.axisToFill.toUpperCase();break;default:e="curveLinear"}return e}},{key:"path",value:function t(e,a){var n=this;if(this.data){a=a||!1;var r=this.dv;this.i;var i=e?"area":"line",t=d3[i]();if("area"==i){var o={name:this.axisToFill,value:"".concat(I(this.axisToFill),"1"),fill:"".concat(I(this.axisToFill),"0")};t[o.name]((function(t,e){return r.Shape(t,e).offset(n.axisToFill,a)}))[o.value]((function(t,e){return r.Shape(t,e).offset(I(n.axisToFill),a)}))[o.fill]((function(t,e){return"bottom"==r.args("".concat(n.axisToFill,"Align"))||"right"==r.args("".concat(n.axisToFill,"Align"))?r.args(O(n.axisToFill)):0}))}else t.x((function(t,e){return r.Shape(t,e).offset("x",a)})).y((function(t,e){return r.Shape(t,e).offset("y",a)}));return t.curve(d3[this.style]),t(this.data)}}}]),i}(L),H=.5,J=.375,K=function(t){r(i,t);var a=u(i);function i(t,n,r){return e(this,i),a.call(this,t,{dis:n,i:r})}return n(i,[{key:"radius",get:function t(){var e=this.dv,a=Math.min(.5*e.args("width"),.5*e.args("height"));return e.args("colorLegend")&&(a-=.25*a),"linked"==e.args("piLabelStyle")&&(a-=.25*a),a}},{key:"offset",value:function t(e){var a=this.dv,t=0;return t=a.args("colorLegend")&&"x"==e?a.args(O(e))*J:a.args(O(e))*H,t}},{key:"path",value:function t(e,a,n,r){var i=this.dis.pie;if(i){var o=this.dv;n=n||1,a=a||"",r=r||!1;var s=(e=e||!1)?this.radius*o.args("piInRadius"):0,c=!r||r&&n<=1&&0==e?this.radius*n:0,l=d3.arc().outerRadius(c).innerRadius(s);return a?l[a](i):l(i)}}}]),i}(L),q=function(a){r(o,a);var i=u(o);function o(t,a){return e(this,o),i.call(this,t,{classToAdd:a})}return n(o,[{key:"html",get:function t(){var e;return this.dv.args("tooltipContent")||o.default}},{key:"getCall",value:function t(){var e=this,a=this.dv;return d3.tip().attr("class","".concat(e.classToAdd)).style("width",(function(){return"number"==typeof a.args("tooltipWidth")?"".concat(a.args("tooltipWidth"),"px"):"auto"==a.args("tooltipWidth")?a.args("tooltipWidth"):void 0})).style("text-align",a.args("tooltipTextAlign")).direction(a.args("tooltipDirectionParameter")||a.args("tooltipDirection")).html(o.html)}},{key:"show",value:function t(){}},{key:"default",value:function e(a,n){var r=this.dv,i='<div class="'.concat(r.createClass("tooltip-data"),'">'),o=function e(n){if(Object.prototype.hasOwnProperty.call(a,n)){var i=!1;"object"!==t(a[n])&&('<div class="'.concat(r.createClass("tooltip-data-property"),'">'),h("html"),"row"!==r.args("srcType")&&('<strong class="'.concat(r.createClass("tooltip-data-property-label"),'">').concat(n,":</strong> "),h("html")),DatumKeys.forEach((function(t){r.args("key['".concat(t,"']"))&&r.args("key['".concat(t,"']")).lastIndexOf(n)>-1&&r.format(t)&&('<span class="'.concat(r.createClass("tooltip-data-property-content"),'">').concat(r.format(t)(r._get(a,r.args("key['".concat(t,"' ]"))))," </span>"),h("html"),h("propIsOutputted"))})),'<span class="'.concat(r.createClass("tooltip-data-property-content"),'">').concat(a[n],"</span>"),h("html"),h("html"))}};for(var s in a)o(s);return h("html"),i}}]),o}(L),X="dv",Y=["bar","pie","line","scatter"],Z="".concat(X,"-initialized"),Q="".concat(X,"-fatality"),tt="".concat(X,"-heading"),et="".concat(X,"-title"),at="".concat(X,"-description"),nt="".concat(X,"-body"),rt="".concat(X,"-svg"),it="".concat(X,"-container"),ot="".concat(X,"-labels"),st="".concat(X,"-label"),ct="".concat(X,"-rulers"),lt="".concat(X,"-rule"),ut="".concat(lt,"-align"),ht="".concat(X,"-grid"),ft="".concat(ht,"-col"),dt="".concat(ft,"-increment"),gt="".concat(X,"-graph"),pt="".concat(X,"-line"),yt="".concat(gt,"-item"),vt="".concat(yt,"-shape"),mt="".concat(yt,"-link"),kt="".concat(pt,"-fill"),_t="".concat(X,"-text"),bt="".concat(X,"-cursor-stalker"),wt="".concat(X,"-tooltip"),xt=9,St=10,Ct=new WeakMap,Tt=new WeakMap,At=new WeakMap,Pt=new WeakSet,Lt=new WeakSet,Et=new WeakSet,zt;function Dt(){return document.body.classList.contains("logged-in")}function Ot(e,a,n){if(n=n||!1,a){var r=a.toString().replace(/('|"|\s|\t|\n|\r)/g,"").replace(/\[(.+?)\]/,".$1").split(".");r.forEach((function(t,e){""==t&&r.splice(e,1)}));var i=function e(a,r){var i=null;return i=r.length>0&&"object"===t(a)?e(a[r[0]],r.slice(1)):1==n?parseFloat(a):a},o=i(e,r);return 1==n&&isNaN(o)&&console.warn("data with the key source of '".concat(a,"' was passed as numeric but is not.")),o}}function It(t){var e;this.g.append("g").attr("class",t)}function Mt(t){var e=this,a;if(e.args("srcKey")?e._get(t,e.args("srcKey"))?a=e._get(t,e.args("srcKey")):renderError("".concat(e.selector," provided source key is invalid")):a=t,1==e.args("srcMultiple")&&e.args("srcPreNest")){var n=[],r=function t(e){a[e].forEach((function(t,r){a[e][r]._parent=e,n.push(a[e][r])}))};"[object Array]"===Object.prototype.toString.call(a)?a.forEach((function(t,e){r(e)})):Object.keys(a).forEach((function(t){r(t)})),a=n}if(a=a.filter((function(t,a){var n=!0;if(z.forEach((function(r){var i=e.args("key['".concat(r,"']"));if(i&&null==e._get(t,i)&&(n=!1,m(e,At))){var o=0==r?"name":1==r?"value":r;console.warn("".concat(e.selector," datum index '").concat(a,"' was filtered.\ndatum does not have data for the key '").concat(i,"', which is set as the property for '").concat(o,"'"))}})),n)return t})),1==e.args("nameIsNum")){for(var i=[],o=0;o<a.length;o++)a[o]&&i.push(a[o]);i.sort((function(t,a){return e._get(t,e.args("key.0"),!0)-e._get(a,e.args("key.0"),!0)})),a=i}return a.length||e.kill("Data for ".concat(e.selector," was filtered and all items are invalid for visualizing. check provided data keys and make sure they are correct")),a}function Nt(t){var e=this,a;e.g.selectAll("g.".concat(t)).data(e.readyData(),(function(t){return t.parent})).enter().append("g").attr("class",(function(a){return"".concat(t,"\n\t\t\t\t\t\t").concat(e.createClass("","data-group-".concat(a.parent," ").concat(t,"-set"),a.parent&&a.key))})).attr("transform",(function(){return e._is_base("pie")?"translate( ".concat(e.Pi().offset("x")," , ").concat(e.Pi().offset("y")," )"):""})).exit().transition(10).style("opacity",0).remove()}return function(){function t(a,n){if(e(this,t),P(this,Et),P(this,Lt),P(this,Pt),A(this,At,{get:Dt,set:void 0}),A(this,Ct,{writable:!0,value:!1}),A(this,Tt,{writable:!0,value:{displayed:!1,complete:!1}}),!window.d3)return!1;var r=this;if(r.selector=a,r.elem=document.querySelector(a),M()){var i=document.createElement("div");throw i.className="".concat(nt," ").concat(Q),i.innerHTML='Sorry, this graphic needs D3 to render the data but your browser does not support it.<br><br> Newer versions of Chrome, Edge, Firefox and Safari are recommended. <br><br>See <em><a target="_blank" rel="nofollow" href="https://d3-wiki.readthedocs.io/zh_CN/master/Home/#browser-platform-support">the official wiki</a></em> for more information',r.elem.appendChild(i),new Error("D3 not supported by browser")}r._get(n,"key.color")||(n.key.color=n.key[0],n.colorLegend||(n.colorLegend=!1)),k(r,Ct,n),r.isLoaded=!1,r.resizeInt=null,r.load()}return n(t,[{key:"UiEl",value:function t(e){return e&&this._resetUiEl(e),this.elem}},{key:"_resetUiEl",value:function t(e){if(!e)throw new Error("Needs a valid element to reset component UI root element");this.elem=e}},{key:"_get",value:function e(a,n,r){return b(t,t,Ot).call(t,a,n,r)}},{key:"_is_base",value:function t(e){var a=this,n=[];"string"==typeof e?n.push(e):Array.isArray(e)&&e.forEach((function(t){n.push(t)}));var r=!1;return n.forEach((function(t){a.args("type").includes("".concat(t))&&!r&&(r=!0)})),r}},{key:"_has_nested_data",get:function t(){return!(this.args("srcMultiple")&&this._is_base("pie"))}},{key:"_name_is_num",get:function t(){return this.args("nameIsNum")}},{key:"_has_text",get:function t(){return!(this.args("toolTip")||(!this._is_base(["bar","line"])||this.args("xTicks")&&this.args("yTicks"))&&(!this._is_base("pie")||!this.args("piLabelStyle")&&this.args("colorLegend")))}},{key:"_has_both_text",get:function t(){return!(!this._has_text||!(this._is_base(["bar","line","scatter"])&&!this.args("xTicks")&&!this.args("yTicks")||this._is_base("pie")&&!this.args("colorLegend")&&null!==this.args("piLabelStyle")))}},{key:"_has_polyline",get:function t(){return this._is_base("pie")&&"linked"==this.args("piLabelStyle")}},{key:"_has_tooltip",get:function t(){return this.args("tooltipEnable")}},{key:"_has_grid",value:function t(e){return this._has_ticks(e)&&this._has_axis_prop("grid",e)}},{key:"_has_labels",value:function t(e){return this._has_ticks(e)&&this._has_axis_prop("label",e)}},{key:"_has_ticks",value:function t(e){return this._has_axis_prop("ticks",e)}},{key:"_has_axis_prop",value:function t(e,a){if(e&&!this._is_base("pie"))return a?this.args(N.toCamelCase("".concat(a," ").concat(e))):this.args(N.toCamelCase("x ".concat(e)))||this.args(N.toCamelCase("y ".concat(e)))}},{key:"drawnData",get:function t(){return m(this,Tt).displayed.length?m(this,Tt).displayed:m(this,Tt).complete},set:function t(e){m(this,Tt).displayed=e}},{key:"completeData",get:function t(){return m(this,Tt).complete},set:function t(e){m(this,Tt).complete=e}},{key:"args",value:function e(a){a=a||!1;var n=D(t.defaults(),m(this,Ct));return a?b(t,t,Ot).call(t,n,a):n}},{key:"baseType",get:function t(){var e=this,a;return Y.forEach((function(t){e._is_base(t)&&!a&&(a=t)})),a}},{key:"fontSize",get:function t(){return parseFloat(this.args("fontSize"))}},{key:"legendSize",get:function t(){return this.args("textLegendSize")*this.fontSize*2}},{key:"margin",get:function t(){var e=this;return{top:F(e.args("margin[0]"))||F(e.args("margin"))||0,right:F(e.args("margin[1]"))||F(e.args("margin[0]"))||F(e.args("margin"))||0,bottom:F(e.args("margin[2]"))||F(e.args("margin[0]"))||F(e.args("margin"))||0,left:F(e.args("margin[3]"))||F(e.args("margin[1]"))||F(e.args("margin[0]"))||F(e.args("margin"))||0}}},{key:"outer",value:function t(e){var a=[];return a="width"==e?["left","right"]:["top","bottom"],this.args(e)+this.margin[a[0]]+this.margin[a[1]]}},{key:"outerWidth",get:function t(){return this.outer("width")}},{key:"outerHeight",get:function t(){return this.outer("height")}},{key:"duration",get:function t(){return this.__trans||(this.__trans=d3.transition().duration(this.args("transition")).ease(d3.easeLinear)),this.__trans}},{key:"interpolate",value:function t(e,a,n,r){n=n||function(t,e,a){return t},r=r||"interpolate";var i=d3[r](e,a);return function(t){var r=i(t);return n(r,e,a)}}},{key:"createClass",value:function t(e,a,n,r){return e=e||"",a=a||!1,n=0!=n||1==n,r=0!=r||1==r,"".concat(r?"".concat(X,"-"):"").concat(n?a:e)}},{key:"axisName",value:function t(e){var a;return 0==e||1==e?this.args("xData")==e?"x":"y":e}},{key:"range",value:function t(e){var a=this,n=a.axisName(e),r=[];switch(e){case"color":r=a.args("".concat(e,"Palette"));break;case"area":r=[a.args("areaMin"),a.args("areaMax")];break;case 0:case 1:r="top"==a.args("".concat(I(n),"Align"))||"left"==a.args("".concat(I(n),"Align"))?[0,a.args(O(n))]:[a.args(O(n)),0]}return r}},{key:"domain",value:function t(e){var a=this,n=a.args("key['".concat(e,"']")),r=[];if(n){var i=a.theData(!0),o=a.axisName(e),s=function t(e){r.includes(a._get(e,n))||r.push(a._get(e,n))};switch(e){case"color":i.forEach((function(t){s(t)}));break;case"area":case 0:case 1:var c,l;if(1==a.args("nameIsNum")||1==e||"area"==e){if(c=null!==a.args("".concat(o,"Min"))&&"area"!==e?a.args("".concat(o,"Min")):d3.min(i,(function(t){return a._get(t,n,!0)})),l=null!==a.args("".concat(o,"Max"))&&"area"!==e?a.args("".concat(o,"Max")):d3.max(i,(function(t){return a._get(t,n,!0)})),r=[c,l],a._is_base("scatter")&&0==e){var u=U(c),h=U(l);r=[u,h]}}else r=i.map((function(t){return a._get(t,n,!1)})),i.forEach((function(t){s(t)}));if(a.args("reverse.".concat(e))){for(var f=[],d=r.length-1;d>=0;d--)f.push(r[d]);r=f}}}return r}},{key:"scale",value:function t(e,a){a=a||!1;var n=this,r,i=n.range(e),o=n.domain(e);switch(e){case"color":r=d3.scaleOrdinal().range(i);break;case"area":case 0:case 1:r=1==n.args("nameIsNum")||1==e||"area"==e?1==n.args("nameIsNum")&&0==e&&n._is_base("scatter")?d3.scaleSymlog().constant(St).range(i).domain(o):d3.scaleLinear().range(i).domain(o):n._is_base(["line","scatter"])?d3.scalePoint().range(i).domain(o):d3.scaleBand().range(i).domain(o).paddingInner(n.args("barGutter")).paddingOuter(n.args("barGutter"))}return a?r(a):r}},{key:"format",value:function t(e){e=N.toCapitalize(e.toString());var a=this,n;return n="function"==typeof a.args("format".concat(e,"Parameter"))?a.args("format".concat(e,"Parameter")):"string"==typeof a.args("format".concat(e,"Parameter"))?function t(a,n){return d3.format(args("format".concat(e,"Parameter")))(a)}:function t(n,r){var i=a.args("format".concat(e,"Divider")),o=a.args("format".concat(e,"Prepend")),s=a.args("format".concat(e,"Append")),c=1==e||1==a.args("nameIsNum")?n/i:n,l;return"".concat(o).concat(c).concat(s)}}},{key:"Axis",value:function t(e){return new W(this,e)}},{key:"Tip",get:function t(){return new q(this,wt)}},{key:"Shape",value:function t(e,a){return new G(this,e=e||!1,a=a||null)}},{key:"Pi",value:function t(e,a){return new K(this,e=e||!1,a=a||null)}},{key:"Line",value:function t(e){return new B(this,e=e||!1)}},{key:"Label",value:function t(e){return new V(this,e)}},{key:"theData",value:function t(e,a){a=a||"";var n=this,r=[],i=(e=e||!1)?n.drawnData:n.completeData;switch(a){case"pie":var o;r=d3[a]().sort(null).value((function(t){return n._get(t,n.args("key[1]"),!0)}))(i);break;case"group":if(1==n.args("srcMultiple")){r=d3[a](i,(function(t){return t[n.args("key['multiple']")]})),r=Array.from(r,(function(t){var e=f(t,2),a,n;return{parent:e[0],values:e[1]}}));break}default:r=i}return r}},{key:"theUi",get:function t(){return d3.select(this.selector)}},{key:"kill",value:function t(e){var a=this,n="Sorry, unable to display data."+(m(a,At)?"<br> Please check the console for more details":"");return a.theUi.classed("".concat(Z),!0),a.theUi.select(".".concat(nt,".").concat(Q))||a.theUi.append("div").attr("class","".concat(nt," ").concat(Q)).html(n),console.error(e),!1}},{key:"renderHeader",value:function t(){var e=this;e.theUi.append("div").lower().attr("class","".concat(tt)),e.args("title")&&e.header.append("span").attr("class","".concat(et)).text(e.args("title")),e.args("description")&&e.header.append("span").attr("class","".concat(at)).text(e.args("description")),e.header.style("padding-top",(function(){"".concat(e.margin.top/e.args("height")*50,"%")})).style("padding-left",(function(){"".concat(e.margin.left/e.outer("width")*100,"%")})).style("padding-right",(function(){"".concat(e.margin.right/e.outer("width")*100,"%")})).transition(e.duration).styleTween("opacity",(function(){e.interpolate(0,1)}))}},{key:"renderContent",value:function t(){var e=this;e.theUi.append("div").attr("class","".concat(nt)).style("position","relative").style("padding-bottom",(function(){return"".concat(e.outer("height")/e.outer("width")*100,"%")})).style("position","relative"),e.addListeners(e)}},{key:"renderSVG",value:function t(){var e=this;e.content.append("svg").attr("class","".concat(rt,"\n\t\t\t\t").concat(e.createClass("type"),"-").concat(e.args("type"),"\n\t\t\t\t").concat(e.createClass("base"),"-").concat(e.baseType,"\n\t\t\t\t").concat(e.createClass("no","has",e.args("colorPalette").length>0||null!==e.args("linePointsColor")||null!==e.args("lineColor")),"-palette\n\n\t\t\t\t").concat(e.createClass("no","has",!e._is_base("pie")&&(e.args("xTicks")||e.args("yTicks"))),"-palette\n\n\t\t\t\t").concat(e.createClass("no","has",e.args("colorLegend")),"-legend\n\n\t\t\t\t").concat(e.createClass("no-label","pi-label-style-".concat(e.args("piLabelStyle")),e.args("colorLegend")&&null!==e.args("piLabelStyle")),"\n\t\t\t")),e.svg.attr("id","".concat(this.selector,"-svg")).style("position","absolute").style("top","0").style("left","0").style("bottom","0").style("right","0").style("margin","auto").attr("version","1.1").attr("x","0px").attr("y","0px").attr("viewBox","0 0 ".concat(e.outer("width")," ").concat(e.outer("height"))).attr("preserveAspectRatio","xMidYMid meet").attr("xml:space","preserve").attr("width",e.outer("width")).attr("height",e.outer("height")),e.svg.append("g").attr("class",it).attr("font-size",e.args("fontSize")).style("line-height",1).attr("transform","translate( ".concat(e.margin.left," , ").concat(e.margin.top," )")),e._has_labels&&e.renderLabels(),e._has_ticks()&&(e.renderRulers(),e._has_grid&&e.renderGrid()),e.logStyleWarns(),e.draw()}},{key:"renderLabels",value:function t(){var e=this;C(e,Pt,It).call(e,ot),E.forEach((function(t){e._has_ticks(t)&&e.labels.append("text").attr("class","".concat(st,"-").concat(t)).attr("y",(function(){return e.Label(t).offset("y")})).attr("x",(function(){return e.Label(t).offset("x")})).attr("font-size","1em").attr("text-anchor","middle").attr("fill","currentColor").attr("opacity",0).text(e.args(t+"Label")).attr("transform",(function(){if("y"==t)return"rotate(-90)"})).transition(e.duration).attr("opacity",1)}))}},{key:"renderTicks",value:function t(e,a){if(a=a||!1,e){var n=this;E.forEach((function(t){if(n._has_ticks(t)){var r=n.args("".concat(t,"Align"));e.append("g").attr("class","\n\t\t\t\t\t\t\t".concat(n.createClass("".concat(lt,"-").concat(t),"".concat(ft,"-").concat(t),a,!1),"\n\t\t\t\t\t\t\t").concat(n.createClass("".concat(ut,"-").concat(r),"".concat(dt,"-").concat(n.args("".concat(t,"GridIncrement"))),a,!1),"\n\t\t\t\t\t\t")).attr("transform",(function(){var e;switch(t+" "+r){case"x bottom":e="0 , ".concat(n.args("height"));break;case"y right":e="".concat(n.args("width")," , 0");break;default:e="0 , 0"}if(e)return"translate("+e+")"}))}}))}}},{key:"renderRulers",value:function t(){var e=this;C(e,Pt,It).call(e,ct),e.rulers.attr("font-size",e.args("textTicksSize")+"em"),e.renderTicks(e.rulers,!1)}},{key:"renderGrid",value:function t(){var e=this;C(e,Pt,It).call(e,ht),e.grid.attr("font-size",e.args("textTicksSize")+"em"),e.renderTicks(e.grid,!0)}},{key:"drawTooltip",value:function t(){var e=this;e.svg.append("circle").attr("class","".concat(bt)),e.svg.call(e.Tip.getCall())}},{key:"logStyleWarns",value:function e(){var a=this;m(a,At)&&(a.args("width")==t.defaults("width")&&a.args("height")==t.defaults("height")&&a.completeData>9?console.debug(a.selector+" Width and height was not adjusted. graph elements may not fit in the canvas"):a.args("width")<t.defaults("width")&&a.args("height")<t.defaults("height")&&console.debug(a.selector+" set canvas width and or height may be too small.\n Tip: The given height and width are not absolute and act more like aspect ratios. svgs are responsive and will shrink along with content."),JSON.stringify(a.args("margin"))==JSON.stringify(t.defaults("margin"))&&a._has_labels()&&a._has_ticks()&&console.debug(a.selector+" text may overlap. margins may need to be modified"))}},{key:"drawAxes",value:function t(){var e=this;E.forEach((function(t){e._has_ticks(t)&&(e.ruler(t).transition(e.duration).call(e.Axis(t).getCall(!1)).attr("font-family",null).attr("font-size",null),e._has_grid(t)&&(e.gridCol(t).transition(e.duration).call(e.Axis(t).getCall(!0)),e.gridCol(t).selectAll("g").classed("grid",!0).filter((function(a,n){var r=!1;return e.ruler(t).selectAll("g").each((function(t){t==a&&(r=!0)})),r})).classed("tick-aligned",!0)))}))}},{key:"drawGraph",value:function t(){C(this,Et,Nt).call(this,gt)}},{key:"drawText",value:function t(){C(this,Et,Nt).call(this,_t)}},{key:"readyData",value:function t(){var e=this,a;return a=e._has_nested_data?e.theData(!0,"group"):[{parent:"flat",values:e.theData(!0)}]}},{key:"drawLineGraph",value:function t(){var e=this;e.graphs.append("path").lower().attr("class","".concat(pt,"\n\t\t\t\t").concat(e.createClass("no","has",null!==e.args("lineColor")),"-color")).attr("fill","none").attr("stroke-width",e.args("lineWeight")).attr("stroke-linejoin","round").attr("stroke-dasharray",e.args("lineDash")).attr("stroke-opacity",1).attr("stroke-dasharray","0,0").attr("stroke",e.args("lineColor")).transition(e.duration).attrTween("d",(function(t){return e.interpolate(e.Line(t.values).path(!1,!0),e.Line(t.values).path(!1,!1))})),e.args("lineFill")&&e.graphs.append("path").lower().attr("class","".concat(kt,"\n\t\t\t\t\t").concat(e.createClass("no","has",null!==e.args("lineFillColor")||null!==e.args("lineColor")),"-color")).attr("fill",e.args("lineFillColor")||e.args("lineColor")).attr("fill-opacity",e.args("lineFillOpacity")).transition(e.duration).attrTween("d",(function(t){return e.interpolate(e.Line(t.values).path(!0,!0),e.Line(t.values).path(!0,!1))}))}},{key:"drawItemShapes",value:function t(){var e=this,a=e.itemShapes.data((function(t){return t.values}));a.exit().transition(e.duration).style("opacity",0).remove();var n=a.enter().append(e.Shape().tag).attr("class",(function(t){return"".concat(yt,"\n\t\t\t\t\t").concat(vt,"\n\t\t\t\t\tdata-name-").concat(e._get(t,e.args("key[0]")),"\n\t\t\t\t\t")}));e._is_base(["bar","line","scatter"])&&n.attr(e.Shape().coordAttr("x"),(function(t,a){return e.Shape(t,a).offset("x",!0)})).attr(e.Shape().coordAttr("y"),(function(t,a){return e.Shape(t,a).offset("y",!0)})),e._is_base(["line","scatter"])?n.attr("r",(function(t,a){return e.Shape(t,a).radius(!0)})):e._is_base("bar")&&n.attr("width",(function(t,a){return e.Shape(t,a).size("x",!0)})).attr("height",(function(t,a){return e.Shape(t,a).size("y",!0)})),e._is_base("line")&&!e.args("linePoints")&&n.attr("opacity",0);var r=a.merge(n);e._is_base(["bar","line","scatter"])&&r.attr(e.Shape().coordAttr("x"),(function(t,a){return e.Shape(t,a).offset("x")})).attr(e.Shape().coordAttr("y"),(function(t,a){return console.log("luh",e.Shape(t,a).offset("y",!1)),e.Shape(t,a).offset("y")})),e._is_base(["line","scatter"])?r.transition(e.duration).attr("r",(function(t,a){return e.Shape(t,a).radius()})):e._is_base("bar")&&r.transition(e.duration).attr("width",(function(t,a){return e.Shape(t,a).size("x")})).attr("height",(function(t,a){return e.Shape(t,a).size("y")})),e._is_base("pie")&&r.transition(e.args("transition")).attrTween("d",(function(t,a){t.pie=t.pie||e.theData(!0,"pie")[a];var n=t.pie;return e.interpolate(n.endAngle,n.startAngle,(function(r){return n.startAngle=r,e.Pi(t,a).path(!0)}))})),e.args("tooltipEnable"),e.args("colorPalette").length?(r.attr("fill",(function(t,a){return e.scale("color",e._get(t,"key.color"))})),e._is_base("scatter")&&r.attr("fill-opacity",args.areaOpacity).attr("stroke-width",1).attr("stroke",(function(t,a){return e.scale(e._get(t,"key.color"))}))):e._is_base("line")&&(e.args("linePointsColor")||e.args("lineColor"))&&r.attr("fill",(function(){return e.args("linePointsColor")||e.args("lineColor")}))}},{key:"drawItemStamps",value:function t(){var e=this;e._has_polyline&&e.drawItemPolyline()}},{key:"drawItemPolyline",value:function t(){var e;this.itemPolyLine.data((function(t){return t.values}))}},{key:"drawLegend",value:function t(){}},{key:"draw",value:function t(e){var a=this;e=e||a.drawnData,a.drawnData=e,
m(a,At)&&console.info("\n",a.selector,"("+a.args("title")+")","-------------------------------------------------------------------","\n","calculated shit",a,"\n","data",m(a,Tt),"\n","args",a.args(),"\n","\n"),a._is_base(["bar","line","scatter"])&&a._has_ticks&&a.drawAxes(),a.drawGraph(),a.drawText(),a._is_base("line")&&a.drawLineGraph(),a.drawItemShapes(),a._has_text&&a.drawItemStamps(),a.args("colorLegend")&&a.drawLegend()}},{key:"header",get:function t(){return this.theUi.select(".".concat(tt))}},{key:"content",get:function t(){return this.theUi.select(".".concat(nt))}},{key:"svg",get:function t(){return this.content.select(".".concat(rt))}},{key:"g",get:function t(){return this.svg.select(".".concat(it))}},{key:"labels",get:function t(){return this.g.select(".".concat(ot))}},{key:"label",value:function t(e){return e?this.labels.select(".".concat(st,"-").concat(e)):this.labels()}},{key:"rulers",get:function t(){return this.g.select(".".concat(ct))}},{key:"ruler",value:function t(e){return e?this.rulers.select(".".concat(lt,"-").concat(e)):this.rulers()}},{key:"grid",get:function t(){return this.g.select(".".concat(ht))}},{key:"gridCol",value:function t(e){return e?this.grid.select(".".concat(ft,"-").concat(e)):this.grid}},{key:"graphs",get:function t(){return this.g.selectAll(".".concat(gt))}},{key:"line",get:function t(){return this.graphs.select(".".concat(pt))}},{key:"lineFill",get:function t(){return this.graphs.select(".".concat(kt))}},{key:"itemShapes",get:function t(){return this.graphs.selectAll(".".concat(vt))}},{key:"itemPolyLine",get:function t(){return this.graphs.selectAll(".".concat(mt))}},{key:"texts",get:function t(){return this.g.select(".".concat(_t))}},{key:"itemStamps",get:function t(){return this.texts.selectAll(".".concat(CLASS_ITEM_TEXT))}},{key:"cursorStalker",get:function t(){return this.svg.select(".".concat(bt))}},{key:"tooltip",get:function t(){return this.theUi.select(".".concat(wt))}},{key:"load",value:function t(){var e=this;if(e.args("srcPath").indexOf(window.location.href)>-1){var a=document.getElementById(N.hash(e.args("srcPath"))).innerHTML;if(N.isValidJSONString(a)){var n=JSON.parse(a);e.init(n)}else e.kill("Data input may not be valid. Please check and update the syntax")}else switch(N.fileExtension(e.args("srcPath"))){case"csv":case"dsv":case"tsv":case"xml":d3[N.fileExtension(e.args("srcPath"))](e.args("srcPath"),(function(t){return t})).then((function(t){e.init(t)})).catch((function(t){e.kill(t)}));break;default:d3.json(e.args("srcPath"),(function(t){return t})).then((function(t){e.init(t)})).catch((function(t){e.kill(t)}))}}},{key:"init",value:function t(e){var a=this;a.theUi.classed("".concat(Z,"\n\t\t\t\t").concat(a.createClass("","dark",j(a.args("colorBackground")))),!0).style("background-color",a.args("colorBackground")),a.completeData=C(a,Lt,Mt).call(a,e),a.renderHeader(),a.renderContent()}},{key:"addListeners",value:function t(e){e=e||this,window.addEventListener("scroll",e.handlerScroll),window.addEventListener("resize",e.handlerResize)}},{key:"handlerScroll",get:function t(){var e=this;return function(t){var a;e.elem.getBoundingClientRect().top<.5*window.innerHeight&&!e.isLoaded&&(e.isLoaded=!0,setTimeout((function(){e.renderSVG(),e._has_tooltip&&e.drawTooltip()}),e.args("delay")))}}},{key:"handlerResize",get:function t(){var e=this;return function(t){clearTimeout(e.resizeInt),e.resizeInt=setTimeout((function(){e.draw()}),300)}}}],[{key:"defaults",value:function e(a){var n={width:600,height:600,margin:40,transition:500,delay:250,fontSize:"16px",title:"",description:"",srcType:"",srcPath:"",srcKey:null,srcMultiple:!1,srcPreNest:!1,textNameSize:.75,textValueSize:1.25,textTicksSize:.75,textLegendSize:.75,type:"bar",nameIsNum:!1,key:{multiple:"_parent",0:0,1:1,color:null,area:null},reverse:{0:!1,1:!1,color:!1,multiple:!1,area:!1},format0Prepend:"",format0Append:"",format0Parameter:null,format0Divider:1,format1Prepend:"",format1Append:"",format1Parameter:null,format1Divider:1,formatColorPrepend:"",formatColorAppend:"",formatColorParameter:null,areaMin:10,areaMax:20,areaOpacity:.8,colorBackground:"#eee",colorPalette:[],colorData:null,colorLegend:!1,xData:0,xAlign:"bottom",xTicks:!1,xLabel:null,xTicksAmount:null,xParameter:null,xMin:null,xMax:null,xGrid:!1,xGridIncrement:1,xPrepend:"",xAppend:"",xDivider:1,yData:1,yAlign:"left",yTicks:!1,yLabel:null,yTicksAmount:null,yParameter:null,yMin:null,yMax:null,yGrid:!1,yGridIncrement:1,yPrepend:"",yAppend:"",yDivider:1,barTextWithin:!1,barGutter:.1,lineStyle:"",lineWeight:1,lineColor:null,linePoints:!1,lineFill:!1,linePointsColor:null,linePointsSize:null,lineFillColor:null,lineFillInvert:!1,lineFillOpacity:.5,lineDash:[100,0],piLabelStyle:"within",piInRadius:0,tooltipEnable:!1,tooltipTextAlign:"left",tooltipWidth:"auto",tooltipDirection:"n",tooltipDirectionParameter:null,tooltipContent:null,multipleDisplay:"overlay",colorBy:"key",colorScheme:null};return(a=a||!1)?b(t,t,Ot).call(t,n,a):n}}]),t}()}));